<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.262">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Evgenii O. Tretiakov">

<title>Difference in signalling between astrocytic Insr+/- groups of the hypothalamic paraventricular nucleus and Agrp or POMC neurons of Arc in response to chronic social stress</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="08-insr-signalling_csds_files/libs/clipboard/clipboard.min.js"></script>
<script src="08-insr-signalling_csds_files/libs/quarto-html/quarto.js"></script>
<script src="08-insr-signalling_csds_files/libs/quarto-html/popper.min.js"></script>
<script src="08-insr-signalling_csds_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="08-insr-signalling_csds_files/libs/quarto-html/anchor.min.js"></script>
<link href="08-insr-signalling_csds_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="08-insr-signalling_csds_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="08-insr-signalling_csds_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="08-insr-signalling_csds_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="08-insr-signalling_csds_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#genes" id="toc-genes" class="nav-link active" data-scroll-target="#genes">genes</a></li>
  <li><a href="#parameters" id="toc-parameters" class="nav-link" data-scroll-target="#parameters">parameters</a></li>
  <li><a href="#load-data" id="toc-load-data" class="nav-link" data-scroll-target="#load-data">Load data</a></li>
  <li><a href="#signalling-analysis" id="toc-signalling-analysis" class="nav-link" data-scroll-target="#signalling-analysis">Signalling analysis</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Difference in signalling between astrocytic Insr+/- groups of the hypothalamic paraventricular nucleus and Agrp or POMC neurons of Arc in response to chronic social stress</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Evgenii O. Tretiakov </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<div class="cell" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sklearn</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> watermark <span class="im">import</span> watermark</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.utils <span class="im">import</span> check_random_state</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> gprofiler <span class="im">import</span> GProfiler</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pacmap</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> umap</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scvelo <span class="im">as</span> scv</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scanpy <span class="im">as</span> sc</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cellrank <span class="im">as</span> cr</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> anndata <span class="im">as</span> ad</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotnine <span class="im">as</span> p9</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> liana <span class="im">as</span> li</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> liana.mt <span class="im">import</span> rank_aggregate</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>warnings.simplefilter(<span class="st">"ignore"</span>, category<span class="op">=</span><span class="pp">UserWarning</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>warnings.simplefilter(<span class="st">"ignore"</span>, category<span class="op">=</span><span class="pp">FutureWarning</span>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>warnings.simplefilter(<span class="st">"ignore"</span>, category<span class="op">=</span><span class="pp">DeprecationWarning</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="genes" class="level3">
<h3 class="anchored" data-anchor-id="genes">genes</h3>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>npr <span class="op">=</span> [</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adcyap1r1"</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Avpr1a"</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Calcr"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Calcrl"</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cckar"</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cckbr"</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cntfr"</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Crhr1"</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Crhr2"</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Esr1"</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Galr1"</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Galr2"</span>,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Galr3"</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ghr"</span>,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ghrhr"</span>,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ghsr"</span>,</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Glp1r"</span>,</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gpr55"</span>,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gpr83"</span>,</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gpr149"</span>,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grpr"</span>,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Hcrtr1"</span>,</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Hcrtr2"</span>,</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Igf1r"</span>,</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Insr"</span>,</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Insrr"</span>,</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Kiss1r"</span>,</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Lepr"</span>,</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mc1r"</span>,</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mc3r"</span>,</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mc4r"</span>,</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mchr1"</span>,</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nmbr"</span>,</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nmur1"</span>,</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nmur2"</span>,</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npffr1"</span>,</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npffr2"</span>,</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npr1"</span>,</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npr2"</span>,</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npr3"</span>,</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npsr1"</span>,</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npsr2"</span>,</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npy1r"</span>,</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npy2r"</span>,</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npy5r"</span>,</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ntrk2"</span>,</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ntsr1"</span>,</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ntsr2"</span>,</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Oprd1"</span>,</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Oprk1"</span>,</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Oprl1"</span>,</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Oprm1"</span>,</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Oxtr"</span>,</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Prlhr"</span>,</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Prlr"</span>,</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Prokr2"</span>,</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Qrfpr"</span>,</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Rxfp1"</span>,</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Rxfp2"</span>,</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sstr1"</span>,</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sstr2"</span>,</span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sstr3"</span>,</span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Tacr1"</span>,</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Tacr3"</span>,</span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Trhr"</span>,</span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Trhr2"</span>,</span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Tshr"</span>,</span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Vipr1"</span>,</span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Vipr2"</span>,</span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>npep <span class="op">=</span> [</span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adcyap1"</span>,</span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Agrp"</span>,</span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Avp"</span>,</span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Bdnf"</span>,</span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cartpt"</span>,</span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cck"</span>,</span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cntf"</span>,</span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Crh"</span>,</span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gal"</span>,</span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ghrh"</span>,</span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ghrl"</span>,</span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grp"</span>,</span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Hcrt"</span>,</span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Kiss1"</span>,</span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Lep"</span>,</span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nmb"</span>,</span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nms"</span>,</span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nmu"</span>,</span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npvf"</span>,</span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npw"</span>,</span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npy"</span>,</span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nts"</span>,</span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Oxt"</span>,</span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pdyn"</span>,</span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Penk"</span>,</span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pmch"</span>,</span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pnoc"</span>,</span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pomc"</span>,</span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Qrfp"</span>,</span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Reln"</span>,</span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Rln1"</span>,</span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Rln3"</span>,</span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sst"</span>,</span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Tac1"</span>,</span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Tac2"</span>,</span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Trh"</span>,</span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a>genes_embed <span class="op">=</span> [</span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Abcd1"</span>,</span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Abcd2"</span>,</span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Abcd3"</span>,</span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Acaa1"</span>,</span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Acaa2"</span>,</span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Acox1"</span>,</span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Agt"</span>,</span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Aldh1a1"</span>,</span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Aldh1l1"</span>,</span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Aldoc"</span>,</span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Apoe"</span>,</span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Aqp4"</span>,</span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Caf4"</span>,</span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ckb"</span>,</span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cnr1"</span>,</span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cnr2"</span>,</span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cst3"</span>,</span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Dagla"</span>,</span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Daglb"</span>,</span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Decr2"</span>,</span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Dnm1"</span>,</span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Drp1"</span>,</span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ech1"</span>,</span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Egfr"</span>,</span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Eno1"</span>,</span>
<span id="cb2-138"><a href="#cb2-138" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Faah"</span>,</span>
<span id="cb2-139"><a href="#cb2-139" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fgfr3"</span>,</span>
<span id="cb2-140"><a href="#cb2-140" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fis1"</span>,</span>
<span id="cb2-141"><a href="#cb2-141" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fos"</span>,</span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fth1"</span>,</span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ftl1"</span>,</span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gfap"</span>,</span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gja1"</span>,</span>
<span id="cb2-146"><a href="#cb2-146" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gli1"</span>,</span>
<span id="cb2-147"><a href="#cb2-147" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Glul"</span>,</span>
<span id="cb2-148"><a href="#cb2-148" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Hacd2"</span>,</span>
<span id="cb2-149"><a href="#cb2-149" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Hadhb"</span>,</span>
<span id="cb2-150"><a href="#cb2-150" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Hepacam"</span>,</span>
<span id="cb2-151"><a href="#cb2-151" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Hif1"</span>,</span>
<span id="cb2-152"><a href="#cb2-152" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htra1"</span>,</span>
<span id="cb2-153"><a href="#cb2-153" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Lcat"</span>,</span>
<span id="cb2-154"><a href="#cb2-154" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Lpcat3"</span>,</span>
<span id="cb2-155"><a href="#cb2-155" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Insr"</span>,</span>
<span id="cb2-156"><a href="#cb2-156" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mdv1"</span>,</span>
<span id="cb2-157"><a href="#cb2-157" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mfn1"</span>,</span>
<span id="cb2-158"><a href="#cb2-158" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mfn2"</span>,</span>
<span id="cb2-159"><a href="#cb2-159" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mgll"</span>,</span>
<span id="cb2-160"><a href="#cb2-160" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mief1"</span>,</span>
<span id="cb2-161"><a href="#cb2-161" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Napepld"</span>,</span>
<span id="cb2-162"><a href="#cb2-162" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ndrg2"</span>,</span>
<span id="cb2-163"><a href="#cb2-163" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nfia"</span>,</span>
<span id="cb2-164"><a href="#cb2-164" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Opa1"</span>,</span>
<span id="cb2-165"><a href="#cb2-165" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Otp"</span>,</span>
<span id="cb2-166"><a href="#cb2-166" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pex1"</span>,</span>
<span id="cb2-167"><a href="#cb2-167" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pex10"</span>,</span>
<span id="cb2-168"><a href="#cb2-168" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pex12"</span>,</span>
<span id="cb2-169"><a href="#cb2-169" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pex13"</span>,</span>
<span id="cb2-170"><a href="#cb2-170" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pex14"</span>,</span>
<span id="cb2-171"><a href="#cb2-171" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pex16"</span>,</span>
<span id="cb2-172"><a href="#cb2-172" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pex2"</span>,</span>
<span id="cb2-173"><a href="#cb2-173" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pex26"</span>,</span>
<span id="cb2-174"><a href="#cb2-174" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pex3"</span>,</span>
<span id="cb2-175"><a href="#cb2-175" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pex6"</span>,</span>
<span id="cb2-176"><a href="#cb2-176" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pla2g7"</span>,</span>
<span id="cb2-177"><a href="#cb2-177" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Plcb1"</span>,</span>
<span id="cb2-178"><a href="#cb2-178" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pygb"</span>,</span>
<span id="cb2-179"><a href="#cb2-179" aria-hidden="true" tabindex="-1"></a>    <span class="st">"S100a6"</span>,</span>
<span id="cb2-180"><a href="#cb2-180" aria-hidden="true" tabindex="-1"></a>    <span class="st">"S100b"</span>,</span>
<span id="cb2-181"><a href="#cb2-181" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Scd2"</span>,</span>
<span id="cb2-182"><a href="#cb2-182" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sgcd"</span>,</span>
<span id="cb2-183"><a href="#cb2-183" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slc1a2"</span>,</span>
<span id="cb2-184"><a href="#cb2-184" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slc1a3"</span>,</span>
<span id="cb2-185"><a href="#cb2-185" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slc4a4"</span>,</span>
<span id="cb2-186"><a href="#cb2-186" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slc6a11"</span>,</span>
<span id="cb2-187"><a href="#cb2-187" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slc7a10"</span>,</span>
<span id="cb2-188"><a href="#cb2-188" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slc38a1"</span>,</span>
<span id="cb2-189"><a href="#cb2-189" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slit1"</span>,</span>
<span id="cb2-190"><a href="#cb2-190" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slit2"</span>,</span>
<span id="cb2-191"><a href="#cb2-191" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sox9"</span>,</span>
<span id="cb2-192"><a href="#cb2-192" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Tafa1"</span>,</span>
<span id="cb2-193"><a href="#cb2-193" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Tkt"</span>,</span>
<span id="cb2-194"><a href="#cb2-194" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Trpv1"</span>,</span>
<span id="cb2-195"><a href="#cb2-195" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb2-196"><a href="#cb2-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-197"><a href="#cb2-197" aria-hidden="true" tabindex="-1"></a>nmr <span class="op">=</span> [</span>
<span id="cb2-198"><a href="#cb2-198" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adra1a"</span>,</span>
<span id="cb2-199"><a href="#cb2-199" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adra1b"</span>,</span>
<span id="cb2-200"><a href="#cb2-200" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adra1d"</span>,</span>
<span id="cb2-201"><a href="#cb2-201" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adra2a"</span>,</span>
<span id="cb2-202"><a href="#cb2-202" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adra2b"</span>,</span>
<span id="cb2-203"><a href="#cb2-203" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adra2c"</span>,</span>
<span id="cb2-204"><a href="#cb2-204" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adrb1"</span>,</span>
<span id="cb2-205"><a href="#cb2-205" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adrb2"</span>,</span>
<span id="cb2-206"><a href="#cb2-206" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adrb3"</span>,</span>
<span id="cb2-207"><a href="#cb2-207" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adrbk1"</span>,</span>
<span id="cb2-208"><a href="#cb2-208" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adrbk2"</span>,</span>
<span id="cb2-209"><a href="#cb2-209" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adrm1"</span>,  <span class="co"># adrenergic receptors</span></span>
<span id="cb2-210"><a href="#cb2-210" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adora1"</span>,</span>
<span id="cb2-211"><a href="#cb2-211" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adora2a"</span>,</span>
<span id="cb2-212"><a href="#cb2-212" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adora2b"</span>,</span>
<span id="cb2-213"><a href="#cb2-213" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adora3"</span>,  <span class="co"># adenosine receptors</span></span>
<span id="cb2-214"><a href="#cb2-214" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrna1"</span>,</span>
<span id="cb2-215"><a href="#cb2-215" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrna2"</span>,</span>
<span id="cb2-216"><a href="#cb2-216" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrna3"</span>,</span>
<span id="cb2-217"><a href="#cb2-217" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrna4"</span>,</span>
<span id="cb2-218"><a href="#cb2-218" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrna5"</span>,</span>
<span id="cb2-219"><a href="#cb2-219" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrna6"</span>,</span>
<span id="cb2-220"><a href="#cb2-220" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrna7"</span>,</span>
<span id="cb2-221"><a href="#cb2-221" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrna9"</span>,</span>
<span id="cb2-222"><a href="#cb2-222" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrna10"</span>,</span>
<span id="cb2-223"><a href="#cb2-223" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrnb1"</span>,</span>
<span id="cb2-224"><a href="#cb2-224" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrnb2"</span>,</span>
<span id="cb2-225"><a href="#cb2-225" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrnb3"</span>,</span>
<span id="cb2-226"><a href="#cb2-226" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrnd"</span>,</span>
<span id="cb2-227"><a href="#cb2-227" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrng"</span>,  <span class="co"># cholinergic receptors</span></span>
<span id="cb2-228"><a href="#cb2-228" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gria1"</span>,</span>
<span id="cb2-229"><a href="#cb2-229" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gria2"</span>,</span>
<span id="cb2-230"><a href="#cb2-230" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gria3"</span>,</span>
<span id="cb2-231"><a href="#cb2-231" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gria4"</span>,  <span class="co"># iGlu AMPA receptors</span></span>
<span id="cb2-232"><a href="#cb2-232" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grid1"</span>,</span>
<span id="cb2-233"><a href="#cb2-233" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grid2"</span>,  <span class="co"># iGlu delta receptors</span></span>
<span id="cb2-234"><a href="#cb2-234" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grik1"</span>,</span>
<span id="cb2-235"><a href="#cb2-235" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grik2"</span>,</span>
<span id="cb2-236"><a href="#cb2-236" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grik3"</span>,</span>
<span id="cb2-237"><a href="#cb2-237" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grik4"</span>,</span>
<span id="cb2-238"><a href="#cb2-238" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grik5"</span>,  <span class="co"># iGlu kainate receptors</span></span>
<span id="cb2-239"><a href="#cb2-239" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grin1"</span>,</span>
<span id="cb2-240"><a href="#cb2-240" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grin2a"</span>,</span>
<span id="cb2-241"><a href="#cb2-241" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grin2b"</span>,</span>
<span id="cb2-242"><a href="#cb2-242" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grin2c"</span>,</span>
<span id="cb2-243"><a href="#cb2-243" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grin2d"</span>,</span>
<span id="cb2-244"><a href="#cb2-244" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grin3a"</span>,</span>
<span id="cb2-245"><a href="#cb2-245" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grin3b"</span>,  <span class="co"># iGlu NMDA receptors</span></span>
<span id="cb2-246"><a href="#cb2-246" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grm1"</span>,</span>
<span id="cb2-247"><a href="#cb2-247" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grm5"</span>,  <span class="co"># mGluRs 1</span></span>
<span id="cb2-248"><a href="#cb2-248" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grm2"</span>,</span>
<span id="cb2-249"><a href="#cb2-249" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grm3"</span>,  <span class="co"># mGluRs 2</span></span>
<span id="cb2-250"><a href="#cb2-250" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grm4"</span>,</span>
<span id="cb2-251"><a href="#cb2-251" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grm6"</span>,</span>
<span id="cb2-252"><a href="#cb2-252" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grm7"</span>,</span>
<span id="cb2-253"><a href="#cb2-253" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grm8"</span>,  <span class="co"># mGluRs 3</span></span>
<span id="cb2-254"><a href="#cb2-254" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabra1"</span>,</span>
<span id="cb2-255"><a href="#cb2-255" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabra2"</span>,</span>
<span id="cb2-256"><a href="#cb2-256" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabra3"</span>,</span>
<span id="cb2-257"><a href="#cb2-257" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabra4"</span>,</span>
<span id="cb2-258"><a href="#cb2-258" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabra5"</span>,</span>
<span id="cb2-259"><a href="#cb2-259" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabra6"</span>,</span>
<span id="cb2-260"><a href="#cb2-260" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrb1"</span>,</span>
<span id="cb2-261"><a href="#cb2-261" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrb2"</span>,</span>
<span id="cb2-262"><a href="#cb2-262" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrb3"</span>,</span>
<span id="cb2-263"><a href="#cb2-263" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrg1"</span>,</span>
<span id="cb2-264"><a href="#cb2-264" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrg2"</span>,</span>
<span id="cb2-265"><a href="#cb2-265" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrg3"</span>,</span>
<span id="cb2-266"><a href="#cb2-266" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrd"</span>,</span>
<span id="cb2-267"><a href="#cb2-267" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabre"</span>,</span>
<span id="cb2-268"><a href="#cb2-268" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrp"</span>,</span>
<span id="cb2-269"><a href="#cb2-269" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrq"</span>,</span>
<span id="cb2-270"><a href="#cb2-270" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrr1"</span>,</span>
<span id="cb2-271"><a href="#cb2-271" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrr2"</span>,</span>
<span id="cb2-272"><a href="#cb2-272" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrr3"</span>,</span>
<span id="cb2-273"><a href="#cb2-273" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabbr1"</span>,</span>
<span id="cb2-274"><a href="#cb2-274" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabbr2"</span>,  <span class="co"># GABA receptors</span></span>
<span id="cb2-275"><a href="#cb2-275" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Drd1"</span>,</span>
<span id="cb2-276"><a href="#cb2-276" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Drd2"</span>,</span>
<span id="cb2-277"><a href="#cb2-277" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Drd3"</span>,</span>
<span id="cb2-278"><a href="#cb2-278" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Drd4"</span>,</span>
<span id="cb2-279"><a href="#cb2-279" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Drd5"</span>,  <span class="co"># dopamine receptors</span></span>
<span id="cb2-280"><a href="#cb2-280" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr1a"</span>,</span>
<span id="cb2-281"><a href="#cb2-281" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr1b"</span>,</span>
<span id="cb2-282"><a href="#cb2-282" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr1d"</span>,</span>
<span id="cb2-283"><a href="#cb2-283" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr1f"</span>,</span>
<span id="cb2-284"><a href="#cb2-284" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr2a"</span>,</span>
<span id="cb2-285"><a href="#cb2-285" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr2b"</span>,</span>
<span id="cb2-286"><a href="#cb2-286" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr2c"</span>,</span>
<span id="cb2-287"><a href="#cb2-287" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr3a"</span>,</span>
<span id="cb2-288"><a href="#cb2-288" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr3b"</span>,</span>
<span id="cb2-289"><a href="#cb2-289" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr4"</span>,</span>
<span id="cb2-290"><a href="#cb2-290" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr5a"</span>,</span>
<span id="cb2-291"><a href="#cb2-291" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr5b"</span>,</span>
<span id="cb2-292"><a href="#cb2-292" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr6"</span>,</span>
<span id="cb2-293"><a href="#cb2-293" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr7"</span>,  <span class="co"># serotonin receptors</span></span>
<span id="cb2-294"><a href="#cb2-294" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnas"</span>,</span>
<span id="cb2-295"><a href="#cb2-295" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnai1"</span>,</span>
<span id="cb2-296"><a href="#cb2-296" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnai2"</span>,</span>
<span id="cb2-297"><a href="#cb2-297" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnai3"</span>,</span>
<span id="cb2-298"><a href="#cb2-298" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnao1"</span>,</span>
<span id="cb2-299"><a href="#cb2-299" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnao2"</span>,</span>
<span id="cb2-300"><a href="#cb2-300" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnaq"</span>,</span>
<span id="cb2-301"><a href="#cb2-301" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gna11"</span>,</span>
<span id="cb2-302"><a href="#cb2-302" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gna12"</span>,</span>
<span id="cb2-303"><a href="#cb2-303" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gna13"</span>,</span>
<span id="cb2-304"><a href="#cb2-304" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnal"</span>,</span>
<span id="cb2-305"><a href="#cb2-305" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnasxl"</span>,  <span class="co"># G protein alpha subunit</span></span>
<span id="cb2-306"><a href="#cb2-306" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnb1"</span>,</span>
<span id="cb2-307"><a href="#cb2-307" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnb2"</span>,</span>
<span id="cb2-308"><a href="#cb2-308" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnb3"</span>,</span>
<span id="cb2-309"><a href="#cb2-309" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnb4"</span>,</span>
<span id="cb2-310"><a href="#cb2-310" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnb5"</span>,  <span class="co"># G protein beta subunit</span></span>
<span id="cb2-311"><a href="#cb2-311" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gng2"</span>,</span>
<span id="cb2-312"><a href="#cb2-312" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gng3"</span>,</span>
<span id="cb2-313"><a href="#cb2-313" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gng4"</span>,</span>
<span id="cb2-314"><a href="#cb2-314" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gng5"</span>,</span>
<span id="cb2-315"><a href="#cb2-315" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gng7"</span>,</span>
<span id="cb2-316"><a href="#cb2-316" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gng8"</span>,</span>
<span id="cb2-317"><a href="#cb2-317" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gng10"</span>,</span>
<span id="cb2-318"><a href="#cb2-318" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gng11"</span>,</span>
<span id="cb2-319"><a href="#cb2-319" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gng12"</span>,</span>
<span id="cb2-320"><a href="#cb2-320" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gng13"</span>,</span>
<span id="cb2-321"><a href="#cb2-321" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gngt1"</span>,</span>
<span id="cb2-322"><a href="#cb2-322" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gngt2"</span>,  <span class="co"># G protein gamma subunit</span></span>
<span id="cb2-323"><a href="#cb2-323" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2rx1"</span>,</span>
<span id="cb2-324"><a href="#cb2-324" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2rx2"</span>,</span>
<span id="cb2-325"><a href="#cb2-325" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2rx3"</span>,</span>
<span id="cb2-326"><a href="#cb2-326" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2rx4"</span>,</span>
<span id="cb2-327"><a href="#cb2-327" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2rx5"</span>,</span>
<span id="cb2-328"><a href="#cb2-328" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2rx6"</span>,</span>
<span id="cb2-329"><a href="#cb2-329" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2rx7"</span>,</span>
<span id="cb2-330"><a href="#cb2-330" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2ry1"</span>,</span>
<span id="cb2-331"><a href="#cb2-331" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2ry2"</span>,</span>
<span id="cb2-332"><a href="#cb2-332" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2ry4"</span>,</span>
<span id="cb2-333"><a href="#cb2-333" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2ry6"</span>,</span>
<span id="cb2-334"><a href="#cb2-334" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2ry12"</span>,</span>
<span id="cb2-335"><a href="#cb2-335" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2ry13"</span>,</span>
<span id="cb2-336"><a href="#cb2-336" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2ry14"</span>,  <span class="co"># purinergic receptors</span></span>
<span id="cb2-337"><a href="#cb2-337" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ryr1"</span>,</span>
<span id="cb2-338"><a href="#cb2-338" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ryr2"</span>,</span>
<span id="cb2-339"><a href="#cb2-339" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ryr3"</span>,  <span class="co"># ryanodine receptors</span></span>
<span id="cb2-340"><a href="#cb2-340" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="parameters" class="level3">
<h3 class="anchored" data-anchor-id="parameters">parameters</h3>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>bioproject <span class="op">=</span> <span class="st">"PRJNA679294"</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Distance Metric to Use</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># metric = snakemake.params["metric"]</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>metric <span class="op">=</span> <span class="st">"euclidean"</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># connectivity_model = snakemake.params["connectivity_model"]</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>connectivity_model <span class="op">=</span> <span class="st">"min_tree"</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>PLOTS_DIR <span class="op">=</span> os.path.join(<span class="st">"../output/figures/velocity-signalling/"</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>os.makedirs(PLOTS_DIR, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>OUT_DIR <span class="op">=</span> os.path.join(<span class="st">"../data/velocity-signalling/"</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>os.makedirs(OUT_DIR, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting params</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>pt_size <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>dnsty <span class="op">=</span> <span class="fl">0.8</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>plt_size <span class="op">=</span> [<span class="dv">5</span>, <span class="dv">5</span>]</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>SMALL_SIZE <span class="op">=</span> <span class="dv">7</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>MEDIUM_SIZE <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>BIGGER_SIZE <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>plt.rc(<span class="st">"font"</span>, size<span class="op">=</span>SMALL_SIZE)  <span class="co"># controls default text sizes</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>plt.rc(<span class="st">"axes"</span>, titlesize<span class="op">=</span>SMALL_SIZE)  <span class="co"># fontsize of the axes title</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>plt.rc(<span class="st">"axes"</span>, labelsize<span class="op">=</span>MEDIUM_SIZE)  <span class="co"># fontsize of the x and y labels</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>plt.rc(<span class="st">"xtick"</span>, labelsize<span class="op">=</span>SMALL_SIZE)  <span class="co"># fontsize of the tick labels</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>plt.rc(<span class="st">"ytick"</span>, labelsize<span class="op">=</span>SMALL_SIZE)  <span class="co"># fontsize of the tick labels</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>plt.rc(<span class="st">"legend"</span>, fontsize<span class="op">=</span>SMALL_SIZE)  <span class="co"># legend fontsize</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>plt.rc(<span class="st">"figure"</span>, titlesize<span class="op">=</span>BIGGER_SIZE)  <span class="co"># fontsize of the figure title</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>matplotlib.rcParams[<span class="st">"font.size"</span>] <span class="op">=</span> <span class="dv">11</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>matplotlib.rcParams[<span class="st">"pdf.use14corefonts"</span>] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>matplotlib.rcParams[<span class="st">"pdf.fonttype"</span>] <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>matplotlib.rcParams[<span class="st">"ps.fonttype"</span>] <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>matplotlib.rcParams[<span class="st">"font.family"</span>] <span class="op">=</span> <span class="st">"sans-serif"</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>matplotlib.rcParams[<span class="st">"font.sans-serif"</span>] <span class="op">=</span> [<span class="st">"Helvetica"</span>]</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>matplotlib.rcParams[<span class="st">"figure.max_open_warning"</span>] <span class="op">=</span> <span class="dv">20000</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>reseed <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>random.seed(reseed)</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>np.random.seed(reseed)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>random_state <span class="op">=</span> check_random_state(reseed)</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>verbose <span class="op">=</span> <span class="va">True</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>sc.settings.verbosity <span class="op">=</span> <span class="dv">2</span>  <span class="co"># verbosity: errors (0), warnings (1), info (2), hints (3)</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>scv.settings.set_figure_params(<span class="st">"scvelo"</span>)</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>sc.settings.figdir <span class="op">=</span> PLOTS_DIR</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>sc.settings.writedir <span class="op">=</span> OUT_DIR</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>sc.settings.set_figure_params(</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>    dpi<span class="op">=</span><span class="dv">120</span>,</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>    dpi_save<span class="op">=</span><span class="dv">600</span>,</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>    vector_friendly<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>    <span class="bu">format</span><span class="op">=</span><span class="st">"pdf"</span>,</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>    transparent<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>    color_map<span class="op">=</span><span class="st">"gnuplot_r"</span>,</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>sc.settings.autoshow <span class="op">=</span> <span class="va">False</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>sc.settings.autosave <span class="op">=</span> <span class="va">True</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a><span class="co"># k = int(snakemake.params["k"])</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>ks <span class="op">=</span> k <span class="op">+</span> <span class="dv">10</span></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>npcs <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>npcs_selected <span class="op">=</span> npcs <span class="op">-</span> <span class="dv">20</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>min_shared_umis <span class="op">=</span> <span class="dv">15</span></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>n_top_hvg <span class="op">=</span> <span class="dv">3000</span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>cb_fpr <span class="op">=</span> <span class="fl">0.001</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>paga_threshold <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>spread <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>threads <span class="op">=</span> <span class="dv">80</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>svm_fit_strength <span class="op">=</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="load-data" class="level3">
<h3 class="anchored" data-anchor-id="load-data">Load data</h3>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>housekeeping <span class="op">=</span> <span class="ss">f"/data/data/housekeeping_mouse.tsv"</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>hk_genes1 <span class="op">=</span> []</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(housekeeping) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> hk_genes :<span class="op">=</span> <span class="bu">file</span>.readline():</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>        hk_genes1.append(hk_genes.rstrip())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>adata <span class="op">=</span> sc.read_h5ad(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"../data/class_cello/PRJNA679294-astrocytes_dataset-</span><span class="sc">{</span>cb_fpr<span class="sc">}</span><span class="ss">-initial_selection.h5ad"</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>adata.obs[<span class="st">"cell_id"</span>] <span class="op">=</span> adata.obs_names</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>alldata <span class="op">=</span> sc.read_h5ad(</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"../data/class_cello/PRJNA679294-whole_dataset-</span><span class="sc">{</span>cb_fpr<span class="sc">}</span><span class="ss">-cello_annotation.h5ad"</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>alldata <span class="op">=</span> alldata[alldata.obs[<span class="st">"ora_celltype"</span>].isin([<span class="st">"Astrocytes"</span>, <span class="st">"Neurons"</span>])]</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>adata_norm <span class="op">=</span> alldata[alldata.obs[<span class="st">"condit"</span>] <span class="op">==</span> <span class="dv">0</span>]</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>adata_chronic_stress <span class="op">=</span> alldata[alldata.obs[<span class="st">"condit"</span>] <span class="op">==</span> <span class="dv">1</span>]</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># import data from the diet arc study of Deng et al., 2020</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>adata_arc_neurons_norm <span class="op">=</span> sc.read_h5ad(</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"../../PRJNA604055/data/velocity-signalling/PRJNA604055-signalling-norm.h5ad"</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>adata_arc_neurons_hfhsdiet <span class="op">=</span> sc.read_h5ad(</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"../../PRJNA604055/data/velocity-signalling/PRJNA604055-signalling-treatment.h5ad"</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="signalling-analysis" class="level3">
<h3 class="anchored" data-anchor-id="signalling-analysis">Signalling analysis</h3>
<section id="normal-conditions" class="level4">
<h4 class="anchored" data-anchor-id="normal-conditions">Normal conditions</h4>
<div class="cell" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>adata_norm.obs[<span class="st">"k_tree"</span>] <span class="op">=</span> adata_norm.obs[<span class="st">"k_tree"</span>].astype(<span class="st">"category"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>adata_norm.raw.X</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>&lt;3069x22835 sparse matrix of type '&lt;class 'numpy.float32'&gt;'
    with 8854861 stored elements in Compressed Sparse Column format&gt;</code></pre>
</div>
</div>
<p>subset groups of interest</p>
<div class="cell" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>sc.pl.umap(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    adata_norm,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>[<span class="st">"k_tree"</span>],</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span>pt_size,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    legend_loc<span class="op">=</span><span class="st">"on data"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="08-insr-signalling_csds_files/figure-html/cell-8-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>sc.pl.umap(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    adata_norm,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>[</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Rbfox3"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Adcyap1r1"</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Otp"</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alk"</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Npy1r"</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Npy2r"</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Gfap"</span>,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Insr"</span>,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Slc1a3"</span>,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Htra1"</span>,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Mfn2"</span>,</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Fos"</span>,</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span>pt_size,</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="08-insr-signalling_csds_files/figure-html/cell-9-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>sc.pl.embedding(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    adata_norm,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    basis<span class="op">=</span><span class="st">"X_pacmap"</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>[</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Rbfox3"</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Adcyap1r1"</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Otp"</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alk"</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Npy1r"</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Npy2r"</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Gfap"</span>,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Insr"</span>,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Slc1a3"</span>,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Htra1"</span>,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Mfn2"</span>,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Fos"</span>,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    add_outline<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    legend_fontsize<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    legend_fontoutline<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    frameon<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span><span class="st">"nipy_spectral"</span>,</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="st">"-pacmap-int-normal-conditions-insr-status.pdf"</span>,</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING: saving figure to file ../output/figures/velocity-signalling/X_pacmap-pacmap-int-normal-conditions-insr-status.pdf</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="08-insr-signalling_csds_files/figure-html/cell-10-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="10">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>sc.pl.embedding(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    adata_norm,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    basis<span class="op">=</span><span class="st">"X_pacmap"</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>[g <span class="cf">for</span> g <span class="kw">in</span> genes_embed <span class="cf">if</span> g <span class="kw">in</span> adata_norm.var_names],</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    add_outline<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    legend_fontsize<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    legend_fontoutline<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    frameon<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span><span class="st">"nipy_spectral"</span>,</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="st">"-pacmap-adgene-normal-conditions-insr-status.pdf"</span>,</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING: saving figure to file ../output/figures/velocity-signalling/X_pacmap-pacmap-adgene-normal-conditions-insr-status.pdf</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="08-insr-signalling_csds_files/figure-html/cell-11-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="11">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> matplotlib.rc_context({<span class="st">"figure.figsize"</span>: (<span class="fl">5.5</span>, <span class="dv">4</span>)}):</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    sc.pl.violin(</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>        adata_norm,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>        [<span class="st">"Pomc"</span>, <span class="st">"Agrp"</span>, <span class="st">"Npy"</span>, <span class="st">"Insr"</span>, <span class="st">"Gfap"</span>, <span class="st">"Fos"</span>],</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>        groupby<span class="op">=</span><span class="st">"k_tree"</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>        stripplot<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>        frameon<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>        palette<span class="op">=</span><span class="st">"nipy_spectral"</span>,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>        show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>        save<span class="op">=</span><span class="st">"-violin-adgene-normal-conditions-insr-status.pdf"</span>,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING: saving figure to file ../output/figures/velocity-signalling/violin-violin-adgene-normal-conditions-insr-status.pdf</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="08-insr-signalling_csds_files/figure-html/cell-12-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="12">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>insr_pos_astro <span class="op">=</span> adata_norm[</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    (adata_norm[:, <span class="st">"Insr"</span>].to_df() <span class="op">&gt;</span> <span class="dv">1</span>).stack().values</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (adata_norm.obs_names.isin(adata.obs_names)),</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    :,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>insr_neg_astro <span class="op">=</span> adata_norm[</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    (adata_norm[:, <span class="st">"Insr"</span>].to_df() <span class="op">==</span> <span class="dv">0</span>).stack().values</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (adata_norm.obs_names.isin(adata.obs_names)),</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    :,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="13">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>adata_norm.obs[<span class="st">"goi"</span>] <span class="op">=</span> adata_norm.obs[<span class="st">"k_tree"</span>]</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>adata_norm.obs[<span class="st">"goi"</span>] <span class="op">=</span> adata_norm.obs[<span class="st">"goi"</span>].cat.add_categories(<span class="st">"Astro_INSR+"</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>adata_norm.obs.loc[</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> df: df.index.isin(insr_pos_astro.obs.index), <span class="st">"goi"</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>] <span class="op">=</span> <span class="st">"Astro_INSR+"</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>adata_norm.obs[<span class="st">"goi"</span>] <span class="op">=</span> adata_norm.obs[<span class="st">"goi"</span>].cat.add_categories(<span class="st">"Astro_INSR-"</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>adata_norm.obs.loc[</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> df: df.index.isin(insr_neg_astro.obs.index), <span class="st">"goi"</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>] <span class="op">=</span> <span class="st">"Astro_INSR-"</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>adata_norm <span class="op">=</span> adata_norm[adata_norm.obs[<span class="st">"goi"</span>].isin([<span class="st">"Astro_INSR+"</span>, <span class="st">"Astro_INSR-"</span>])]</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>adata_norm.obs[<span class="st">"goi"</span>].cat.remove_unused_categories(inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="14">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>sc.pl.embedding(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    adata_norm,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    basis<span class="op">=</span><span class="st">"X_pacmap"</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>[</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Rbfox3"</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Adcyap1r1"</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Otp"</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alk"</span>,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Npy1r"</span>,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Npy2r"</span>,</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Gfap"</span>,</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Insr"</span>,</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Slc1a3"</span>,</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Htra1"</span>,</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Mfn2"</span>,</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Fos"</span>,</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    add_outline<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    legend_fontsize<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    legend_fontoutline<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    frameon<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span><span class="st">"nipy_spectral"</span>,</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="st">"-pacmap-subset-int-normal-conditions-insr-status.pdf"</span>,</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING: saving figure to file ../output/figures/velocity-signalling/X_pacmap-pacmap-subset-int-normal-conditions-insr-status.pdf</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="08-insr-signalling_csds_files/figure-html/cell-15-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="15">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>sc.pl.embedding(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    adata_norm,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    basis<span class="op">=</span><span class="st">"X_pacmap"</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>[<span class="st">"goi"</span>],</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    add_outline<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    legend_fontsize<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    legend_fontoutline<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    frameon<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span><span class="st">"nipy_spectral"</span>,</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="st">"-pacmap-subset-goi-normal-conditions-insr-status.pdf"</span>,</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING: saving figure to file ../output/figures/velocity-signalling/X_pacmap-pacmap-subset-goi-normal-conditions-insr-status.pdf</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="08-insr-signalling_csds_files/figure-html/cell-16-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="16">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>sc.pl.embedding(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    adata_norm,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    basis<span class="op">=</span><span class="st">"X_pacmap"</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>[g <span class="cf">for</span> g <span class="kw">in</span> genes_embed <span class="cf">if</span> g <span class="kw">in</span> adata_norm.var_names],</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    add_outline<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    legend_fontsize<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    legend_fontoutline<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    frameon<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span><span class="st">"nipy_spectral"</span>,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="st">"-pacmap-subset-adgene-normal-conditions-insr-status.pdf"</span>,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING: saving figure to file ../output/figures/velocity-signalling/X_pacmap-pacmap-subset-adgene-normal-conditions-insr-status.pdf</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="08-insr-signalling_csds_files/figure-html/cell-17-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="17">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>sc.pp.normalize_total(adata_norm, target_sum<span class="op">=</span><span class="fl">1e4</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>sc.pp.log1p(adata_norm)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate the processed POMC and AGRP/NPY neurons!!!</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>adata_norm <span class="op">=</span> ad.concat([adata_norm, adata_arc_neurons_norm], join<span class="op">=</span><span class="st">"inner"</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>adata_norm.raw <span class="op">=</span> adata_norm</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>adata_norm.obs[<span class="st">"goi"</span>] <span class="op">=</span> pd.Categorical(adata_norm.obs[<span class="st">"goi"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>normalizing counts per cell</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>    finished (0:00:00)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="18">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>li.mt.rank_aggregate(</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    adata_norm,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    groupby<span class="op">=</span><span class="st">"goi"</span>,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    de_method<span class="op">=</span><span class="st">"logreg"</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    expr_prop<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    min_cells<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    return_all_lrs<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    verbose<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    resource_name<span class="op">=</span><span class="st">"mouseconsensus"</span>,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    n_perms<span class="op">=</span><span class="dv">100000</span>,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    seed<span class="op">=</span>reseed,</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>... as `zero_center=True`, sparse input is densified and may lead to large memory consumption</code></pre>
</div>
</div>
<div class="cell" data-execution_count="19">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>adata_norm.uns[<span class="st">"liana_res"</span>].to_csv(<span class="st">"pvn_astro-with_npy_pomc-liana-res.csv"</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>adata_norm.uns[<span class="st">"liana_res"</span>].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="19">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>source</th>
      <th>target</th>
      <th>ligand_complex</th>
      <th>receptor_complex</th>
      <th>lr_means</th>
      <th>cellphone_pvals</th>
      <th>expr_prod</th>
      <th>scaled_weight</th>
      <th>lr_logfc</th>
      <th>spec_weight</th>
      <th>lrscore</th>
      <th>lr_probs</th>
      <th>cellchat_pvals</th>
      <th>steady_rank</th>
      <th>specificity_rank</th>
      <th>magnitude_rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>13202</th>
      <td>Astro_LXN-</td>
      <td>AGRP/NPY neurons</td>
      <td>Nrxn1</td>
      <td>Nlgn1</td>
      <td>3.715075</td>
      <td>0.0</td>
      <td>13.451365</td>
      <td>0.666569</td>
      <td>0.635216</td>
      <td>0.036125</td>
      <td>0.966535</td>
      <td>0.305933</td>
      <td>0.0</td>
      <td>0.000088</td>
      <td>0.000800</td>
      <td>1.472857e-12</td>
    </tr>
    <tr>
      <th>70273</th>
      <td>AGRP/NPY neurons</td>
      <td>Astro_LXN-</td>
      <td>Nlgn1</td>
      <td>Nrxn1</td>
      <td>3.715075</td>
      <td>0.0</td>
      <td>13.451365</td>
      <td>0.666569</td>
      <td>0.635216</td>
      <td>0.036125</td>
      <td>0.966535</td>
      <td>0.305933</td>
      <td>0.0</td>
      <td>0.000088</td>
      <td>0.000800</td>
      <td>1.472857e-12</td>
    </tr>
    <tr>
      <th>10352</th>
      <td>Astro_LXN+</td>
      <td>AGRP/NPY neurons</td>
      <td>Nrxn1</td>
      <td>Nlgn1</td>
      <td>3.701165</td>
      <td>0.0</td>
      <td>13.364478</td>
      <td>0.648234</td>
      <td>0.535365</td>
      <td>0.035892</td>
      <td>0.966430</td>
      <td>0.304189</td>
      <td>0.0</td>
      <td>0.000106</td>
      <td>0.000927</td>
      <td>8.589469e-12</td>
    </tr>
    <tr>
      <th>53173</th>
      <td>AGRP/NPY neurons</td>
      <td>Astro_LXN+</td>
      <td>Nlgn1</td>
      <td>Nrxn1</td>
      <td>3.701165</td>
      <td>0.0</td>
      <td>13.364478</td>
      <td>0.648234</td>
      <td>0.535365</td>
      <td>0.035892</td>
      <td>0.966430</td>
      <td>0.304189</td>
      <td>0.0</td>
      <td>0.000106</td>
      <td>0.000927</td>
      <td>8.589469e-12</td>
    </tr>
    <tr>
      <th>81673</th>
      <td>Astro_LXN-</td>
      <td>Astro_LXN-</td>
      <td>Nlgn1</td>
      <td>Nrxn1</td>
      <td>3.675779</td>
      <td>0.0</td>
      <td>13.112859</td>
      <td>0.629962</td>
      <td>0.675578</td>
      <td>0.035216</td>
      <td>0.966120</td>
      <td>0.299055</td>
      <td>0.0</td>
      <td>0.000125</td>
      <td>0.001062</td>
      <td>2.588553e-11</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="20">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>n2a_norm <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_norm,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"Astro_INSR+"</span>, <span class="st">"Astro_INSR-"</span>],</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"lr_logfc"</span>,</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    n2a_norm</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>n2a_norm.save(filename<span class="op">=</span><span class="st">"liana-dotplot-logfc-normal-conditions-n2a-insr-status.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family ['Dejavu Sans'] not found. Falling back to Helvetica.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family ['Dejavu Sans'] not found. Falling back to Helvetica.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family ['Dejavu Sans'] not found. Falling back to Helvetica.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family ['Dejavu Sans'] not found. Falling back to Helvetica.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family ['Dejavu Sans'] not found. Falling back to Helvetica.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family ['Dejavu Sans'] not found. Falling back to Helvetica.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="21">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>n2a_norm <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_norm,</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"Astro_INSR+"</span>, <span class="st">"Astro_INSR-"</span>],</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>    filterby<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>    filter_lambda<span class="op">=</span><span class="kw">lambda</span> x: x <span class="op">&lt;=</span> <span class="fl">0.01</span>,</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>    n2a_norm</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a>n2a_norm.save(</span>
<span id="cb79-30"><a href="#cb79-30" aria-hidden="true" tabindex="-1"></a>    filename<span class="op">=</span><span class="st">"liana-dotplot-specificity_rank-normal-conditions-n2a-insr-status.pdf"</span></span>
<span id="cb79-31"><a href="#cb79-31" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="22">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>n2a_norm <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_norm,</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"Astro_INSR+"</span>, <span class="st">"Astro_INSR-"</span>],</span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>    filterby<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>    filter_lambda<span class="op">=</span><span class="kw">lambda</span> x: x <span class="op">&lt;=</span> <span class="fl">0.01</span>,</span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-17"><a href="#cb122-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb122-18"><a href="#cb122-18" aria-hidden="true" tabindex="-1"></a>    n2a_norm</span>
<span id="cb122-19"><a href="#cb122-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb122-20"><a href="#cb122-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb122-21"><a href="#cb122-21" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb122-22"><a href="#cb122-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb122-23"><a href="#cb122-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb122-24"><a href="#cb122-24" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb122-25"><a href="#cb122-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb122-26"><a href="#cb122-26" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb122-27"><a href="#cb122-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb122-28"><a href="#cb122-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb122-29"><a href="#cb122-29" aria-hidden="true" tabindex="-1"></a>n2a_norm.save(</span>
<span id="cb122-30"><a href="#cb122-30" aria-hidden="true" tabindex="-1"></a>    filename<span class="op">=</span><span class="st">"liana-dotplot-magnitude_rank-normal-conditions-n2a-insr-status.pdf"</span></span>
<span id="cb122-31"><a href="#cb122-31" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="23">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, filter the DataFrame</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>filtered_df <span class="op">=</span> adata_norm.uns[<span class="st">"liana_res"</span>][</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>    adata_norm.uns[<span class="st">"liana_res"</span>][<span class="st">"receptor_complex"</span>] <span class="op">==</span> <span class="st">"Insr"</span></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Then, pass the filtered DataFrame to the dotplot function</span></span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a>n2a_norm <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a>    liana_res<span class="op">=</span>filtered_df,</span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb165-12"><a href="#cb165-12" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb165-13"><a href="#cb165-13" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb165-14"><a href="#cb165-14" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"Astro_INSR+"</span>, <span class="st">"Astro_INSR-"</span>],</span>
<span id="cb165-15"><a href="#cb165-15" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb165-16"><a href="#cb165-16" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"lr_logfc"</span>,</span>
<span id="cb165-17"><a href="#cb165-17" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb165-18"><a href="#cb165-18" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb165-19"><a href="#cb165-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb165-20"><a href="#cb165-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-21"><a href="#cb165-21" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb165-22"><a href="#cb165-22" aria-hidden="true" tabindex="-1"></a>    n2a_norm</span>
<span id="cb165-23"><a href="#cb165-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb165-24"><a href="#cb165-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb165-25"><a href="#cb165-25" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb165-26"><a href="#cb165-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb165-27"><a href="#cb165-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb165-28"><a href="#cb165-28" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb165-29"><a href="#cb165-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb165-30"><a href="#cb165-30" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb165-31"><a href="#cb165-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb165-32"><a href="#cb165-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb165-33"><a href="#cb165-33" aria-hidden="true" tabindex="-1"></a>n2a_norm.save(filename<span class="op">=</span><span class="st">"liana-dotplot-insr-logfc-normal-conditions-n2a-insr-status.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="24">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>n2a_norm <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>    liana_res<span class="op">=</span>filtered_df,</span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"Astro_INSR+"</span>, <span class="st">"Astro_INSR-"</span>],</span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true" tabindex="-1"></a>    filterby<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb196-10"><a href="#cb196-10" aria-hidden="true" tabindex="-1"></a>    filter_lambda<span class="op">=</span><span class="kw">lambda</span> x: x <span class="op">&lt;=</span> <span class="fl">0.01</span>,</span>
<span id="cb196-11"><a href="#cb196-11" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb196-12"><a href="#cb196-12" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb196-13"><a href="#cb196-13" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb196-14"><a href="#cb196-14" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb196-15"><a href="#cb196-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb196-16"><a href="#cb196-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-17"><a href="#cb196-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb196-18"><a href="#cb196-18" aria-hidden="true" tabindex="-1"></a>    n2a_norm</span>
<span id="cb196-19"><a href="#cb196-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb196-20"><a href="#cb196-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb196-21"><a href="#cb196-21" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb196-22"><a href="#cb196-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb196-23"><a href="#cb196-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb196-24"><a href="#cb196-24" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb196-25"><a href="#cb196-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb196-26"><a href="#cb196-26" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb196-27"><a href="#cb196-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb196-28"><a href="#cb196-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb196-29"><a href="#cb196-29" aria-hidden="true" tabindex="-1"></a>n2a_norm.save(</span>
<span id="cb196-30"><a href="#cb196-30" aria-hidden="true" tabindex="-1"></a>    filename<span class="op">=</span><span class="st">"liana-dotplot-insr-specificity_rank-normal-conditions-n2a-insr-status.pdf"</span></span>
<span id="cb196-31"><a href="#cb196-31" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="25">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>n2a_norm <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>    liana_res<span class="op">=</span>filtered_df,</span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"Astro_INSR+"</span>, <span class="st">"Astro_INSR-"</span>],</span>
<span id="cb224-9"><a href="#cb224-9" aria-hidden="true" tabindex="-1"></a>    filterby<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb224-10"><a href="#cb224-10" aria-hidden="true" tabindex="-1"></a>    filter_lambda<span class="op">=</span><span class="kw">lambda</span> x: x <span class="op">&lt;=</span> <span class="fl">0.01</span>,</span>
<span id="cb224-11"><a href="#cb224-11" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb224-12"><a href="#cb224-12" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb224-13"><a href="#cb224-13" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb224-14"><a href="#cb224-14" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb224-15"><a href="#cb224-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb224-16"><a href="#cb224-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-17"><a href="#cb224-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb224-18"><a href="#cb224-18" aria-hidden="true" tabindex="-1"></a>    n2a_norm</span>
<span id="cb224-19"><a href="#cb224-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb224-20"><a href="#cb224-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb224-21"><a href="#cb224-21" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb224-22"><a href="#cb224-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb224-23"><a href="#cb224-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb224-24"><a href="#cb224-24" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb224-25"><a href="#cb224-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb224-26"><a href="#cb224-26" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb224-27"><a href="#cb224-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb224-28"><a href="#cb224-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb224-29"><a href="#cb224-29" aria-hidden="true" tabindex="-1"></a>n2a_norm.save(</span>
<span id="cb224-30"><a href="#cb224-30" aria-hidden="true" tabindex="-1"></a>    filename<span class="op">=</span><span class="st">"liana-dotplot-insr-magnitude_rank-normal-conditions-n2a-insr-status.pdf"</span></span>
<span id="cb224-31"><a href="#cb224-31" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="26">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a>a2n_norm <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_norm,</span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb255-4"><a href="#cb255-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb255-5"><a href="#cb255-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb255-6"><a href="#cb255-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb255-7"><a href="#cb255-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"Astro_INSR+"</span>, <span class="st">"Astro_INSR-"</span>],</span>
<span id="cb255-8"><a href="#cb255-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb255-9"><a href="#cb255-9" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb255-10"><a href="#cb255-10" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"lr_logfc"</span>,</span>
<span id="cb255-11"><a href="#cb255-11" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb255-12"><a href="#cb255-12" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb255-13"><a href="#cb255-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb255-14"><a href="#cb255-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-15"><a href="#cb255-15" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb255-16"><a href="#cb255-16" aria-hidden="true" tabindex="-1"></a>    a2n_norm</span>
<span id="cb255-17"><a href="#cb255-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb255-18"><a href="#cb255-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb255-19"><a href="#cb255-19" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb255-20"><a href="#cb255-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb255-21"><a href="#cb255-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb255-22"><a href="#cb255-22" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb255-23"><a href="#cb255-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb255-24"><a href="#cb255-24" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb255-25"><a href="#cb255-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb255-26"><a href="#cb255-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb255-27"><a href="#cb255-27" aria-hidden="true" tabindex="-1"></a>a2n_norm.save(filename<span class="op">=</span><span class="st">"liana-dotplot-logfc-normal-conditions-a2n-insr-status.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="27">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb296"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a>a2n_norm <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_norm,</span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb296-4"><a href="#cb296-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb296-5"><a href="#cb296-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb296-6"><a href="#cb296-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb296-7"><a href="#cb296-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"Astro_INSR+"</span>, <span class="st">"Astro_INSR-"</span>],</span>
<span id="cb296-8"><a href="#cb296-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb296-9"><a href="#cb296-9" aria-hidden="true" tabindex="-1"></a>    filterby<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb296-10"><a href="#cb296-10" aria-hidden="true" tabindex="-1"></a>    filter_lambda<span class="op">=</span><span class="kw">lambda</span> x: x <span class="op">&lt;=</span> <span class="fl">0.01</span>,</span>
<span id="cb296-11"><a href="#cb296-11" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb296-12"><a href="#cb296-12" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb296-13"><a href="#cb296-13" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb296-14"><a href="#cb296-14" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb296-15"><a href="#cb296-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb296-16"><a href="#cb296-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-17"><a href="#cb296-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb296-18"><a href="#cb296-18" aria-hidden="true" tabindex="-1"></a>    a2n_norm</span>
<span id="cb296-19"><a href="#cb296-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb296-20"><a href="#cb296-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb296-21"><a href="#cb296-21" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb296-22"><a href="#cb296-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb296-23"><a href="#cb296-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb296-24"><a href="#cb296-24" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb296-25"><a href="#cb296-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb296-26"><a href="#cb296-26" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb296-27"><a href="#cb296-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb296-28"><a href="#cb296-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb296-29"><a href="#cb296-29" aria-hidden="true" tabindex="-1"></a>a2n_norm.save(</span>
<span id="cb296-30"><a href="#cb296-30" aria-hidden="true" tabindex="-1"></a>    filename<span class="op">=</span><span class="st">"liana-dotplot-specificity_rank-normal-conditions-a2n-insr-status.pdf"</span></span>
<span id="cb296-31"><a href="#cb296-31" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="28">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb339"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a>a2n_norm <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb339-2"><a href="#cb339-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_norm,</span>
<span id="cb339-3"><a href="#cb339-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb339-4"><a href="#cb339-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb339-5"><a href="#cb339-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb339-6"><a href="#cb339-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb339-7"><a href="#cb339-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"Astro_INSR+"</span>, <span class="st">"Astro_INSR-"</span>],</span>
<span id="cb339-8"><a href="#cb339-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb339-9"><a href="#cb339-9" aria-hidden="true" tabindex="-1"></a>    filterby<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb339-10"><a href="#cb339-10" aria-hidden="true" tabindex="-1"></a>    filter_lambda<span class="op">=</span><span class="kw">lambda</span> x: x <span class="op">&lt;=</span> <span class="fl">0.01</span>,</span>
<span id="cb339-11"><a href="#cb339-11" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb339-12"><a href="#cb339-12" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb339-13"><a href="#cb339-13" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb339-14"><a href="#cb339-14" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb339-15"><a href="#cb339-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb339-16"><a href="#cb339-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-17"><a href="#cb339-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb339-18"><a href="#cb339-18" aria-hidden="true" tabindex="-1"></a>    a2n_norm</span>
<span id="cb339-19"><a href="#cb339-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb339-20"><a href="#cb339-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb339-21"><a href="#cb339-21" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb339-22"><a href="#cb339-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb339-23"><a href="#cb339-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb339-24"><a href="#cb339-24" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb339-25"><a href="#cb339-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb339-26"><a href="#cb339-26" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb339-27"><a href="#cb339-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb339-28"><a href="#cb339-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb339-29"><a href="#cb339-29" aria-hidden="true" tabindex="-1"></a>a2n_norm.save(</span>
<span id="cb339-30"><a href="#cb339-30" aria-hidden="true" tabindex="-1"></a>    filename<span class="op">=</span><span class="st">"liana-dotplot-magnitude_rank-normal-conditions-a2n-insr-status.pdf"</span></span>
<span id="cb339-31"><a href="#cb339-31" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<p>Save data</p>
<div class="cell" data-execution_count="29">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb382"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb382-1"><a href="#cb382-1" aria-hidden="true" tabindex="-1"></a>adata_norm.write(</span>
<span id="cb382-2"><a href="#cb382-2" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"/data/</span><span class="sc">{</span>bioproject<span class="sc">}</span><span class="ss">/data/velocity-signalling/</span><span class="sc">{</span>bioproject<span class="sc">}</span><span class="ss">-signalling-norm-insr-status.h5ad"</span></span>
<span id="cb382-3"><a href="#cb382-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="chronic-stress-model" class="level4">
<h4 class="anchored" data-anchor-id="chronic-stress-model">Chronic Stress Model</h4>
<div class="cell" data-execution_count="30">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb383"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a>adata_chronic_stress.obs[<span class="st">"k_tree"</span>] <span class="op">=</span> adata_chronic_stress.obs[<span class="st">"k_tree"</span>].astype(</span>
<span id="cb383-2"><a href="#cb383-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"category"</span></span>
<span id="cb383-3"><a href="#cb383-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb383-4"><a href="#cb383-4" aria-hidden="true" tabindex="-1"></a>adata_chronic_stress.raw.X</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>&lt;3078x22835 sparse matrix of type '&lt;class 'numpy.float32'&gt;'
    with 9267589 stored elements in Compressed Sparse Column format&gt;</code></pre>
</div>
</div>
<p>subset groups of interest</p>
<div class="cell" data-execution_count="31">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb385"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a>sc.pl.umap(</span>
<span id="cb385-2"><a href="#cb385-2" aria-hidden="true" tabindex="-1"></a>    adata_chronic_stress,</span>
<span id="cb385-3"><a href="#cb385-3" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>[<span class="st">"k_tree"</span>],</span>
<span id="cb385-4"><a href="#cb385-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span>pt_size,</span>
<span id="cb385-5"><a href="#cb385-5" aria-hidden="true" tabindex="-1"></a>    legend_loc<span class="op">=</span><span class="st">"on data"</span>,</span>
<span id="cb385-6"><a href="#cb385-6" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb385-7"><a href="#cb385-7" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb385-8"><a href="#cb385-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="08-insr-signalling_csds_files/figure-html/cell-32-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="32">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb386"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb386-1"><a href="#cb386-1" aria-hidden="true" tabindex="-1"></a>sc.pl.umap(</span>
<span id="cb386-2"><a href="#cb386-2" aria-hidden="true" tabindex="-1"></a>    adata_chronic_stress,</span>
<span id="cb386-3"><a href="#cb386-3" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>[</span>
<span id="cb386-4"><a href="#cb386-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Rbfox3"</span>,</span>
<span id="cb386-5"><a href="#cb386-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Adcyap1r1"</span>,</span>
<span id="cb386-6"><a href="#cb386-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Otp"</span>,</span>
<span id="cb386-7"><a href="#cb386-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alk"</span>,</span>
<span id="cb386-8"><a href="#cb386-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Npy1r"</span>,</span>
<span id="cb386-9"><a href="#cb386-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Npy2r"</span>,</span>
<span id="cb386-10"><a href="#cb386-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Gfap"</span>,</span>
<span id="cb386-11"><a href="#cb386-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Insr"</span>,</span>
<span id="cb386-12"><a href="#cb386-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Slc1a3"</span>,</span>
<span id="cb386-13"><a href="#cb386-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Htra1"</span>,</span>
<span id="cb386-14"><a href="#cb386-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Mfn2"</span>,</span>
<span id="cb386-15"><a href="#cb386-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Fos"</span>,</span>
<span id="cb386-16"><a href="#cb386-16" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb386-17"><a href="#cb386-17" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb386-18"><a href="#cb386-18" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span>pt_size,</span>
<span id="cb386-19"><a href="#cb386-19" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb386-20"><a href="#cb386-20" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb386-21"><a href="#cb386-21" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="08-insr-signalling_csds_files/figure-html/cell-33-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="33">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb387"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true" tabindex="-1"></a>sc.pl.embedding(</span>
<span id="cb387-2"><a href="#cb387-2" aria-hidden="true" tabindex="-1"></a>    adata_chronic_stress,</span>
<span id="cb387-3"><a href="#cb387-3" aria-hidden="true" tabindex="-1"></a>    basis<span class="op">=</span><span class="st">"X_pacmap"</span>,</span>
<span id="cb387-4"><a href="#cb387-4" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>[</span>
<span id="cb387-5"><a href="#cb387-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Rbfox3"</span>,</span>
<span id="cb387-6"><a href="#cb387-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Adcyap1r1"</span>,</span>
<span id="cb387-7"><a href="#cb387-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Otp"</span>,</span>
<span id="cb387-8"><a href="#cb387-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alk"</span>,</span>
<span id="cb387-9"><a href="#cb387-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Npy1r"</span>,</span>
<span id="cb387-10"><a href="#cb387-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Npy2r"</span>,</span>
<span id="cb387-11"><a href="#cb387-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Gfap"</span>,</span>
<span id="cb387-12"><a href="#cb387-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Insr"</span>,</span>
<span id="cb387-13"><a href="#cb387-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Slc1a3"</span>,</span>
<span id="cb387-14"><a href="#cb387-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Htra1"</span>,</span>
<span id="cb387-15"><a href="#cb387-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Mfn2"</span>,</span>
<span id="cb387-16"><a href="#cb387-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Fos"</span>,</span>
<span id="cb387-17"><a href="#cb387-17" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb387-18"><a href="#cb387-18" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb387-19"><a href="#cb387-19" aria-hidden="true" tabindex="-1"></a>    add_outline<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb387-20"><a href="#cb387-20" aria-hidden="true" tabindex="-1"></a>    legend_fontsize<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb387-21"><a href="#cb387-21" aria-hidden="true" tabindex="-1"></a>    legend_fontoutline<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb387-22"><a href="#cb387-22" aria-hidden="true" tabindex="-1"></a>    frameon<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb387-23"><a href="#cb387-23" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span><span class="st">"nipy_spectral"</span>,</span>
<span id="cb387-24"><a href="#cb387-24" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb387-25"><a href="#cb387-25" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="st">"-pacmap-int-chronic-stress-insr-status.pdf"</span>,</span>
<span id="cb387-26"><a href="#cb387-26" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING: saving figure to file ../output/figures/velocity-signalling/X_pacmap-pacmap-int-chronic-stress-insr-status.pdf</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="08-insr-signalling_csds_files/figure-html/cell-34-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="34">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb389"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a>sc.pl.embedding(</span>
<span id="cb389-2"><a href="#cb389-2" aria-hidden="true" tabindex="-1"></a>    adata_chronic_stress,</span>
<span id="cb389-3"><a href="#cb389-3" aria-hidden="true" tabindex="-1"></a>    basis<span class="op">=</span><span class="st">"X_pacmap"</span>,</span>
<span id="cb389-4"><a href="#cb389-4" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>[g <span class="cf">for</span> g <span class="kw">in</span> genes_embed <span class="cf">if</span> g <span class="kw">in</span> adata_chronic_stress.var_names],</span>
<span id="cb389-5"><a href="#cb389-5" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb389-6"><a href="#cb389-6" aria-hidden="true" tabindex="-1"></a>    add_outline<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb389-7"><a href="#cb389-7" aria-hidden="true" tabindex="-1"></a>    legend_fontsize<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb389-8"><a href="#cb389-8" aria-hidden="true" tabindex="-1"></a>    legend_fontoutline<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb389-9"><a href="#cb389-9" aria-hidden="true" tabindex="-1"></a>    frameon<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb389-10"><a href="#cb389-10" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span><span class="st">"nipy_spectral"</span>,</span>
<span id="cb389-11"><a href="#cb389-11" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb389-12"><a href="#cb389-12" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="st">"-pacmap-adgene-chronic-stress-insr-status.pdf"</span>,</span>
<span id="cb389-13"><a href="#cb389-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING: saving figure to file ../output/figures/velocity-signalling/X_pacmap-pacmap-adgene-chronic-stress-insr-status.pdf</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="08-insr-signalling_csds_files/figure-html/cell-35-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="35">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb391"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb391-1"><a href="#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> matplotlib.rc_context({<span class="st">"figure.figsize"</span>: (<span class="fl">5.5</span>, <span class="dv">4</span>)}):</span>
<span id="cb391-2"><a href="#cb391-2" aria-hidden="true" tabindex="-1"></a>    sc.pl.violin(</span>
<span id="cb391-3"><a href="#cb391-3" aria-hidden="true" tabindex="-1"></a>        adata_chronic_stress,</span>
<span id="cb391-4"><a href="#cb391-4" aria-hidden="true" tabindex="-1"></a>        [<span class="st">"Pomc"</span>, <span class="st">"Agrp"</span>, <span class="st">"Npy"</span>, <span class="st">"Insr"</span>, <span class="st">"Gfap"</span>, <span class="st">"Fos"</span>],</span>
<span id="cb391-5"><a href="#cb391-5" aria-hidden="true" tabindex="-1"></a>        groupby<span class="op">=</span><span class="st">"k_tree"</span>,</span>
<span id="cb391-6"><a href="#cb391-6" aria-hidden="true" tabindex="-1"></a>        stripplot<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb391-7"><a href="#cb391-7" aria-hidden="true" tabindex="-1"></a>        frameon<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb391-8"><a href="#cb391-8" aria-hidden="true" tabindex="-1"></a>        palette<span class="op">=</span><span class="st">"nipy_spectral"</span>,</span>
<span id="cb391-9"><a href="#cb391-9" aria-hidden="true" tabindex="-1"></a>        show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb391-10"><a href="#cb391-10" aria-hidden="true" tabindex="-1"></a>        save<span class="op">=</span><span class="st">"-violin-adgene-chronic-stress-insr-status.pdf"</span>,</span>
<span id="cb391-11"><a href="#cb391-11" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING: saving figure to file ../output/figures/velocity-signalling/violin-violin-adgene-chronic-stress-insr-status.pdf</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="08-insr-signalling_csds_files/figure-html/cell-36-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="36">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb393"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true" tabindex="-1"></a>insr_pos_astro <span class="op">=</span> adata_chronic_stress[</span>
<span id="cb393-2"><a href="#cb393-2" aria-hidden="true" tabindex="-1"></a>    (adata_chronic_stress[:, <span class="st">"Insr"</span>].to_df() <span class="op">&gt;</span> <span class="dv">1</span>).stack().values</span>
<span id="cb393-3"><a href="#cb393-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (adata_chronic_stress.obs_names.isin(adata.obs_names)),</span>
<span id="cb393-4"><a href="#cb393-4" aria-hidden="true" tabindex="-1"></a>    :,</span>
<span id="cb393-5"><a href="#cb393-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb393-6"><a href="#cb393-6" aria-hidden="true" tabindex="-1"></a>insr_neg_astro <span class="op">=</span> adata_chronic_stress[</span>
<span id="cb393-7"><a href="#cb393-7" aria-hidden="true" tabindex="-1"></a>    (adata_chronic_stress[:, <span class="st">"Insr"</span>].to_df() <span class="op">==</span> <span class="dv">0</span>).stack().values</span>
<span id="cb393-8"><a href="#cb393-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (adata_chronic_stress.obs_names.isin(adata.obs_names)),</span>
<span id="cb393-9"><a href="#cb393-9" aria-hidden="true" tabindex="-1"></a>    :,</span>
<span id="cb393-10"><a href="#cb393-10" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="37">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb394"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true" tabindex="-1"></a>adata_chronic_stress.obs[<span class="st">"goi"</span>] <span class="op">=</span> adata_chronic_stress.obs[<span class="st">"k_tree"</span>]</span>
<span id="cb394-2"><a href="#cb394-2" aria-hidden="true" tabindex="-1"></a>adata_chronic_stress.obs[<span class="st">"goi"</span>] <span class="op">=</span> adata_chronic_stress.obs[<span class="st">"goi"</span>].cat.add_categories(</span>
<span id="cb394-3"><a href="#cb394-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Astro_INSR+"</span></span>
<span id="cb394-4"><a href="#cb394-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb394-5"><a href="#cb394-5" aria-hidden="true" tabindex="-1"></a>adata_chronic_stress.obs.loc[</span>
<span id="cb394-6"><a href="#cb394-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> df: df.index.isin(insr_pos_astro.obs.index), <span class="st">"goi"</span></span>
<span id="cb394-7"><a href="#cb394-7" aria-hidden="true" tabindex="-1"></a>] <span class="op">=</span> <span class="st">"Astro_INSR+"</span></span>
<span id="cb394-8"><a href="#cb394-8" aria-hidden="true" tabindex="-1"></a>adata_chronic_stress.obs[<span class="st">"goi"</span>] <span class="op">=</span> adata_chronic_stress.obs[<span class="st">"goi"</span>].cat.add_categories(</span>
<span id="cb394-9"><a href="#cb394-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Astro_INSR-"</span></span>
<span id="cb394-10"><a href="#cb394-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb394-11"><a href="#cb394-11" aria-hidden="true" tabindex="-1"></a>adata_chronic_stress.obs.loc[</span>
<span id="cb394-12"><a href="#cb394-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> df: df.index.isin(insr_neg_astro.obs.index), <span class="st">"goi"</span></span>
<span id="cb394-13"><a href="#cb394-13" aria-hidden="true" tabindex="-1"></a>] <span class="op">=</span> <span class="st">"Astro_INSR-"</span></span>
<span id="cb394-14"><a href="#cb394-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-15"><a href="#cb394-15" aria-hidden="true" tabindex="-1"></a>adata_chronic_stress <span class="op">=</span> adata_chronic_stress[</span>
<span id="cb394-16"><a href="#cb394-16" aria-hidden="true" tabindex="-1"></a>    adata_chronic_stress.obs[<span class="st">"goi"</span>].isin([<span class="st">"Astro_INSR+"</span>, <span class="st">"Astro_INSR-"</span>])</span>
<span id="cb394-17"><a href="#cb394-17" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb394-18"><a href="#cb394-18" aria-hidden="true" tabindex="-1"></a>adata_chronic_stress.obs[<span class="st">"goi"</span>].cat.remove_unused_categories(inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="38">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb395"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb395-1"><a href="#cb395-1" aria-hidden="true" tabindex="-1"></a>sc.pl.embedding(</span>
<span id="cb395-2"><a href="#cb395-2" aria-hidden="true" tabindex="-1"></a>    adata_chronic_stress,</span>
<span id="cb395-3"><a href="#cb395-3" aria-hidden="true" tabindex="-1"></a>    basis<span class="op">=</span><span class="st">"X_pacmap"</span>,</span>
<span id="cb395-4"><a href="#cb395-4" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>[</span>
<span id="cb395-5"><a href="#cb395-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Rbfox3"</span>,</span>
<span id="cb395-6"><a href="#cb395-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Adcyap1r1"</span>,</span>
<span id="cb395-7"><a href="#cb395-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Otp"</span>,</span>
<span id="cb395-8"><a href="#cb395-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alk"</span>,</span>
<span id="cb395-9"><a href="#cb395-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Npy1r"</span>,</span>
<span id="cb395-10"><a href="#cb395-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Npy2r"</span>,</span>
<span id="cb395-11"><a href="#cb395-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Gfap"</span>,</span>
<span id="cb395-12"><a href="#cb395-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Insr"</span>,</span>
<span id="cb395-13"><a href="#cb395-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Slc1a3"</span>,</span>
<span id="cb395-14"><a href="#cb395-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Htra1"</span>,</span>
<span id="cb395-15"><a href="#cb395-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Mfn2"</span>,</span>
<span id="cb395-16"><a href="#cb395-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Fos"</span>,</span>
<span id="cb395-17"><a href="#cb395-17" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb395-18"><a href="#cb395-18" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb395-19"><a href="#cb395-19" aria-hidden="true" tabindex="-1"></a>    add_outline<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb395-20"><a href="#cb395-20" aria-hidden="true" tabindex="-1"></a>    legend_fontsize<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb395-21"><a href="#cb395-21" aria-hidden="true" tabindex="-1"></a>    legend_fontoutline<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb395-22"><a href="#cb395-22" aria-hidden="true" tabindex="-1"></a>    frameon<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb395-23"><a href="#cb395-23" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span><span class="st">"nipy_spectral"</span>,</span>
<span id="cb395-24"><a href="#cb395-24" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb395-25"><a href="#cb395-25" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="st">"-pacmap-subset-int-chronic-stress-insr-status.pdf"</span>,</span>
<span id="cb395-26"><a href="#cb395-26" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING: saving figure to file ../output/figures/velocity-signalling/X_pacmap-pacmap-subset-int-chronic-stress-insr-status.pdf</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="08-insr-signalling_csds_files/figure-html/cell-39-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="39">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb397"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb397-1"><a href="#cb397-1" aria-hidden="true" tabindex="-1"></a>sc.pl.embedding(</span>
<span id="cb397-2"><a href="#cb397-2" aria-hidden="true" tabindex="-1"></a>    adata_chronic_stress,</span>
<span id="cb397-3"><a href="#cb397-3" aria-hidden="true" tabindex="-1"></a>    basis<span class="op">=</span><span class="st">"X_pacmap"</span>,</span>
<span id="cb397-4"><a href="#cb397-4" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>[g <span class="cf">for</span> g <span class="kw">in</span> genes_embed <span class="cf">if</span> g <span class="kw">in</span> adata_chronic_stress.var_names],</span>
<span id="cb397-5"><a href="#cb397-5" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb397-6"><a href="#cb397-6" aria-hidden="true" tabindex="-1"></a>    add_outline<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb397-7"><a href="#cb397-7" aria-hidden="true" tabindex="-1"></a>    legend_fontsize<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb397-8"><a href="#cb397-8" aria-hidden="true" tabindex="-1"></a>    legend_fontoutline<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb397-9"><a href="#cb397-9" aria-hidden="true" tabindex="-1"></a>    frameon<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb397-10"><a href="#cb397-10" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span><span class="st">"nipy_spectral"</span>,</span>
<span id="cb397-11"><a href="#cb397-11" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb397-12"><a href="#cb397-12" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="st">"-pacmap-subset-adgene-chronic-stress-insr-status.pdf"</span>,</span>
<span id="cb397-13"><a href="#cb397-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING: saving figure to file ../output/figures/velocity-signalling/X_pacmap-pacmap-subset-adgene-chronic-stress-insr-status.pdf</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="08-insr-signalling_csds_files/figure-html/cell-40-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="40">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb399"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb399-1"><a href="#cb399-1" aria-hidden="true" tabindex="-1"></a>sc.pp.normalize_total(adata_chronic_stress, target_sum<span class="op">=</span><span class="fl">1e4</span>)</span>
<span id="cb399-2"><a href="#cb399-2" aria-hidden="true" tabindex="-1"></a>sc.pp.log1p(adata_chronic_stress)</span>
<span id="cb399-3"><a href="#cb399-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate the processed POMC and AGRP/NPY neurons in HFHS diet condition!!!</span></span>
<span id="cb399-4"><a href="#cb399-4" aria-hidden="true" tabindex="-1"></a>adata_chronic_stress <span class="op">=</span> ad.concat(</span>
<span id="cb399-5"><a href="#cb399-5" aria-hidden="true" tabindex="-1"></a>    [adata_chronic_stress, adata_arc_neurons_hfhsdiet], join<span class="op">=</span><span class="st">"inner"</span></span>
<span id="cb399-6"><a href="#cb399-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb399-7"><a href="#cb399-7" aria-hidden="true" tabindex="-1"></a>adata_chronic_stress.raw <span class="op">=</span> adata_chronic_stress</span>
<span id="cb399-8"><a href="#cb399-8" aria-hidden="true" tabindex="-1"></a>adata_chronic_stress.obs[<span class="st">"goi"</span>] <span class="op">=</span> pd.Categorical(adata_chronic_stress.obs[<span class="st">"goi"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>normalizing counts per cell</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>    finished (0:00:00)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="41">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb402"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb402-1"><a href="#cb402-1" aria-hidden="true" tabindex="-1"></a>li.mt.rank_aggregate(</span>
<span id="cb402-2"><a href="#cb402-2" aria-hidden="true" tabindex="-1"></a>    adata_chronic_stress,</span>
<span id="cb402-3"><a href="#cb402-3" aria-hidden="true" tabindex="-1"></a>    groupby<span class="op">=</span><span class="st">"goi"</span>,</span>
<span id="cb402-4"><a href="#cb402-4" aria-hidden="true" tabindex="-1"></a>    de_method<span class="op">=</span><span class="st">"logreg"</span>,</span>
<span id="cb402-5"><a href="#cb402-5" aria-hidden="true" tabindex="-1"></a>    expr_prop<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb402-6"><a href="#cb402-6" aria-hidden="true" tabindex="-1"></a>    min_cells<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb402-7"><a href="#cb402-7" aria-hidden="true" tabindex="-1"></a>    return_all_lrs<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb402-8"><a href="#cb402-8" aria-hidden="true" tabindex="-1"></a>    verbose<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb402-9"><a href="#cb402-9" aria-hidden="true" tabindex="-1"></a>    resource_name<span class="op">=</span><span class="st">"mouseconsensus"</span>,</span>
<span id="cb402-10"><a href="#cb402-10" aria-hidden="true" tabindex="-1"></a>    n_perms<span class="op">=</span><span class="dv">100000</span>,</span>
<span id="cb402-11"><a href="#cb402-11" aria-hidden="true" tabindex="-1"></a>    seed<span class="op">=</span>reseed,</span>
<span id="cb402-12"><a href="#cb402-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>... as `zero_center=True`, sparse input is densified and may lead to large memory consumption</code></pre>
</div>
</div>
<div class="cell" data-execution_count="42">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb404"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb404-1"><a href="#cb404-1" aria-hidden="true" tabindex="-1"></a>adata_chronic_stress.uns[<span class="st">"liana_res"</span>].to_csv(</span>
<span id="cb404-2"><a href="#cb404-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"chronic-stress-pvn_astro-with_npy_pomc-liana-res.csv"</span></span>
<span id="cb404-3"><a href="#cb404-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb404-4"><a href="#cb404-4" aria-hidden="true" tabindex="-1"></a>adata_chronic_stress.uns[<span class="st">"liana_res"</span>].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="42">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>source</th>
      <th>target</th>
      <th>ligand_complex</th>
      <th>receptor_complex</th>
      <th>lr_means</th>
      <th>cellphone_pvals</th>
      <th>expr_prod</th>
      <th>scaled_weight</th>
      <th>lr_logfc</th>
      <th>spec_weight</th>
      <th>lrscore</th>
      <th>lr_probs</th>
      <th>cellchat_pvals</th>
      <th>steady_rank</th>
      <th>specificity_rank</th>
      <th>magnitude_rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>87718</th>
      <td>POMC neurons</td>
      <td>Astro_LXN-</td>
      <td>Nlgn1</td>
      <td>Nrxn1</td>
      <td>3.746233</td>
      <td>0.0</td>
      <td>13.775460</td>
      <td>0.709753</td>
      <td>0.723233</td>
      <td>0.036367</td>
      <td>0.965010</td>
      <td>0.305823</td>
      <td>0.0</td>
      <td>0.000037</td>
      <td>0.000398</td>
      <td>2.867858e-13</td>
    </tr>
    <tr>
      <th>102433</th>
      <td>Astro_LXN-</td>
      <td>POMC neurons</td>
      <td>Nrxn1</td>
      <td>Nlgn1</td>
      <td>3.746233</td>
      <td>0.0</td>
      <td>13.775460</td>
      <td>0.709753</td>
      <td>0.723233</td>
      <td>0.036367</td>
      <td>0.965010</td>
      <td>0.305823</td>
      <td>0.0</td>
      <td>0.000037</td>
      <td>0.000398</td>
      <td>2.867858e-13</td>
    </tr>
    <tr>
      <th>99474</th>
      <td>Astro_LXN+</td>
      <td>POMC neurons</td>
      <td>Nrxn1</td>
      <td>Nlgn1</td>
      <td>3.714226</td>
      <td>0.0</td>
      <td>13.568213</td>
      <td>0.666295</td>
      <td>0.575151</td>
      <td>0.035820</td>
      <td>0.964753</td>
      <td>0.303164</td>
      <td>0.0</td>
      <td>0.000051</td>
      <td>0.000515</td>
      <td>3.643146e-12</td>
    </tr>
    <tr>
      <th>69964</th>
      <td>POMC neurons</td>
      <td>Astro_LXN+</td>
      <td>Nlgn1</td>
      <td>Nrxn1</td>
      <td>3.714226</td>
      <td>0.0</td>
      <td>13.568213</td>
      <td>0.666295</td>
      <td>0.575151</td>
      <td>0.035820</td>
      <td>0.964753</td>
      <td>0.303164</td>
      <td>0.0</td>
      <td>0.000051</td>
      <td>0.000515</td>
      <td>3.643146e-12</td>
    </tr>
    <tr>
      <th>72923</th>
      <td>AGRP/NPY neurons</td>
      <td>Astro_LXN-</td>
      <td>Nlgn1</td>
      <td>Nrxn1</td>
      <td>3.678081</td>
      <td>0.0</td>
      <td>13.195488</td>
      <td>0.644333</td>
      <td>0.648921</td>
      <td>0.034836</td>
      <td>0.964277</td>
      <td>0.292762</td>
      <td>0.0</td>
      <td>0.000059</td>
      <td>0.000584</td>
      <td>1.413674e-11</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="43">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb405"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb405-1"><a href="#cb405-1" aria-hidden="true" tabindex="-1"></a>n2a_chronic_stress <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb405-2"><a href="#cb405-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_chronic_stress,</span>
<span id="cb405-3"><a href="#cb405-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb405-4"><a href="#cb405-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb405-5"><a href="#cb405-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb405-6"><a href="#cb405-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb405-7"><a href="#cb405-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb405-8"><a href="#cb405-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"Astro_INSR+"</span>, <span class="st">"Astro_INSR-"</span>],</span>
<span id="cb405-9"><a href="#cb405-9" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb405-10"><a href="#cb405-10" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"lr_logfc"</span>,</span>
<span id="cb405-11"><a href="#cb405-11" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb405-12"><a href="#cb405-12" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb405-13"><a href="#cb405-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb405-14"><a href="#cb405-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb405-15"><a href="#cb405-15" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb405-16"><a href="#cb405-16" aria-hidden="true" tabindex="-1"></a>    n2a_chronic_stress</span>
<span id="cb405-17"><a href="#cb405-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb405-18"><a href="#cb405-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb405-19"><a href="#cb405-19" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb405-20"><a href="#cb405-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb405-21"><a href="#cb405-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb405-22"><a href="#cb405-22" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb405-23"><a href="#cb405-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb405-24"><a href="#cb405-24" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb405-25"><a href="#cb405-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb405-26"><a href="#cb405-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb405-27"><a href="#cb405-27" aria-hidden="true" tabindex="-1"></a>n2a_chronic_stress.save(</span>
<span id="cb405-28"><a href="#cb405-28" aria-hidden="true" tabindex="-1"></a>    filename<span class="op">=</span><span class="st">"liana-dotplot-logfc-chronic-stress-n2a-insr-status.pdf"</span></span>
<span id="cb405-29"><a href="#cb405-29" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="44">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb446"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb446-1"><a href="#cb446-1" aria-hidden="true" tabindex="-1"></a>n2a_chronic_stress <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb446-2"><a href="#cb446-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_chronic_stress,</span>
<span id="cb446-3"><a href="#cb446-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb446-4"><a href="#cb446-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb446-5"><a href="#cb446-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb446-6"><a href="#cb446-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb446-7"><a href="#cb446-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb446-8"><a href="#cb446-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"Astro_INSR+"</span>, <span class="st">"Astro_INSR-"</span>],</span>
<span id="cb446-9"><a href="#cb446-9" aria-hidden="true" tabindex="-1"></a>    filterby<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb446-10"><a href="#cb446-10" aria-hidden="true" tabindex="-1"></a>    filter_lambda<span class="op">=</span><span class="kw">lambda</span> x: x <span class="op">&lt;=</span> <span class="fl">0.01</span>,</span>
<span id="cb446-11"><a href="#cb446-11" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb446-12"><a href="#cb446-12" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb446-13"><a href="#cb446-13" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb446-14"><a href="#cb446-14" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb446-15"><a href="#cb446-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb446-16"><a href="#cb446-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-17"><a href="#cb446-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb446-18"><a href="#cb446-18" aria-hidden="true" tabindex="-1"></a>    n2a_chronic_stress</span>
<span id="cb446-19"><a href="#cb446-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb446-20"><a href="#cb446-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb446-21"><a href="#cb446-21" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb446-22"><a href="#cb446-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb446-23"><a href="#cb446-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb446-24"><a href="#cb446-24" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb446-25"><a href="#cb446-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb446-26"><a href="#cb446-26" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb446-27"><a href="#cb446-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb446-28"><a href="#cb446-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb446-29"><a href="#cb446-29" aria-hidden="true" tabindex="-1"></a>n2a_chronic_stress.save(</span>
<span id="cb446-30"><a href="#cb446-30" aria-hidden="true" tabindex="-1"></a>    filename<span class="op">=</span><span class="st">"liana-dotplot-specificity_rank-chronic-stress-n2a-insr-status.pdf"</span></span>
<span id="cb446-31"><a href="#cb446-31" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="45">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb488"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb488-1"><a href="#cb488-1" aria-hidden="true" tabindex="-1"></a>n2a_chronic_stress <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb488-2"><a href="#cb488-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_chronic_stress,</span>
<span id="cb488-3"><a href="#cb488-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb488-4"><a href="#cb488-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb488-5"><a href="#cb488-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb488-6"><a href="#cb488-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb488-7"><a href="#cb488-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb488-8"><a href="#cb488-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"Astro_INSR+"</span>, <span class="st">"Astro_INSR-"</span>],</span>
<span id="cb488-9"><a href="#cb488-9" aria-hidden="true" tabindex="-1"></a>    filterby<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb488-10"><a href="#cb488-10" aria-hidden="true" tabindex="-1"></a>    filter_lambda<span class="op">=</span><span class="kw">lambda</span> x: x <span class="op">&lt;=</span> <span class="fl">0.01</span>,</span>
<span id="cb488-11"><a href="#cb488-11" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb488-12"><a href="#cb488-12" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb488-13"><a href="#cb488-13" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb488-14"><a href="#cb488-14" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb488-15"><a href="#cb488-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb488-16"><a href="#cb488-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb488-17"><a href="#cb488-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb488-18"><a href="#cb488-18" aria-hidden="true" tabindex="-1"></a>    n2a_chronic_stress</span>
<span id="cb488-19"><a href="#cb488-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb488-20"><a href="#cb488-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb488-21"><a href="#cb488-21" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb488-22"><a href="#cb488-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb488-23"><a href="#cb488-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb488-24"><a href="#cb488-24" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb488-25"><a href="#cb488-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb488-26"><a href="#cb488-26" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb488-27"><a href="#cb488-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb488-28"><a href="#cb488-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb488-29"><a href="#cb488-29" aria-hidden="true" tabindex="-1"></a>n2a_chronic_stress.save(</span>
<span id="cb488-30"><a href="#cb488-30" aria-hidden="true" tabindex="-1"></a>    filename<span class="op">=</span><span class="st">"liana-dotplot-magnitude_rank-chronic-stress-n2a-insr-status.pdf"</span></span>
<span id="cb488-31"><a href="#cb488-31" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="46">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb528"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb528-1"><a href="#cb528-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, filter the DataFrame</span></span>
<span id="cb528-2"><a href="#cb528-2" aria-hidden="true" tabindex="-1"></a>filtered_df <span class="op">=</span> adata_chronic_stress.uns[<span class="st">"liana_res"</span>][</span>
<span id="cb528-3"><a href="#cb528-3" aria-hidden="true" tabindex="-1"></a>    adata_chronic_stress.uns[<span class="st">"liana_res"</span>][<span class="st">"receptor_complex"</span>] <span class="op">==</span> <span class="st">"Insr"</span></span>
<span id="cb528-4"><a href="#cb528-4" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb528-5"><a href="#cb528-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb528-6"><a href="#cb528-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Then, pass the filtered DataFrame to the dotplot function</span></span>
<span id="cb528-7"><a href="#cb528-7" aria-hidden="true" tabindex="-1"></a>n2a_chronic_stress <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb528-8"><a href="#cb528-8" aria-hidden="true" tabindex="-1"></a>    liana_res<span class="op">=</span>filtered_df,</span>
<span id="cb528-9"><a href="#cb528-9" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb528-10"><a href="#cb528-10" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb528-11"><a href="#cb528-11" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb528-12"><a href="#cb528-12" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb528-13"><a href="#cb528-13" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb528-14"><a href="#cb528-14" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"Astro_INSR+"</span>, <span class="st">"Astro_INSR-"</span>],</span>
<span id="cb528-15"><a href="#cb528-15" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb528-16"><a href="#cb528-16" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"lr_logfc"</span>,</span>
<span id="cb528-17"><a href="#cb528-17" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb528-18"><a href="#cb528-18" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb528-19"><a href="#cb528-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb528-20"><a href="#cb528-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb528-21"><a href="#cb528-21" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb528-22"><a href="#cb528-22" aria-hidden="true" tabindex="-1"></a>    n2a_chronic_stress</span>
<span id="cb528-23"><a href="#cb528-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb528-24"><a href="#cb528-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb528-25"><a href="#cb528-25" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb528-26"><a href="#cb528-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb528-27"><a href="#cb528-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb528-28"><a href="#cb528-28" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb528-29"><a href="#cb528-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb528-30"><a href="#cb528-30" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb528-31"><a href="#cb528-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb528-32"><a href="#cb528-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb528-33"><a href="#cb528-33" aria-hidden="true" tabindex="-1"></a>n2a_chronic_stress.save(</span>
<span id="cb528-34"><a href="#cb528-34" aria-hidden="true" tabindex="-1"></a>    filename<span class="op">=</span><span class="st">"liana-dotplot-insr-logfc-chronic-stress-n2a-insr-status.pdf"</span></span>
<span id="cb528-35"><a href="#cb528-35" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="47">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb556"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb556-1"><a href="#cb556-1" aria-hidden="true" tabindex="-1"></a>n2a_chronic_stress <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb556-2"><a href="#cb556-2" aria-hidden="true" tabindex="-1"></a>    liana_res<span class="op">=</span>filtered_df,</span>
<span id="cb556-3"><a href="#cb556-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb556-4"><a href="#cb556-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb556-5"><a href="#cb556-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb556-6"><a href="#cb556-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb556-7"><a href="#cb556-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb556-8"><a href="#cb556-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"Astro_INSR+"</span>, <span class="st">"Astro_INSR-"</span>],</span>
<span id="cb556-9"><a href="#cb556-9" aria-hidden="true" tabindex="-1"></a>    filterby<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb556-10"><a href="#cb556-10" aria-hidden="true" tabindex="-1"></a>    filter_lambda<span class="op">=</span><span class="kw">lambda</span> x: x <span class="op">&lt;=</span> <span class="fl">0.01</span>,</span>
<span id="cb556-11"><a href="#cb556-11" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb556-12"><a href="#cb556-12" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb556-13"><a href="#cb556-13" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb556-14"><a href="#cb556-14" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb556-15"><a href="#cb556-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb556-16"><a href="#cb556-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb556-17"><a href="#cb556-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb556-18"><a href="#cb556-18" aria-hidden="true" tabindex="-1"></a>    n2a_chronic_stress</span>
<span id="cb556-19"><a href="#cb556-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb556-20"><a href="#cb556-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb556-21"><a href="#cb556-21" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb556-22"><a href="#cb556-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb556-23"><a href="#cb556-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb556-24"><a href="#cb556-24" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb556-25"><a href="#cb556-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb556-26"><a href="#cb556-26" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb556-27"><a href="#cb556-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb556-28"><a href="#cb556-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb556-29"><a href="#cb556-29" aria-hidden="true" tabindex="-1"></a>n2a_chronic_stress.save(</span>
<span id="cb556-30"><a href="#cb556-30" aria-hidden="true" tabindex="-1"></a>    filename<span class="op">=</span><span class="st">"liana-dotplot-insr-specificity_rank-chronic-stress-n2a-insr-status.pdf"</span></span>
<span id="cb556-31"><a href="#cb556-31" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="48">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb581"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb581-1"><a href="#cb581-1" aria-hidden="true" tabindex="-1"></a>n2a_chronic_stress <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb581-2"><a href="#cb581-2" aria-hidden="true" tabindex="-1"></a>    liana_res<span class="op">=</span>filtered_df,</span>
<span id="cb581-3"><a href="#cb581-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb581-4"><a href="#cb581-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb581-5"><a href="#cb581-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb581-6"><a href="#cb581-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb581-7"><a href="#cb581-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb581-8"><a href="#cb581-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"Astro_INSR+"</span>, <span class="st">"Astro_INSR-"</span>],</span>
<span id="cb581-9"><a href="#cb581-9" aria-hidden="true" tabindex="-1"></a>    filterby<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb581-10"><a href="#cb581-10" aria-hidden="true" tabindex="-1"></a>    filter_lambda<span class="op">=</span><span class="kw">lambda</span> x: x <span class="op">&lt;=</span> <span class="fl">0.01</span>,</span>
<span id="cb581-11"><a href="#cb581-11" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb581-12"><a href="#cb581-12" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb581-13"><a href="#cb581-13" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb581-14"><a href="#cb581-14" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb581-15"><a href="#cb581-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb581-16"><a href="#cb581-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb581-17"><a href="#cb581-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb581-18"><a href="#cb581-18" aria-hidden="true" tabindex="-1"></a>    n2a_chronic_stress</span>
<span id="cb581-19"><a href="#cb581-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb581-20"><a href="#cb581-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb581-21"><a href="#cb581-21" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb581-22"><a href="#cb581-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb581-23"><a href="#cb581-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb581-24"><a href="#cb581-24" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb581-25"><a href="#cb581-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb581-26"><a href="#cb581-26" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb581-27"><a href="#cb581-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb581-28"><a href="#cb581-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb581-29"><a href="#cb581-29" aria-hidden="true" tabindex="-1"></a>n2a_chronic_stress.save(</span>
<span id="cb581-30"><a href="#cb581-30" aria-hidden="true" tabindex="-1"></a>    filename<span class="op">=</span><span class="st">"liana-dotplot-insr-magnitude_rank-chronic-stress-n2a-insr-status.pdf"</span></span>
<span id="cb581-31"><a href="#cb581-31" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="49">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb609"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb609-1"><a href="#cb609-1" aria-hidden="true" tabindex="-1"></a>a2n_chronic_stress <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb609-2"><a href="#cb609-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_chronic_stress,</span>
<span id="cb609-3"><a href="#cb609-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb609-4"><a href="#cb609-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb609-5"><a href="#cb609-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb609-6"><a href="#cb609-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb609-7"><a href="#cb609-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"Astro_INSR+"</span>, <span class="st">"Astro_INSR-"</span>],</span>
<span id="cb609-8"><a href="#cb609-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb609-9"><a href="#cb609-9" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb609-10"><a href="#cb609-10" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"lr_logfc"</span>,</span>
<span id="cb609-11"><a href="#cb609-11" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb609-12"><a href="#cb609-12" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb609-13"><a href="#cb609-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb609-14"><a href="#cb609-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb609-15"><a href="#cb609-15" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb609-16"><a href="#cb609-16" aria-hidden="true" tabindex="-1"></a>    a2n_chronic_stress</span>
<span id="cb609-17"><a href="#cb609-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb609-18"><a href="#cb609-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb609-19"><a href="#cb609-19" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb609-20"><a href="#cb609-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb609-21"><a href="#cb609-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb609-22"><a href="#cb609-22" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb609-23"><a href="#cb609-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb609-24"><a href="#cb609-24" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb609-25"><a href="#cb609-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb609-26"><a href="#cb609-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb609-27"><a href="#cb609-27" aria-hidden="true" tabindex="-1"></a>a2n_chronic_stress.save(</span>
<span id="cb609-28"><a href="#cb609-28" aria-hidden="true" tabindex="-1"></a>    filename<span class="op">=</span><span class="st">"liana-dotplot-logfc-chronic-stress-a2n-insr-status.pdf"</span></span>
<span id="cb609-29"><a href="#cb609-29" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="50">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb649"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb649-1"><a href="#cb649-1" aria-hidden="true" tabindex="-1"></a>a2n_chronic_stress <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb649-2"><a href="#cb649-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_chronic_stress,</span>
<span id="cb649-3"><a href="#cb649-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb649-4"><a href="#cb649-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb649-5"><a href="#cb649-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb649-6"><a href="#cb649-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb649-7"><a href="#cb649-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"Astro_INSR+"</span>, <span class="st">"Astro_INSR-"</span>],</span>
<span id="cb649-8"><a href="#cb649-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb649-9"><a href="#cb649-9" aria-hidden="true" tabindex="-1"></a>    filterby<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb649-10"><a href="#cb649-10" aria-hidden="true" tabindex="-1"></a>    filter_lambda<span class="op">=</span><span class="kw">lambda</span> x: x <span class="op">&lt;=</span> <span class="fl">0.01</span>,</span>
<span id="cb649-11"><a href="#cb649-11" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb649-12"><a href="#cb649-12" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb649-13"><a href="#cb649-13" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb649-14"><a href="#cb649-14" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb649-15"><a href="#cb649-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb649-16"><a href="#cb649-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb649-17"><a href="#cb649-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb649-18"><a href="#cb649-18" aria-hidden="true" tabindex="-1"></a>    a2n_chronic_stress</span>
<span id="cb649-19"><a href="#cb649-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb649-20"><a href="#cb649-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb649-21"><a href="#cb649-21" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb649-22"><a href="#cb649-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb649-23"><a href="#cb649-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb649-24"><a href="#cb649-24" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb649-25"><a href="#cb649-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb649-26"><a href="#cb649-26" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb649-27"><a href="#cb649-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb649-28"><a href="#cb649-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb649-29"><a href="#cb649-29" aria-hidden="true" tabindex="-1"></a>a2n_chronic_stress.save(</span>
<span id="cb649-30"><a href="#cb649-30" aria-hidden="true" tabindex="-1"></a>    filename<span class="op">=</span><span class="st">"liana-dotplot-specificity_rank-chronic-stress-a2n-insr-status.pdf"</span></span>
<span id="cb649-31"><a href="#cb649-31" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="51">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb689"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb689-1"><a href="#cb689-1" aria-hidden="true" tabindex="-1"></a>a2n_chronic_stress <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb689-2"><a href="#cb689-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_chronic_stress,</span>
<span id="cb689-3"><a href="#cb689-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb689-4"><a href="#cb689-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb689-5"><a href="#cb689-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb689-6"><a href="#cb689-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb689-7"><a href="#cb689-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"Astro_INSR+"</span>, <span class="st">"Astro_INSR-"</span>],</span>
<span id="cb689-8"><a href="#cb689-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb689-9"><a href="#cb689-9" aria-hidden="true" tabindex="-1"></a>    filterby<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb689-10"><a href="#cb689-10" aria-hidden="true" tabindex="-1"></a>    filter_lambda<span class="op">=</span><span class="kw">lambda</span> x: x <span class="op">&lt;=</span> <span class="fl">0.01</span>,</span>
<span id="cb689-11"><a href="#cb689-11" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb689-12"><a href="#cb689-12" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb689-13"><a href="#cb689-13" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb689-14"><a href="#cb689-14" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb689-15"><a href="#cb689-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb689-16"><a href="#cb689-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb689-17"><a href="#cb689-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb689-18"><a href="#cb689-18" aria-hidden="true" tabindex="-1"></a>    a2n_chronic_stress</span>
<span id="cb689-19"><a href="#cb689-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb689-20"><a href="#cb689-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb689-21"><a href="#cb689-21" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb689-22"><a href="#cb689-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb689-23"><a href="#cb689-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb689-24"><a href="#cb689-24" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb689-25"><a href="#cb689-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb689-26"><a href="#cb689-26" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb689-27"><a href="#cb689-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb689-28"><a href="#cb689-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb689-29"><a href="#cb689-29" aria-hidden="true" tabindex="-1"></a>a2n_chronic_stress.save(</span>
<span id="cb689-30"><a href="#cb689-30" aria-hidden="true" tabindex="-1"></a>    filename<span class="op">=</span><span class="st">"liana-dotplot-magnitude_rank-chronic-stress-a2n-insr-status.pdf"</span></span>
<span id="cb689-31"><a href="#cb689-31" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<p>Save data</p>
<div class="cell" data-execution_count="52">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb730"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb730-1"><a href="#cb730-1" aria-hidden="true" tabindex="-1"></a>adata_chronic_stress.write(</span>
<span id="cb730-2"><a href="#cb730-2" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"/data/</span><span class="sc">{</span>bioproject<span class="sc">}</span><span class="ss">/data/velocity-signalling/</span><span class="sc">{</span>bioproject<span class="sc">}</span><span class="ss">-signalling-treatment-insr-status.h5ad"</span></span>
<span id="cb730-3"><a href="#cb730-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Session information</p>
<div class="cell" data-execution_count="53">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb731"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb731-1"><a href="#cb731-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(watermark())</span>
<span id="cb731-2"><a href="#cb731-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(watermark(iversions<span class="op">=</span><span class="va">True</span>, globals_<span class="op">=</span><span class="bu">globals</span>()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Last updated: 2023-07-27T13:10:52.369658+00:00

Python implementation: CPython
Python version       : 3.8.8
IPython version      : 8.12.1

Compiler    : GCC 9.3.0
OS          : Linux
Release     : 5.15.0-76-generic
Machine     : x86_64
Processor   : x86_64
CPU cores   : 256
Architecture: 64bit

sklearn   : 1.2.2
cellrank  : 1.5.1
pacmap    : 0.7.0
umap      : 0.5.3
numpy     : 1.23.5
pandas    : 1.5.3
plotnine  : 0.10.1
liana     : 0.1.8
scanpy    : 1.9.3
scipy     : 1.10.1
scvelo    : 0.2.5
anndata   : 0.9.1
matplotlib: 3.7.1
</code></pre>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>