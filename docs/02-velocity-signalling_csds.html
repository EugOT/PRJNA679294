<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.262">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Evgenii O. Tretiakov">

<title>Dynamics of the hypothalamic paraventricular nucleus response to chronic stress and signalling between astrocytic groups and Agrp or POMC neurons</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="02-velocity-signalling_csds_files/libs/clipboard/clipboard.min.js"></script>
<script src="02-velocity-signalling_csds_files/libs/quarto-html/quarto.js"></script>
<script src="02-velocity-signalling_csds_files/libs/quarto-html/popper.min.js"></script>
<script src="02-velocity-signalling_csds_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="02-velocity-signalling_csds_files/libs/quarto-html/anchor.min.js"></script>
<link href="02-velocity-signalling_csds_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="02-velocity-signalling_csds_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="02-velocity-signalling_csds_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="02-velocity-signalling_csds_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="02-velocity-signalling_csds_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#genes" id="toc-genes" class="nav-link active" data-scroll-target="#genes">genes</a></li>
  <li><a href="#parameters" id="toc-parameters" class="nav-link" data-scroll-target="#parameters">parameters</a></li>
  <li><a href="#load-data" id="toc-load-data" class="nav-link" data-scroll-target="#load-data">Load data</a></li>
  <li><a href="#signalling-analysis" id="toc-signalling-analysis" class="nav-link" data-scroll-target="#signalling-analysis">Signalling analysis</a></li>
  <li><a href="#preprocess-data-for-velocity" id="toc-preprocess-data-for-velocity" class="nav-link" data-scroll-target="#preprocess-data-for-velocity">Preprocess data for velocity</a></li>
  <li><a href="#rna-velocity" id="toc-rna-velocity" class="nav-link" data-scroll-target="#rna-velocity">RNA velocity</a></li>
  <li><a href="#save-data" id="toc-save-data" class="nav-link" data-scroll-target="#save-data">Save data</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Dynamics of the hypothalamic paraventricular nucleus response to chronic stress and signalling between astrocytic groups and Agrp or POMC neurons</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Evgenii O. Tretiakov </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<div class="cell" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sklearn</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> watermark <span class="im">import</span> watermark</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.utils <span class="im">import</span> check_random_state</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> gprofiler <span class="im">import</span> GProfiler</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pacmap</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> umap</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scvelo <span class="im">as</span> scv</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scanpy <span class="im">as</span> sc</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cellrank <span class="im">as</span> cr</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> anndata <span class="im">as</span> ad</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotnine <span class="im">as</span> p9</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> liana <span class="im">as</span> li</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> liana.mt <span class="im">import</span> rank_aggregate</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>warnings.simplefilter(<span class="st">"ignore"</span>, category<span class="op">=</span><span class="pp">UserWarning</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>warnings.simplefilter(<span class="st">"ignore"</span>, category<span class="op">=</span><span class="pp">FutureWarning</span>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>warnings.simplefilter(<span class="st">"ignore"</span>, category<span class="op">=</span><span class="pp">DeprecationWarning</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="genes" class="level3">
<h3 class="anchored" data-anchor-id="genes">genes</h3>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>npr <span class="op">=</span> [</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adcyap1r1"</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Avpr1a"</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Calcr"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Calcrl"</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cckar"</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cckbr"</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cntfr"</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Crhr1"</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Crhr2"</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Esr1"</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Galr1"</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Galr2"</span>,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Galr3"</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ghr"</span>,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ghrhr"</span>,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ghsr"</span>,</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Glp1r"</span>,</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gpr55"</span>,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gpr83"</span>,</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gpr149"</span>,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grpr"</span>,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Hcrtr1"</span>,</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Hcrtr2"</span>,</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Igf1r"</span>,</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Insr"</span>,</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Insrr"</span>,</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Kiss1r"</span>,</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Lepr"</span>,</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mc1r"</span>,</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mc3r"</span>,</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mc4r"</span>,</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mchr1"</span>,</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nmbr"</span>,</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nmur1"</span>,</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nmur2"</span>,</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npffr1"</span>,</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npffr2"</span>,</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npr1"</span>,</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npr2"</span>,</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npr3"</span>,</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npsr1"</span>,</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npsr2"</span>,</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npy1r"</span>,</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npy2r"</span>,</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npy5r"</span>,</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ntrk2"</span>,</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ntsr1"</span>,</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ntsr2"</span>,</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Oprd1"</span>,</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Oprk1"</span>,</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Oprl1"</span>,</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Oprm1"</span>,</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Oxtr"</span>,</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Prlhr"</span>,</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Prlr"</span>,</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Prokr2"</span>,</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Qrfpr"</span>,</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Rxfp1"</span>,</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Rxfp2"</span>,</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sstr1"</span>,</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sstr2"</span>,</span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sstr3"</span>,</span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Tacr1"</span>,</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Tacr3"</span>,</span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Trhr"</span>,</span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Trhr2"</span>,</span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Tshr"</span>,</span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Vipr1"</span>,</span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Vipr2"</span>,</span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>npep <span class="op">=</span> [</span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adcyap1"</span>,</span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Agrp"</span>,</span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Avp"</span>,</span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Bdnf"</span>,</span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cartpt"</span>,</span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cck"</span>,</span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cntf"</span>,</span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Crh"</span>,</span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gal"</span>,</span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ghrh"</span>,</span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ghrl"</span>,</span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grp"</span>,</span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Hcrt"</span>,</span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Kiss1"</span>,</span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Lep"</span>,</span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nmb"</span>,</span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nms"</span>,</span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nmu"</span>,</span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npvf"</span>,</span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npw"</span>,</span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npy"</span>,</span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nts"</span>,</span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Oxt"</span>,</span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pdyn"</span>,</span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Penk"</span>,</span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pmch"</span>,</span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pnoc"</span>,</span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pomc"</span>,</span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Qrfp"</span>,</span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Reln"</span>,</span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Rln1"</span>,</span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Rln3"</span>,</span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sst"</span>,</span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Tac1"</span>,</span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Tac2"</span>,</span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Trh"</span>,</span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a>genes_embed <span class="op">=</span> [</span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Abcd1"</span>,</span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Abcd2"</span>,</span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Abcd3"</span>,</span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Acaa1"</span>,</span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Acaa2"</span>,</span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Acox1"</span>,</span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Agt"</span>,</span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Aldh1a1"</span>,</span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Aldh1l1"</span>,</span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Aldoc"</span>,</span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Apoe"</span>,</span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Aqp4"</span>,</span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Caf4"</span>,</span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ckb"</span>,</span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cnr1"</span>,</span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cnr2"</span>,</span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cst3"</span>,</span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Dagla"</span>,</span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Daglb"</span>,</span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Decr2"</span>,</span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Dnm1"</span>,</span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Drp1"</span>,</span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ech1"</span>,</span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Egfr"</span>,</span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Eno1"</span>,</span>
<span id="cb2-138"><a href="#cb2-138" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Faah"</span>,</span>
<span id="cb2-139"><a href="#cb2-139" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fgfr3"</span>,</span>
<span id="cb2-140"><a href="#cb2-140" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fis1"</span>,</span>
<span id="cb2-141"><a href="#cb2-141" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fos"</span>,</span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fth1"</span>,</span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ftl1"</span>,</span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gfap"</span>,</span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gja1"</span>,</span>
<span id="cb2-146"><a href="#cb2-146" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gli1"</span>,</span>
<span id="cb2-147"><a href="#cb2-147" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Glul"</span>,</span>
<span id="cb2-148"><a href="#cb2-148" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Hacd2"</span>,</span>
<span id="cb2-149"><a href="#cb2-149" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Hadhb"</span>,</span>
<span id="cb2-150"><a href="#cb2-150" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Hepacam"</span>,</span>
<span id="cb2-151"><a href="#cb2-151" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Hif1"</span>,</span>
<span id="cb2-152"><a href="#cb2-152" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htra1"</span>,</span>
<span id="cb2-153"><a href="#cb2-153" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Lcat"</span>,</span>
<span id="cb2-154"><a href="#cb2-154" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Lpcat3"</span>,</span>
<span id="cb2-155"><a href="#cb2-155" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Lxn"</span>,</span>
<span id="cb2-156"><a href="#cb2-156" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mdv1"</span>,</span>
<span id="cb2-157"><a href="#cb2-157" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mfn1"</span>,</span>
<span id="cb2-158"><a href="#cb2-158" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mfn2"</span>,</span>
<span id="cb2-159"><a href="#cb2-159" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mgll"</span>,</span>
<span id="cb2-160"><a href="#cb2-160" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mief1"</span>,</span>
<span id="cb2-161"><a href="#cb2-161" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Napepld"</span>,</span>
<span id="cb2-162"><a href="#cb2-162" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ndrg2"</span>,</span>
<span id="cb2-163"><a href="#cb2-163" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nfia"</span>,</span>
<span id="cb2-164"><a href="#cb2-164" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Opa1"</span>,</span>
<span id="cb2-165"><a href="#cb2-165" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Otp"</span>,</span>
<span id="cb2-166"><a href="#cb2-166" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pex1"</span>,</span>
<span id="cb2-167"><a href="#cb2-167" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pex10"</span>,</span>
<span id="cb2-168"><a href="#cb2-168" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pex12"</span>,</span>
<span id="cb2-169"><a href="#cb2-169" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pex13"</span>,</span>
<span id="cb2-170"><a href="#cb2-170" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pex14"</span>,</span>
<span id="cb2-171"><a href="#cb2-171" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pex16"</span>,</span>
<span id="cb2-172"><a href="#cb2-172" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pex2"</span>,</span>
<span id="cb2-173"><a href="#cb2-173" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pex26"</span>,</span>
<span id="cb2-174"><a href="#cb2-174" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pex3"</span>,</span>
<span id="cb2-175"><a href="#cb2-175" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pex6"</span>,</span>
<span id="cb2-176"><a href="#cb2-176" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pla2g7"</span>,</span>
<span id="cb2-177"><a href="#cb2-177" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Plcb1"</span>,</span>
<span id="cb2-178"><a href="#cb2-178" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pygb"</span>,</span>
<span id="cb2-179"><a href="#cb2-179" aria-hidden="true" tabindex="-1"></a>    <span class="st">"S100a6"</span>,</span>
<span id="cb2-180"><a href="#cb2-180" aria-hidden="true" tabindex="-1"></a>    <span class="st">"S100b"</span>,</span>
<span id="cb2-181"><a href="#cb2-181" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Scd2"</span>,</span>
<span id="cb2-182"><a href="#cb2-182" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sgcd"</span>,</span>
<span id="cb2-183"><a href="#cb2-183" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slc1a2"</span>,</span>
<span id="cb2-184"><a href="#cb2-184" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slc1a3"</span>,</span>
<span id="cb2-185"><a href="#cb2-185" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slc4a4"</span>,</span>
<span id="cb2-186"><a href="#cb2-186" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slc6a11"</span>,</span>
<span id="cb2-187"><a href="#cb2-187" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slc7a10"</span>,</span>
<span id="cb2-188"><a href="#cb2-188" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slc38a1"</span>,</span>
<span id="cb2-189"><a href="#cb2-189" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slit1"</span>,</span>
<span id="cb2-190"><a href="#cb2-190" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slit2"</span>,</span>
<span id="cb2-191"><a href="#cb2-191" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sox9"</span>,</span>
<span id="cb2-192"><a href="#cb2-192" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Tafa1"</span>,</span>
<span id="cb2-193"><a href="#cb2-193" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Tkt"</span>,</span>
<span id="cb2-194"><a href="#cb2-194" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Trpv1"</span>,</span>
<span id="cb2-195"><a href="#cb2-195" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb2-196"><a href="#cb2-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-197"><a href="#cb2-197" aria-hidden="true" tabindex="-1"></a>nmr <span class="op">=</span> [</span>
<span id="cb2-198"><a href="#cb2-198" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adra1a"</span>,</span>
<span id="cb2-199"><a href="#cb2-199" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adra1b"</span>,</span>
<span id="cb2-200"><a href="#cb2-200" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adra1d"</span>,</span>
<span id="cb2-201"><a href="#cb2-201" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adra2a"</span>,</span>
<span id="cb2-202"><a href="#cb2-202" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adra2b"</span>,</span>
<span id="cb2-203"><a href="#cb2-203" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adra2c"</span>,</span>
<span id="cb2-204"><a href="#cb2-204" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adrb1"</span>,</span>
<span id="cb2-205"><a href="#cb2-205" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adrb2"</span>,</span>
<span id="cb2-206"><a href="#cb2-206" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adrb3"</span>,</span>
<span id="cb2-207"><a href="#cb2-207" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adrbk1"</span>,</span>
<span id="cb2-208"><a href="#cb2-208" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adrbk2"</span>,</span>
<span id="cb2-209"><a href="#cb2-209" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adrm1"</span>,  <span class="co"># adrenergic receptors</span></span>
<span id="cb2-210"><a href="#cb2-210" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adora1"</span>,</span>
<span id="cb2-211"><a href="#cb2-211" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adora2a"</span>,</span>
<span id="cb2-212"><a href="#cb2-212" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adora2b"</span>,</span>
<span id="cb2-213"><a href="#cb2-213" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adora3"</span>,  <span class="co"># adenosine receptors</span></span>
<span id="cb2-214"><a href="#cb2-214" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrna1"</span>,</span>
<span id="cb2-215"><a href="#cb2-215" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrna2"</span>,</span>
<span id="cb2-216"><a href="#cb2-216" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrna3"</span>,</span>
<span id="cb2-217"><a href="#cb2-217" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrna4"</span>,</span>
<span id="cb2-218"><a href="#cb2-218" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrna5"</span>,</span>
<span id="cb2-219"><a href="#cb2-219" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrna6"</span>,</span>
<span id="cb2-220"><a href="#cb2-220" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrna7"</span>,</span>
<span id="cb2-221"><a href="#cb2-221" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrna9"</span>,</span>
<span id="cb2-222"><a href="#cb2-222" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrna10"</span>,</span>
<span id="cb2-223"><a href="#cb2-223" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrnb1"</span>,</span>
<span id="cb2-224"><a href="#cb2-224" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrnb2"</span>,</span>
<span id="cb2-225"><a href="#cb2-225" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrnb3"</span>,</span>
<span id="cb2-226"><a href="#cb2-226" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrnd"</span>,</span>
<span id="cb2-227"><a href="#cb2-227" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrng"</span>,  <span class="co"># cholinergic receptors</span></span>
<span id="cb2-228"><a href="#cb2-228" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gria1"</span>,</span>
<span id="cb2-229"><a href="#cb2-229" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gria2"</span>,</span>
<span id="cb2-230"><a href="#cb2-230" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gria3"</span>,</span>
<span id="cb2-231"><a href="#cb2-231" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gria4"</span>,  <span class="co"># iGlu AMPA receptors</span></span>
<span id="cb2-232"><a href="#cb2-232" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grid1"</span>,</span>
<span id="cb2-233"><a href="#cb2-233" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grid2"</span>,  <span class="co"># iGlu delta receptors</span></span>
<span id="cb2-234"><a href="#cb2-234" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grik1"</span>,</span>
<span id="cb2-235"><a href="#cb2-235" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grik2"</span>,</span>
<span id="cb2-236"><a href="#cb2-236" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grik3"</span>,</span>
<span id="cb2-237"><a href="#cb2-237" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grik4"</span>,</span>
<span id="cb2-238"><a href="#cb2-238" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grik5"</span>,  <span class="co"># iGlu kainate receptors</span></span>
<span id="cb2-239"><a href="#cb2-239" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grin1"</span>,</span>
<span id="cb2-240"><a href="#cb2-240" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grin2a"</span>,</span>
<span id="cb2-241"><a href="#cb2-241" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grin2b"</span>,</span>
<span id="cb2-242"><a href="#cb2-242" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grin2c"</span>,</span>
<span id="cb2-243"><a href="#cb2-243" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grin2d"</span>,</span>
<span id="cb2-244"><a href="#cb2-244" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grin3a"</span>,</span>
<span id="cb2-245"><a href="#cb2-245" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grin3b"</span>,  <span class="co"># iGlu NMDA receptors</span></span>
<span id="cb2-246"><a href="#cb2-246" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grm1"</span>,</span>
<span id="cb2-247"><a href="#cb2-247" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grm5"</span>,  <span class="co"># mGluRs 1</span></span>
<span id="cb2-248"><a href="#cb2-248" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grm2"</span>,</span>
<span id="cb2-249"><a href="#cb2-249" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grm3"</span>,  <span class="co"># mGluRs 2</span></span>
<span id="cb2-250"><a href="#cb2-250" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grm4"</span>,</span>
<span id="cb2-251"><a href="#cb2-251" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grm6"</span>,</span>
<span id="cb2-252"><a href="#cb2-252" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grm7"</span>,</span>
<span id="cb2-253"><a href="#cb2-253" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grm8"</span>,  <span class="co"># mGluRs 3</span></span>
<span id="cb2-254"><a href="#cb2-254" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabra1"</span>,</span>
<span id="cb2-255"><a href="#cb2-255" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabra2"</span>,</span>
<span id="cb2-256"><a href="#cb2-256" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabra3"</span>,</span>
<span id="cb2-257"><a href="#cb2-257" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabra4"</span>,</span>
<span id="cb2-258"><a href="#cb2-258" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabra5"</span>,</span>
<span id="cb2-259"><a href="#cb2-259" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabra6"</span>,</span>
<span id="cb2-260"><a href="#cb2-260" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrb1"</span>,</span>
<span id="cb2-261"><a href="#cb2-261" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrb2"</span>,</span>
<span id="cb2-262"><a href="#cb2-262" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrb3"</span>,</span>
<span id="cb2-263"><a href="#cb2-263" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrg1"</span>,</span>
<span id="cb2-264"><a href="#cb2-264" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrg2"</span>,</span>
<span id="cb2-265"><a href="#cb2-265" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrg3"</span>,</span>
<span id="cb2-266"><a href="#cb2-266" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrd"</span>,</span>
<span id="cb2-267"><a href="#cb2-267" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabre"</span>,</span>
<span id="cb2-268"><a href="#cb2-268" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrp"</span>,</span>
<span id="cb2-269"><a href="#cb2-269" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrq"</span>,</span>
<span id="cb2-270"><a href="#cb2-270" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrr1"</span>,</span>
<span id="cb2-271"><a href="#cb2-271" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrr2"</span>,</span>
<span id="cb2-272"><a href="#cb2-272" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrr3"</span>,</span>
<span id="cb2-273"><a href="#cb2-273" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabbr1"</span>,</span>
<span id="cb2-274"><a href="#cb2-274" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabbr2"</span>,  <span class="co"># GABA receptors</span></span>
<span id="cb2-275"><a href="#cb2-275" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Drd1"</span>,</span>
<span id="cb2-276"><a href="#cb2-276" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Drd2"</span>,</span>
<span id="cb2-277"><a href="#cb2-277" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Drd3"</span>,</span>
<span id="cb2-278"><a href="#cb2-278" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Drd4"</span>,</span>
<span id="cb2-279"><a href="#cb2-279" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Drd5"</span>,  <span class="co"># dopamine receptors</span></span>
<span id="cb2-280"><a href="#cb2-280" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr1a"</span>,</span>
<span id="cb2-281"><a href="#cb2-281" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr1b"</span>,</span>
<span id="cb2-282"><a href="#cb2-282" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr1d"</span>,</span>
<span id="cb2-283"><a href="#cb2-283" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr1f"</span>,</span>
<span id="cb2-284"><a href="#cb2-284" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr2a"</span>,</span>
<span id="cb2-285"><a href="#cb2-285" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr2b"</span>,</span>
<span id="cb2-286"><a href="#cb2-286" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr2c"</span>,</span>
<span id="cb2-287"><a href="#cb2-287" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr3a"</span>,</span>
<span id="cb2-288"><a href="#cb2-288" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr3b"</span>,</span>
<span id="cb2-289"><a href="#cb2-289" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr4"</span>,</span>
<span id="cb2-290"><a href="#cb2-290" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr5a"</span>,</span>
<span id="cb2-291"><a href="#cb2-291" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr5b"</span>,</span>
<span id="cb2-292"><a href="#cb2-292" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr6"</span>,</span>
<span id="cb2-293"><a href="#cb2-293" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr7"</span>,  <span class="co"># serotonin receptors</span></span>
<span id="cb2-294"><a href="#cb2-294" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnas"</span>,</span>
<span id="cb2-295"><a href="#cb2-295" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnai1"</span>,</span>
<span id="cb2-296"><a href="#cb2-296" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnai2"</span>,</span>
<span id="cb2-297"><a href="#cb2-297" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnai3"</span>,</span>
<span id="cb2-298"><a href="#cb2-298" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnao1"</span>,</span>
<span id="cb2-299"><a href="#cb2-299" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnao2"</span>,</span>
<span id="cb2-300"><a href="#cb2-300" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnaq"</span>,</span>
<span id="cb2-301"><a href="#cb2-301" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gna11"</span>,</span>
<span id="cb2-302"><a href="#cb2-302" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gna12"</span>,</span>
<span id="cb2-303"><a href="#cb2-303" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gna13"</span>,</span>
<span id="cb2-304"><a href="#cb2-304" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnal"</span>,</span>
<span id="cb2-305"><a href="#cb2-305" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnasxl"</span>,  <span class="co"># G protein alpha subunit</span></span>
<span id="cb2-306"><a href="#cb2-306" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnb1"</span>,</span>
<span id="cb2-307"><a href="#cb2-307" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnb2"</span>,</span>
<span id="cb2-308"><a href="#cb2-308" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnb3"</span>,</span>
<span id="cb2-309"><a href="#cb2-309" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnb4"</span>,</span>
<span id="cb2-310"><a href="#cb2-310" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnb5"</span>,  <span class="co"># G protein beta subunit</span></span>
<span id="cb2-311"><a href="#cb2-311" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gng2"</span>,</span>
<span id="cb2-312"><a href="#cb2-312" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gng3"</span>,</span>
<span id="cb2-313"><a href="#cb2-313" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gng4"</span>,</span>
<span id="cb2-314"><a href="#cb2-314" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gng5"</span>,</span>
<span id="cb2-315"><a href="#cb2-315" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gng7"</span>,</span>
<span id="cb2-316"><a href="#cb2-316" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gng8"</span>,</span>
<span id="cb2-317"><a href="#cb2-317" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gng10"</span>,</span>
<span id="cb2-318"><a href="#cb2-318" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gng11"</span>,</span>
<span id="cb2-319"><a href="#cb2-319" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gng12"</span>,</span>
<span id="cb2-320"><a href="#cb2-320" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gng13"</span>,</span>
<span id="cb2-321"><a href="#cb2-321" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gngt1"</span>,</span>
<span id="cb2-322"><a href="#cb2-322" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gngt2"</span>,  <span class="co"># G protein gamma subunit</span></span>
<span id="cb2-323"><a href="#cb2-323" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2rx1"</span>,</span>
<span id="cb2-324"><a href="#cb2-324" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2rx2"</span>,</span>
<span id="cb2-325"><a href="#cb2-325" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2rx3"</span>,</span>
<span id="cb2-326"><a href="#cb2-326" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2rx4"</span>,</span>
<span id="cb2-327"><a href="#cb2-327" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2rx5"</span>,</span>
<span id="cb2-328"><a href="#cb2-328" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2rx6"</span>,</span>
<span id="cb2-329"><a href="#cb2-329" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2rx7"</span>,</span>
<span id="cb2-330"><a href="#cb2-330" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2ry1"</span>,</span>
<span id="cb2-331"><a href="#cb2-331" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2ry2"</span>,</span>
<span id="cb2-332"><a href="#cb2-332" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2ry4"</span>,</span>
<span id="cb2-333"><a href="#cb2-333" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2ry6"</span>,</span>
<span id="cb2-334"><a href="#cb2-334" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2ry12"</span>,</span>
<span id="cb2-335"><a href="#cb2-335" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2ry13"</span>,</span>
<span id="cb2-336"><a href="#cb2-336" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2ry14"</span>,  <span class="co"># purinergic receptors</span></span>
<span id="cb2-337"><a href="#cb2-337" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ryr1"</span>,</span>
<span id="cb2-338"><a href="#cb2-338" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ryr2"</span>,</span>
<span id="cb2-339"><a href="#cb2-339" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ryr3"</span>,  <span class="co"># ryanodine receptors</span></span>
<span id="cb2-340"><a href="#cb2-340" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="parameters" class="level3">
<h3 class="anchored" data-anchor-id="parameters">parameters</h3>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>bioproject <span class="op">=</span> <span class="st">"PRJNA679294"</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Distance Metric to Use</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># metric = snakemake.params["metric"]</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>metric <span class="op">=</span> <span class="st">"euclidean"</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># connectivity_model = snakemake.params["connectivity_model"]</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>connectivity_model <span class="op">=</span> <span class="st">"min_tree"</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>PLOTS_DIR <span class="op">=</span> os.path.join(<span class="st">"../output/figures/velocity-signalling/"</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>os.makedirs(PLOTS_DIR, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>OUT_DIR <span class="op">=</span> os.path.join(<span class="st">"../data/velocity-signalling/"</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>os.makedirs(OUT_DIR, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting params</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>pt_size <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>dnsty <span class="op">=</span> <span class="fl">0.8</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>plt_size <span class="op">=</span> [<span class="dv">5</span>, <span class="dv">5</span>]</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>SMALL_SIZE <span class="op">=</span> <span class="dv">7</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>MEDIUM_SIZE <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>BIGGER_SIZE <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>plt.rc(<span class="st">"font"</span>, size<span class="op">=</span>SMALL_SIZE)  <span class="co"># controls default text sizes</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>plt.rc(<span class="st">"axes"</span>, titlesize<span class="op">=</span>SMALL_SIZE)  <span class="co"># fontsize of the axes title</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>plt.rc(<span class="st">"axes"</span>, labelsize<span class="op">=</span>MEDIUM_SIZE)  <span class="co"># fontsize of the x and y labels</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>plt.rc(<span class="st">"xtick"</span>, labelsize<span class="op">=</span>SMALL_SIZE)  <span class="co"># fontsize of the tick labels</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>plt.rc(<span class="st">"ytick"</span>, labelsize<span class="op">=</span>SMALL_SIZE)  <span class="co"># fontsize of the tick labels</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>plt.rc(<span class="st">"legend"</span>, fontsize<span class="op">=</span>SMALL_SIZE)  <span class="co"># legend fontsize</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>plt.rc(<span class="st">"figure"</span>, titlesize<span class="op">=</span>BIGGER_SIZE)  <span class="co"># fontsize of the figure title</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>matplotlib.rcParams[<span class="st">"font.size"</span>] <span class="op">=</span> <span class="dv">11</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>matplotlib.rcParams[<span class="st">"pdf.use14corefonts"</span>] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>matplotlib.rcParams[<span class="st">"pdf.fonttype"</span>] <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>matplotlib.rcParams[<span class="st">"ps.fonttype"</span>] <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>matplotlib.rcParams[<span class="st">"font.family"</span>] <span class="op">=</span> <span class="st">"sans-serif"</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>matplotlib.rcParams[<span class="st">"font.sans-serif"</span>] <span class="op">=</span> [<span class="st">"Helvetica"</span>]</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>matplotlib.rcParams[<span class="st">"figure.max_open_warning"</span>] <span class="op">=</span> <span class="dv">20000</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>reseed <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>random.seed(reseed)</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>np.random.seed(reseed)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>random_state <span class="op">=</span> check_random_state(reseed)</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>verbose <span class="op">=</span> <span class="va">True</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>sc.settings.verbosity <span class="op">=</span> <span class="dv">2</span>  <span class="co"># verbosity: errors (0), warnings (1), info (2), hints (3)</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>scv.settings.set_figure_params(<span class="st">"scvelo"</span>)</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>sc.settings.figdir <span class="op">=</span> PLOTS_DIR</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>sc.settings.writedir <span class="op">=</span> OUT_DIR</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>sc.settings.set_figure_params(</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>    dpi<span class="op">=</span><span class="dv">120</span>,</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>    dpi_save<span class="op">=</span><span class="dv">600</span>,</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>    vector_friendly<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>    <span class="bu">format</span><span class="op">=</span><span class="st">"pdf"</span>,</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>    transparent<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>    color_map<span class="op">=</span><span class="st">"gnuplot_r"</span>,</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>sc.settings.autoshow <span class="op">=</span> <span class="va">False</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>sc.settings.autosave <span class="op">=</span> <span class="va">True</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a><span class="co"># k = int(snakemake.params["k"])</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>ks <span class="op">=</span> k <span class="op">+</span> <span class="dv">10</span></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>npcs <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>npcs_selected <span class="op">=</span> npcs <span class="op">-</span> <span class="dv">20</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>min_shared_umis <span class="op">=</span> <span class="dv">15</span></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>n_top_hvg <span class="op">=</span> <span class="dv">3000</span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>cb_fpr <span class="op">=</span> <span class="fl">0.001</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>paga_threshold <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>spread <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>threads <span class="op">=</span> <span class="dv">80</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>svm_fit_strength <span class="op">=</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="load-data" class="level3">
<h3 class="anchored" data-anchor-id="load-data">Load data</h3>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>housekeeping <span class="op">=</span> <span class="ss">f"/data/data/housekeeping_mouse.tsv"</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>hk_genes1 <span class="op">=</span> []</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(housekeeping) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> hk_genes :<span class="op">=</span> <span class="bu">file</span>.readline():</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>        hk_genes1.append(hk_genes.rstrip())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>adata <span class="op">=</span> sc.read_h5ad(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"../data/class_cello/PRJNA679294-astrocytes_dataset-</span><span class="sc">{</span>cb_fpr<span class="sc">}</span><span class="ss">-initial_selection.h5ad"</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>adata.obs[<span class="st">"cell_id"</span>] <span class="op">=</span> adata.obs_names</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>alldata <span class="op">=</span> sc.read_h5ad(</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"../data/class_cello/PRJNA679294-whole_dataset-</span><span class="sc">{</span>cb_fpr<span class="sc">}</span><span class="ss">-cello_annotation.h5ad"</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>alldata <span class="op">=</span> alldata[alldata.obs[<span class="st">"ora_celltype"</span>].isin([<span class="st">"Astrocytes"</span>, <span class="st">"Neurons"</span>])]</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>adata_norm <span class="op">=</span> alldata[alldata.obs[<span class="st">"condit"</span>] <span class="op">==</span> <span class="dv">0</span>]</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>adata_chronic_stress <span class="op">=</span> alldata[alldata.obs[<span class="st">"condit"</span>] <span class="op">==</span> <span class="dv">1</span>]</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># import data from the diet arc study of Deng et al., 2020</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>adata_arc_neurons_norm <span class="op">=</span> sc.read_h5ad(</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"../../PRJNA604055/data/velocity-signalling/PRJNA604055-signalling-norm.h5ad"</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>adata_arc_neurons_hfhsdiet <span class="op">=</span> sc.read_h5ad(</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"../../PRJNA604055/data/velocity-signalling/PRJNA604055-signalling-treatment.h5ad"</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="signalling-analysis" class="level3">
<h3 class="anchored" data-anchor-id="signalling-analysis">Signalling analysis</h3>
<section id="normal-conditions" class="level4">
<h4 class="anchored" data-anchor-id="normal-conditions">Normal conditions</h4>
<div class="cell" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>adata_norm.obs[<span class="st">"k_tree"</span>] <span class="op">=</span> adata_norm.obs[<span class="st">"k_tree"</span>].astype(<span class="st">"category"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>adata_norm.raw.X</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>&lt;3069x22835 sparse matrix of type '&lt;class 'numpy.float32'&gt;'
    with 8854861 stored elements in Compressed Sparse Column format&gt;</code></pre>
</div>
</div>
<p>subset groups of interest</p>
<div class="cell" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>sc.pl.umap(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    adata_norm,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>[<span class="st">"k_tree"</span>],</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span>pt_size,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    legend_loc<span class="op">=</span><span class="st">"on data"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-8-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>sc.pl.umap(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    adata_norm,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>[</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Rbfox3"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Adcyap1r1"</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Otp"</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alk"</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Npy1r"</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Npy2r"</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Gfap"</span>,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Lxn"</span>,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Slc1a3"</span>,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Htra1"</span>,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Mfn2"</span>,</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Fos"</span>,</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span>pt_size,</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-9-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>sc.pl.embedding(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    adata_norm,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    basis<span class="op">=</span><span class="st">"X_pacmap"</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>[</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Rbfox3"</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Adcyap1r1"</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Otp"</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alk"</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Npy1r"</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Npy2r"</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Gfap"</span>,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Lxn"</span>,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Slc1a3"</span>,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Htra1"</span>,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Mfn2"</span>,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Fos"</span>,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    add_outline<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    legend_fontsize<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    legend_fontoutline<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    frameon<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span><span class="st">"nipy_spectral"</span>,</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="st">"-pacmap-int-normal-conditions.pdf"</span>,</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING: saving figure to file ../output/figures/velocity-signalling/X_pacmap-pacmap-int-normal-conditions.pdf</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-10-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="10">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>sc.pl.embedding(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    adata_norm,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    basis<span class="op">=</span><span class="st">"X_pacmap"</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>[g <span class="cf">for</span> g <span class="kw">in</span> genes_embed <span class="cf">if</span> g <span class="kw">in</span> adata_norm.var_names],</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    add_outline<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    legend_fontsize<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    legend_fontoutline<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    frameon<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span><span class="st">"nipy_spectral"</span>,</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="st">"-pacmap-adgene-normal-conditions.pdf"</span>,</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING: saving figure to file ../output/figures/velocity-signalling/X_pacmap-pacmap-adgene-normal-conditions.pdf</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-11-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="11">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> matplotlib.rc_context({<span class="st">"figure.figsize"</span>: (<span class="fl">5.5</span>, <span class="dv">4</span>)}):</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    sc.pl.violin(</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>        adata_norm,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>        [<span class="st">"Pomc"</span>, <span class="st">"Agrp"</span>, <span class="st">"Npy"</span>, <span class="st">"Lxn"</span>, <span class="st">"Gfap"</span>, <span class="st">"Fos"</span>],</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>        groupby<span class="op">=</span><span class="st">"k_tree"</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>        stripplot<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>        frameon<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>        palette<span class="op">=</span><span class="st">"nipy_spectral"</span>,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>        show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>        save<span class="op">=</span><span class="st">"-violin-adgene-normal-conditions.pdf"</span>,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING: saving figure to file ../output/figures/velocity-signalling/violin-violin-adgene-normal-conditions.pdf</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-12-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="12">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>lxn_pos_astro <span class="op">=</span> adata_norm[</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    (adata_norm[:, <span class="st">"Lxn"</span>].to_df() <span class="op">&gt;</span> <span class="dv">1</span>).stack().values</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (adata_norm.obs_names.isin(adata.obs_names)),</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    :,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>lxn_neg_astro <span class="op">=</span> adata_norm[</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    (adata_norm[:, <span class="st">"Lxn"</span>].to_df() <span class="op">==</span> <span class="dv">0</span>).stack().values</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (adata_norm.obs_names.isin(adata.obs_names)),</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    :,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="13">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>adata_norm.obs[<span class="st">"goi"</span>] <span class="op">=</span> adata_norm.obs[<span class="st">"k_tree"</span>]</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>adata_norm.obs[<span class="st">"goi"</span>] <span class="op">=</span> adata_norm.obs[<span class="st">"goi"</span>].cat.add_categories(<span class="st">"Astro_LXN+"</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>adata_norm.obs.loc[</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> df: df.index.isin(lxn_pos_astro.obs.index), <span class="st">"goi"</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>] <span class="op">=</span> <span class="st">"Astro_LXN+"</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>adata_norm.obs[<span class="st">"goi"</span>] <span class="op">=</span> adata_norm.obs[<span class="st">"goi"</span>].cat.add_categories(<span class="st">"Astro_LXN-"</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>adata_norm.obs.loc[</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> df: df.index.isin(lxn_neg_astro.obs.index), <span class="st">"goi"</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>] <span class="op">=</span> <span class="st">"Astro_LXN-"</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>adata_norm <span class="op">=</span> adata_norm[adata_norm.obs[<span class="st">"goi"</span>].isin([<span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>])]</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>adata_norm.obs[<span class="st">"goi"</span>].cat.remove_unused_categories(inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="14">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>sc.pl.embedding(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    adata_norm,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    basis<span class="op">=</span><span class="st">"X_pacmap"</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>[</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Rbfox3"</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Adcyap1r1"</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Otp"</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alk"</span>,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Npy1r"</span>,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Npy2r"</span>,</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Gfap"</span>,</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Lxn"</span>,</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Slc1a3"</span>,</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Htra1"</span>,</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Mfn2"</span>,</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Fos"</span>,</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    add_outline<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    legend_fontsize<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    legend_fontoutline<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    frameon<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span><span class="st">"nipy_spectral"</span>,</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="st">"-pacmap-subset-int-normal-conditions.pdf"</span>,</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING: saving figure to file ../output/figures/velocity-signalling/X_pacmap-pacmap-subset-int-normal-conditions.pdf</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-15-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="15">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>sc.pl.embedding(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    adata_norm,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    basis<span class="op">=</span><span class="st">"X_pacmap"</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>[<span class="st">"goi"</span>],</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    add_outline<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    legend_fontsize<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    legend_fontoutline<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    frameon<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span><span class="st">"nipy_spectral"</span>,</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="st">"-pacmap-subset-goi-normal-conditions.pdf"</span>,</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING: saving figure to file ../output/figures/velocity-signalling/X_pacmap-pacmap-subset-goi-normal-conditions.pdf</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-16-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="16">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>sc.pl.embedding(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    adata_norm,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    basis<span class="op">=</span><span class="st">"X_pacmap"</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>[g <span class="cf">for</span> g <span class="kw">in</span> genes_embed <span class="cf">if</span> g <span class="kw">in</span> adata_norm.var_names],</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    add_outline<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    legend_fontsize<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    legend_fontoutline<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    frameon<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span><span class="st">"nipy_spectral"</span>,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="st">"-pacmap-subset-adgene-normal-conditions.pdf"</span>,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING: saving figure to file ../output/figures/velocity-signalling/X_pacmap-pacmap-subset-adgene-normal-conditions.pdf</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-17-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="17">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>sc.pp.normalize_total(adata_norm, target_sum<span class="op">=</span><span class="fl">1e4</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>sc.pp.log1p(adata_norm)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate the processed POMC and AGRP/NPY neurons!!!</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>adata_norm <span class="op">=</span> ad.concat([adata_norm, adata_arc_neurons_norm], join<span class="op">=</span><span class="st">"inner"</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>adata_norm.raw <span class="op">=</span> adata_norm</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>adata_norm.obs[<span class="st">"goi"</span>] <span class="op">=</span> pd.Categorical(adata_norm.obs[<span class="st">"goi"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>normalizing counts per cell</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>    finished (0:00:00)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="18">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>li.mt.rank_aggregate(</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    adata_norm,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    groupby<span class="op">=</span><span class="st">"goi"</span>,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    de_method<span class="op">=</span><span class="st">"logreg"</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    expr_prop<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    min_cells<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    return_all_lrs<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    verbose<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    resource_name<span class="op">=</span><span class="st">"mouseconsensus"</span>,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    n_perms<span class="op">=</span><span class="dv">100000</span>,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    seed<span class="op">=</span>reseed,</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>... as `zero_center=True`, sparse input is densified and may lead to large memory consumption</code></pre>
</div>
</div>
<div class="cell" data-execution_count="19">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>adata_norm.uns[<span class="st">"liana_res"</span>].to_csv(<span class="st">"pvn_astro-with_npy_pomc-liana-res.csv"</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>adata_norm.uns[<span class="st">"liana_res"</span>].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="19">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>source</th>
      <th>target</th>
      <th>ligand_complex</th>
      <th>receptor_complex</th>
      <th>lr_means</th>
      <th>cellphone_pvals</th>
      <th>expr_prod</th>
      <th>scaled_weight</th>
      <th>lr_logfc</th>
      <th>spec_weight</th>
      <th>lrscore</th>
      <th>lr_probs</th>
      <th>cellchat_pvals</th>
      <th>steady_rank</th>
      <th>specificity_rank</th>
      <th>magnitude_rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>9364</th>
      <td>POMC neurons</td>
      <td>AGRP/NPY neurons</td>
      <td>Pomc</td>
      <td>Grm7</td>
      <td>3.742099</td>
      <td>0.00000</td>
      <td>12.574071</td>
      <td>4.523711</td>
      <td>6.069233</td>
      <td>0.486075</td>
      <td>0.965925</td>
      <td>0.307583</td>
      <td>0.00000</td>
      <td>1.009167e-11</td>
      <td>9.597286e-08</td>
      <td>1.010149e-12</td>
    </tr>
    <tr>
      <th>24680</th>
      <td>AGRP/NPY neurons</td>
      <td>Astro_LXN-</td>
      <td>Nlgn1</td>
      <td>Nrxn1</td>
      <td>3.474475</td>
      <td>0.00001</td>
      <td>11.948523</td>
      <td>0.318851</td>
      <td>0.403650</td>
      <td>0.076387</td>
      <td>0.965076</td>
      <td>0.286593</td>
      <td>0.00004</td>
      <td>2.300746e-03</td>
      <td>1.691048e-02</td>
      <td>1.578287e-11</td>
    </tr>
    <tr>
      <th>7487</th>
      <td>Astro_LXN-</td>
      <td>AGRP/NPY neurons</td>
      <td>Nrxn1</td>
      <td>Nlgn1</td>
      <td>3.474475</td>
      <td>0.00001</td>
      <td>11.948523</td>
      <td>0.318851</td>
      <td>0.403650</td>
      <td>0.076387</td>
      <td>0.965076</td>
      <td>0.286593</td>
      <td>0.00004</td>
      <td>2.300746e-03</td>
      <td>1.691048e-02</td>
      <td>1.578287e-11</td>
    </tr>
    <tr>
      <th>13268</th>
      <td>AGRP/NPY neurons</td>
      <td>Astro_LXN+</td>
      <td>Nlgn1</td>
      <td>Nrxn1</td>
      <td>3.440420</td>
      <td>0.00015</td>
      <td>11.735804</td>
      <td>0.272652</td>
      <td>0.196399</td>
      <td>0.075027</td>
      <td>0.964772</td>
      <td>0.277596</td>
      <td>0.00274</td>
      <td>4.140813e-03</td>
      <td>1.837520e-02</td>
      <td>9.204017e-11</td>
    </tr>
    <tr>
      <th>4634</th>
      <td>Astro_LXN+</td>
      <td>AGRP/NPY neurons</td>
      <td>Nrxn1</td>
      <td>Nlgn1</td>
      <td>3.440420</td>
      <td>0.00015</td>
      <td>11.735804</td>
      <td>0.272652</td>
      <td>0.196399</td>
      <td>0.075027</td>
      <td>0.964772</td>
      <td>0.277596</td>
      <td>0.00274</td>
      <td>4.140813e-03</td>
      <td>1.837520e-02</td>
      <td>9.204017e-11</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="20">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>n2a_norm <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_norm,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>],</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"lr_logfc"</span>,</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    n2a_norm</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>n2a_norm.save(filename<span class="op">=</span><span class="st">"liana-dotplot-logfc-normal-conditions-n2a.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family ['Dejavu Sans'] not found. Falling back to Helvetica.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family ['Dejavu Sans'] not found. Falling back to Helvetica.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family ['Dejavu Sans'] not found. Falling back to Helvetica.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family ['Dejavu Sans'] not found. Falling back to Helvetica.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family ['Dejavu Sans'] not found. Falling back to Helvetica.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family ['Dejavu Sans'] not found. Falling back to Helvetica.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="21">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>n2a_norm <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_norm,</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>],</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>    filterby<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>    filter_lambda<span class="op">=</span><span class="kw">lambda</span> x: x <span class="op">&lt;=</span> <span class="fl">0.01</span>,</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>    n2a_norm</span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a>n2a_norm.save(filename<span class="op">=</span><span class="st">"liana-dotplot-specificity_rank-normal-conditions-n2a.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="22">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>n2a_norm <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_norm,</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>],</span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>    filterby<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a>    filter_lambda<span class="op">=</span><span class="kw">lambda</span> x: x <span class="op">&lt;=</span> <span class="fl">0.01</span>,</span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb120-18"><a href="#cb120-18" aria-hidden="true" tabindex="-1"></a>    n2a_norm</span>
<span id="cb120-19"><a href="#cb120-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb120-20"><a href="#cb120-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb120-21"><a href="#cb120-21" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb120-22"><a href="#cb120-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb120-23"><a href="#cb120-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb120-24"><a href="#cb120-24" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb120-25"><a href="#cb120-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb120-26"><a href="#cb120-26" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb120-27"><a href="#cb120-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb120-28"><a href="#cb120-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb120-29"><a href="#cb120-29" aria-hidden="true" tabindex="-1"></a>n2a_norm.save(filename<span class="op">=</span><span class="st">"liana-dotplot-magnitude_rank-normal-conditions-n2a.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="23">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, filter the DataFrame</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>filtered_df <span class="op">=</span> adata_norm.uns[<span class="st">'liana_res'</span>][adata_norm.uns[<span class="st">'liana_res'</span>][<span class="st">'receptor_complex'</span>] <span class="op">==</span> <span class="st">'Insr'</span>]</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Then, pass the filtered DataFrame to the dotplot function</span></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>n2a_norm <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>    liana_res<span class="op">=</span>filtered_df,</span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb162-11"><a href="#cb162-11" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb162-12"><a href="#cb162-12" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>],</span>
<span id="cb162-13"><a href="#cb162-13" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb162-14"><a href="#cb162-14" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"lr_logfc"</span>,</span>
<span id="cb162-15"><a href="#cb162-15" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb162-16"><a href="#cb162-16" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb162-17"><a href="#cb162-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb162-18"><a href="#cb162-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-19"><a href="#cb162-19" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb162-20"><a href="#cb162-20" aria-hidden="true" tabindex="-1"></a>    n2a_norm</span>
<span id="cb162-21"><a href="#cb162-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb162-22"><a href="#cb162-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb162-23"><a href="#cb162-23" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb162-24"><a href="#cb162-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb162-25"><a href="#cb162-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb162-26"><a href="#cb162-26" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb162-27"><a href="#cb162-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb162-28"><a href="#cb162-28" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb162-29"><a href="#cb162-29" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb162-30"><a href="#cb162-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb162-31"><a href="#cb162-31" aria-hidden="true" tabindex="-1"></a>n2a_norm.save(filename<span class="op">=</span><span class="st">"liana-dotplot-insr-logfc-normal-conditions-n2a.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="24">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>n2a_norm <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>    liana_res<span class="op">=</span>filtered_df,</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>],</span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a>    filterby<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb191-10"><a href="#cb191-10" aria-hidden="true" tabindex="-1"></a>    filter_lambda<span class="op">=</span><span class="kw">lambda</span> x: x <span class="op">&lt;=</span> <span class="fl">0.01</span>,</span>
<span id="cb191-11"><a href="#cb191-11" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb191-12"><a href="#cb191-12" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb191-13"><a href="#cb191-13" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb191-14"><a href="#cb191-14" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb191-15"><a href="#cb191-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb191-16"><a href="#cb191-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-17"><a href="#cb191-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb191-18"><a href="#cb191-18" aria-hidden="true" tabindex="-1"></a>    n2a_norm</span>
<span id="cb191-19"><a href="#cb191-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb191-20"><a href="#cb191-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb191-21"><a href="#cb191-21" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb191-22"><a href="#cb191-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb191-23"><a href="#cb191-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb191-24"><a href="#cb191-24" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb191-25"><a href="#cb191-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb191-26"><a href="#cb191-26" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb191-27"><a href="#cb191-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb191-28"><a href="#cb191-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb191-29"><a href="#cb191-29" aria-hidden="true" tabindex="-1"></a>n2a_norm.save(filename<span class="op">=</span><span class="st">"liana-dotplot-insr-specificity_rank-normal-conditions-n2a.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="25">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>n2a_norm <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>    liana_res<span class="op">=</span>filtered_df,</span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb214-5"><a href="#cb214-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb214-6"><a href="#cb214-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb214-7"><a href="#cb214-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb214-8"><a href="#cb214-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>],</span>
<span id="cb214-9"><a href="#cb214-9" aria-hidden="true" tabindex="-1"></a>    filterby<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb214-10"><a href="#cb214-10" aria-hidden="true" tabindex="-1"></a>    filter_lambda<span class="op">=</span><span class="kw">lambda</span> x: x <span class="op">&lt;=</span> <span class="fl">0.01</span>,</span>
<span id="cb214-11"><a href="#cb214-11" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb214-12"><a href="#cb214-12" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb214-13"><a href="#cb214-13" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb214-14"><a href="#cb214-14" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb214-15"><a href="#cb214-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb214-16"><a href="#cb214-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-17"><a href="#cb214-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb214-18"><a href="#cb214-18" aria-hidden="true" tabindex="-1"></a>    n2a_norm</span>
<span id="cb214-19"><a href="#cb214-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb214-20"><a href="#cb214-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb214-21"><a href="#cb214-21" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb214-22"><a href="#cb214-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb214-23"><a href="#cb214-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb214-24"><a href="#cb214-24" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb214-25"><a href="#cb214-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb214-26"><a href="#cb214-26" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb214-27"><a href="#cb214-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb214-28"><a href="#cb214-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb214-29"><a href="#cb214-29" aria-hidden="true" tabindex="-1"></a>n2a_norm.save(filename<span class="op">=</span><span class="st">"liana-dotplot-insr-magnitude_rank-normal-conditions-n2a.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="26">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a>a2n_norm <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_norm,</span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb237-6"><a href="#cb237-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb237-7"><a href="#cb237-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>],</span>
<span id="cb237-8"><a href="#cb237-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb237-9"><a href="#cb237-9" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb237-10"><a href="#cb237-10" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"lr_logfc"</span>,</span>
<span id="cb237-11"><a href="#cb237-11" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb237-12"><a href="#cb237-12" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb237-13"><a href="#cb237-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb237-14"><a href="#cb237-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-15"><a href="#cb237-15" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb237-16"><a href="#cb237-16" aria-hidden="true" tabindex="-1"></a>    a2n_norm</span>
<span id="cb237-17"><a href="#cb237-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb237-18"><a href="#cb237-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb237-19"><a href="#cb237-19" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb237-20"><a href="#cb237-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb237-21"><a href="#cb237-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb237-22"><a href="#cb237-22" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb237-23"><a href="#cb237-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb237-24"><a href="#cb237-24" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb237-25"><a href="#cb237-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb237-26"><a href="#cb237-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb237-27"><a href="#cb237-27" aria-hidden="true" tabindex="-1"></a>a2n_norm.save(filename<span class="op">=</span><span class="st">"liana-dotplot-logfc-normal-conditions-a2n.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="27">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a>a2n_norm <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_norm,</span>
<span id="cb277-3"><a href="#cb277-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb277-4"><a href="#cb277-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb277-5"><a href="#cb277-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb277-6"><a href="#cb277-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb277-7"><a href="#cb277-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>],</span>
<span id="cb277-8"><a href="#cb277-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb277-9"><a href="#cb277-9" aria-hidden="true" tabindex="-1"></a>    filterby<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb277-10"><a href="#cb277-10" aria-hidden="true" tabindex="-1"></a>    filter_lambda<span class="op">=</span><span class="kw">lambda</span> x: x <span class="op">&lt;=</span> <span class="fl">0.01</span>,</span>
<span id="cb277-11"><a href="#cb277-11" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb277-12"><a href="#cb277-12" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb277-13"><a href="#cb277-13" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb277-14"><a href="#cb277-14" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb277-15"><a href="#cb277-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb277-16"><a href="#cb277-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-17"><a href="#cb277-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb277-18"><a href="#cb277-18" aria-hidden="true" tabindex="-1"></a>    a2n_norm</span>
<span id="cb277-19"><a href="#cb277-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb277-20"><a href="#cb277-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb277-21"><a href="#cb277-21" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb277-22"><a href="#cb277-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb277-23"><a href="#cb277-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb277-24"><a href="#cb277-24" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb277-25"><a href="#cb277-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb277-26"><a href="#cb277-26" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb277-27"><a href="#cb277-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb277-28"><a href="#cb277-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb277-29"><a href="#cb277-29" aria-hidden="true" tabindex="-1"></a>a2n_norm.save(filename<span class="op">=</span><span class="st">"liana-dotplot-specificity_rank-normal-conditions-a2n.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="28">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb319"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a>a2n_norm <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb319-2"><a href="#cb319-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_norm,</span>
<span id="cb319-3"><a href="#cb319-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb319-4"><a href="#cb319-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb319-5"><a href="#cb319-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb319-6"><a href="#cb319-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb319-7"><a href="#cb319-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>],</span>
<span id="cb319-8"><a href="#cb319-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb319-9"><a href="#cb319-9" aria-hidden="true" tabindex="-1"></a>    filterby<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb319-10"><a href="#cb319-10" aria-hidden="true" tabindex="-1"></a>    filter_lambda<span class="op">=</span><span class="kw">lambda</span> x: x <span class="op">&lt;=</span> <span class="fl">0.01</span>,</span>
<span id="cb319-11"><a href="#cb319-11" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb319-12"><a href="#cb319-12" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb319-13"><a href="#cb319-13" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb319-14"><a href="#cb319-14" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb319-15"><a href="#cb319-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb319-16"><a href="#cb319-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb319-17"><a href="#cb319-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb319-18"><a href="#cb319-18" aria-hidden="true" tabindex="-1"></a>    a2n_norm</span>
<span id="cb319-19"><a href="#cb319-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb319-20"><a href="#cb319-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb319-21"><a href="#cb319-21" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb319-22"><a href="#cb319-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb319-23"><a href="#cb319-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb319-24"><a href="#cb319-24" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb319-25"><a href="#cb319-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb319-26"><a href="#cb319-26" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb319-27"><a href="#cb319-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb319-28"><a href="#cb319-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb319-29"><a href="#cb319-29" aria-hidden="true" tabindex="-1"></a>a2n_norm.save(filename<span class="op">=</span><span class="st">"liana-dotplot-magnitude_rank-normal-conditions-a2n.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<p>Save data</p>
<div class="cell" data-execution_count="29">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb363"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a>adata_norm.write(</span>
<span id="cb363-2"><a href="#cb363-2" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"/data/</span><span class="sc">{</span>bioproject<span class="sc">}</span><span class="ss">/data/velocity-signalling/</span><span class="sc">{</span>bioproject<span class="sc">}</span><span class="ss">-signalling-norm.h5ad"</span></span>
<span id="cb363-3"><a href="#cb363-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="chronic-stress-model" class="level4">
<h4 class="anchored" data-anchor-id="chronic-stress-model">Chronic Stress Model</h4>
<div class="cell" data-execution_count="30">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb364"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a>adata_chronic_stress.obs[<span class="st">"k_tree"</span>] <span class="op">=</span> adata_chronic_stress.obs[<span class="st">"k_tree"</span>].astype(</span>
<span id="cb364-2"><a href="#cb364-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"category"</span></span>
<span id="cb364-3"><a href="#cb364-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb364-4"><a href="#cb364-4" aria-hidden="true" tabindex="-1"></a>adata_chronic_stress.raw.X</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>&lt;3078x22835 sparse matrix of type '&lt;class 'numpy.float32'&gt;'
    with 9267589 stored elements in Compressed Sparse Column format&gt;</code></pre>
</div>
</div>
<p>subset groups of interest</p>
<div class="cell" data-execution_count="31">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb366"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a>sc.pl.umap(</span>
<span id="cb366-2"><a href="#cb366-2" aria-hidden="true" tabindex="-1"></a>    adata_chronic_stress,</span>
<span id="cb366-3"><a href="#cb366-3" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>[<span class="st">"k_tree"</span>],</span>
<span id="cb366-4"><a href="#cb366-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span>pt_size,</span>
<span id="cb366-5"><a href="#cb366-5" aria-hidden="true" tabindex="-1"></a>    legend_loc<span class="op">=</span><span class="st">"on data"</span>,</span>
<span id="cb366-6"><a href="#cb366-6" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb366-7"><a href="#cb366-7" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb366-8"><a href="#cb366-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-32-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="32">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb367"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a>sc.pl.umap(</span>
<span id="cb367-2"><a href="#cb367-2" aria-hidden="true" tabindex="-1"></a>    adata_chronic_stress,</span>
<span id="cb367-3"><a href="#cb367-3" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>[</span>
<span id="cb367-4"><a href="#cb367-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Rbfox3"</span>,</span>
<span id="cb367-5"><a href="#cb367-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Adcyap1r1"</span>,</span>
<span id="cb367-6"><a href="#cb367-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Otp"</span>,</span>
<span id="cb367-7"><a href="#cb367-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alk"</span>,</span>
<span id="cb367-8"><a href="#cb367-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Npy1r"</span>,</span>
<span id="cb367-9"><a href="#cb367-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Npy2r"</span>,</span>
<span id="cb367-10"><a href="#cb367-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Gfap"</span>,</span>
<span id="cb367-11"><a href="#cb367-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Lxn"</span>,</span>
<span id="cb367-12"><a href="#cb367-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Slc1a3"</span>,</span>
<span id="cb367-13"><a href="#cb367-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Htra1"</span>,</span>
<span id="cb367-14"><a href="#cb367-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Mfn2"</span>,</span>
<span id="cb367-15"><a href="#cb367-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Fos"</span>,</span>
<span id="cb367-16"><a href="#cb367-16" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb367-17"><a href="#cb367-17" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb367-18"><a href="#cb367-18" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span>pt_size,</span>
<span id="cb367-19"><a href="#cb367-19" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb367-20"><a href="#cb367-20" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb367-21"><a href="#cb367-21" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-33-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="33">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb368"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a>sc.pl.embedding(</span>
<span id="cb368-2"><a href="#cb368-2" aria-hidden="true" tabindex="-1"></a>    adata_chronic_stress,</span>
<span id="cb368-3"><a href="#cb368-3" aria-hidden="true" tabindex="-1"></a>    basis<span class="op">=</span><span class="st">"X_pacmap"</span>,</span>
<span id="cb368-4"><a href="#cb368-4" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>[</span>
<span id="cb368-5"><a href="#cb368-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Rbfox3"</span>,</span>
<span id="cb368-6"><a href="#cb368-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Adcyap1r1"</span>,</span>
<span id="cb368-7"><a href="#cb368-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Otp"</span>,</span>
<span id="cb368-8"><a href="#cb368-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alk"</span>,</span>
<span id="cb368-9"><a href="#cb368-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Npy1r"</span>,</span>
<span id="cb368-10"><a href="#cb368-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Npy2r"</span>,</span>
<span id="cb368-11"><a href="#cb368-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Gfap"</span>,</span>
<span id="cb368-12"><a href="#cb368-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Lxn"</span>,</span>
<span id="cb368-13"><a href="#cb368-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Slc1a3"</span>,</span>
<span id="cb368-14"><a href="#cb368-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Htra1"</span>,</span>
<span id="cb368-15"><a href="#cb368-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Mfn2"</span>,</span>
<span id="cb368-16"><a href="#cb368-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Fos"</span>,</span>
<span id="cb368-17"><a href="#cb368-17" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb368-18"><a href="#cb368-18" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb368-19"><a href="#cb368-19" aria-hidden="true" tabindex="-1"></a>    add_outline<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb368-20"><a href="#cb368-20" aria-hidden="true" tabindex="-1"></a>    legend_fontsize<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb368-21"><a href="#cb368-21" aria-hidden="true" tabindex="-1"></a>    legend_fontoutline<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb368-22"><a href="#cb368-22" aria-hidden="true" tabindex="-1"></a>    frameon<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb368-23"><a href="#cb368-23" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span><span class="st">"nipy_spectral"</span>,</span>
<span id="cb368-24"><a href="#cb368-24" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb368-25"><a href="#cb368-25" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="st">"-pacmap-int-chronic-stress.pdf"</span>,</span>
<span id="cb368-26"><a href="#cb368-26" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING: saving figure to file ../output/figures/velocity-signalling/X_pacmap-pacmap-int-chronic-stress.pdf</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-34-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="34">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb370"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a>sc.pl.embedding(</span>
<span id="cb370-2"><a href="#cb370-2" aria-hidden="true" tabindex="-1"></a>    adata_chronic_stress,</span>
<span id="cb370-3"><a href="#cb370-3" aria-hidden="true" tabindex="-1"></a>    basis<span class="op">=</span><span class="st">"X_pacmap"</span>,</span>
<span id="cb370-4"><a href="#cb370-4" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>[g <span class="cf">for</span> g <span class="kw">in</span> genes_embed <span class="cf">if</span> g <span class="kw">in</span> adata_chronic_stress.var_names],</span>
<span id="cb370-5"><a href="#cb370-5" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb370-6"><a href="#cb370-6" aria-hidden="true" tabindex="-1"></a>    add_outline<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb370-7"><a href="#cb370-7" aria-hidden="true" tabindex="-1"></a>    legend_fontsize<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb370-8"><a href="#cb370-8" aria-hidden="true" tabindex="-1"></a>    legend_fontoutline<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb370-9"><a href="#cb370-9" aria-hidden="true" tabindex="-1"></a>    frameon<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb370-10"><a href="#cb370-10" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span><span class="st">"nipy_spectral"</span>,</span>
<span id="cb370-11"><a href="#cb370-11" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb370-12"><a href="#cb370-12" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="st">"-pacmap-adgene-chronic-stress.pdf"</span>,</span>
<span id="cb370-13"><a href="#cb370-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING: saving figure to file ../output/figures/velocity-signalling/X_pacmap-pacmap-adgene-chronic-stress.pdf</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-35-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="35">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb372"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> matplotlib.rc_context({<span class="st">"figure.figsize"</span>: (<span class="fl">5.5</span>, <span class="dv">4</span>)}):</span>
<span id="cb372-2"><a href="#cb372-2" aria-hidden="true" tabindex="-1"></a>    sc.pl.violin(</span>
<span id="cb372-3"><a href="#cb372-3" aria-hidden="true" tabindex="-1"></a>        adata_chronic_stress,</span>
<span id="cb372-4"><a href="#cb372-4" aria-hidden="true" tabindex="-1"></a>        [<span class="st">"Pomc"</span>, <span class="st">"Agrp"</span>, <span class="st">"Npy"</span>, <span class="st">"Lxn"</span>, <span class="st">"Gfap"</span>, <span class="st">"Fos"</span>],</span>
<span id="cb372-5"><a href="#cb372-5" aria-hidden="true" tabindex="-1"></a>        groupby<span class="op">=</span><span class="st">"k_tree"</span>,</span>
<span id="cb372-6"><a href="#cb372-6" aria-hidden="true" tabindex="-1"></a>        stripplot<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb372-7"><a href="#cb372-7" aria-hidden="true" tabindex="-1"></a>        frameon<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb372-8"><a href="#cb372-8" aria-hidden="true" tabindex="-1"></a>        palette<span class="op">=</span><span class="st">"nipy_spectral"</span>,</span>
<span id="cb372-9"><a href="#cb372-9" aria-hidden="true" tabindex="-1"></a>        show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb372-10"><a href="#cb372-10" aria-hidden="true" tabindex="-1"></a>        save<span class="op">=</span><span class="st">"-violin-adgene-chronic-stress.pdf"</span>,</span>
<span id="cb372-11"><a href="#cb372-11" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING: saving figure to file ../output/figures/velocity-signalling/violin-violin-adgene-chronic-stress.pdf</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-36-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="36">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb374"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a>lxn_pos_astro <span class="op">=</span> adata_chronic_stress[</span>
<span id="cb374-2"><a href="#cb374-2" aria-hidden="true" tabindex="-1"></a>    (adata_chronic_stress[:, <span class="st">"Lxn"</span>].to_df() <span class="op">&gt;</span> <span class="dv">1</span>).stack().values</span>
<span id="cb374-3"><a href="#cb374-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (adata_chronic_stress.obs_names.isin(adata.obs_names)),</span>
<span id="cb374-4"><a href="#cb374-4" aria-hidden="true" tabindex="-1"></a>    :,</span>
<span id="cb374-5"><a href="#cb374-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb374-6"><a href="#cb374-6" aria-hidden="true" tabindex="-1"></a>lxn_neg_astro <span class="op">=</span> adata_chronic_stress[</span>
<span id="cb374-7"><a href="#cb374-7" aria-hidden="true" tabindex="-1"></a>    (adata_chronic_stress[:, <span class="st">"Lxn"</span>].to_df() <span class="op">==</span> <span class="dv">0</span>).stack().values</span>
<span id="cb374-8"><a href="#cb374-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (adata_chronic_stress.obs_names.isin(adata.obs_names)),</span>
<span id="cb374-9"><a href="#cb374-9" aria-hidden="true" tabindex="-1"></a>    :,</span>
<span id="cb374-10"><a href="#cb374-10" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="37">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb375"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a>adata_chronic_stress.obs[<span class="st">"goi"</span>] <span class="op">=</span> adata_chronic_stress.obs[<span class="st">"k_tree"</span>]</span>
<span id="cb375-2"><a href="#cb375-2" aria-hidden="true" tabindex="-1"></a>adata_chronic_stress.obs[<span class="st">"goi"</span>] <span class="op">=</span> adata_chronic_stress.obs[<span class="st">"goi"</span>].cat.add_categories(</span>
<span id="cb375-3"><a href="#cb375-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Astro_LXN+"</span></span>
<span id="cb375-4"><a href="#cb375-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-5"><a href="#cb375-5" aria-hidden="true" tabindex="-1"></a>adata_chronic_stress.obs.loc[</span>
<span id="cb375-6"><a href="#cb375-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> df: df.index.isin(lxn_pos_astro.obs.index), <span class="st">"goi"</span></span>
<span id="cb375-7"><a href="#cb375-7" aria-hidden="true" tabindex="-1"></a>] <span class="op">=</span> <span class="st">"Astro_LXN+"</span></span>
<span id="cb375-8"><a href="#cb375-8" aria-hidden="true" tabindex="-1"></a>adata_chronic_stress.obs[<span class="st">"goi"</span>] <span class="op">=</span> adata_chronic_stress.obs[<span class="st">"goi"</span>].cat.add_categories(</span>
<span id="cb375-9"><a href="#cb375-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Astro_LXN-"</span></span>
<span id="cb375-10"><a href="#cb375-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-11"><a href="#cb375-11" aria-hidden="true" tabindex="-1"></a>adata_chronic_stress.obs.loc[</span>
<span id="cb375-12"><a href="#cb375-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> df: df.index.isin(lxn_neg_astro.obs.index), <span class="st">"goi"</span></span>
<span id="cb375-13"><a href="#cb375-13" aria-hidden="true" tabindex="-1"></a>] <span class="op">=</span> <span class="st">"Astro_LXN-"</span></span>
<span id="cb375-14"><a href="#cb375-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-15"><a href="#cb375-15" aria-hidden="true" tabindex="-1"></a>adata_chronic_stress <span class="op">=</span> adata_chronic_stress[</span>
<span id="cb375-16"><a href="#cb375-16" aria-hidden="true" tabindex="-1"></a>    adata_chronic_stress.obs[<span class="st">"goi"</span>].isin([<span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>])</span>
<span id="cb375-17"><a href="#cb375-17" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb375-18"><a href="#cb375-18" aria-hidden="true" tabindex="-1"></a>adata_chronic_stress.obs[<span class="st">"goi"</span>].cat.remove_unused_categories(inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="38">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb376"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb376-1"><a href="#cb376-1" aria-hidden="true" tabindex="-1"></a>sc.pl.embedding(</span>
<span id="cb376-2"><a href="#cb376-2" aria-hidden="true" tabindex="-1"></a>    adata_chronic_stress,</span>
<span id="cb376-3"><a href="#cb376-3" aria-hidden="true" tabindex="-1"></a>    basis<span class="op">=</span><span class="st">"X_pacmap"</span>,</span>
<span id="cb376-4"><a href="#cb376-4" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>[</span>
<span id="cb376-5"><a href="#cb376-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Rbfox3"</span>,</span>
<span id="cb376-6"><a href="#cb376-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Adcyap1r1"</span>,</span>
<span id="cb376-7"><a href="#cb376-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Otp"</span>,</span>
<span id="cb376-8"><a href="#cb376-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alk"</span>,</span>
<span id="cb376-9"><a href="#cb376-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Npy1r"</span>,</span>
<span id="cb376-10"><a href="#cb376-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Npy2r"</span>,</span>
<span id="cb376-11"><a href="#cb376-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Gfap"</span>,</span>
<span id="cb376-12"><a href="#cb376-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Lxn"</span>,</span>
<span id="cb376-13"><a href="#cb376-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Slc1a3"</span>,</span>
<span id="cb376-14"><a href="#cb376-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Htra1"</span>,</span>
<span id="cb376-15"><a href="#cb376-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Mfn2"</span>,</span>
<span id="cb376-16"><a href="#cb376-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Fos"</span>,</span>
<span id="cb376-17"><a href="#cb376-17" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb376-18"><a href="#cb376-18" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb376-19"><a href="#cb376-19" aria-hidden="true" tabindex="-1"></a>    add_outline<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb376-20"><a href="#cb376-20" aria-hidden="true" tabindex="-1"></a>    legend_fontsize<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb376-21"><a href="#cb376-21" aria-hidden="true" tabindex="-1"></a>    legend_fontoutline<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb376-22"><a href="#cb376-22" aria-hidden="true" tabindex="-1"></a>    frameon<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb376-23"><a href="#cb376-23" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span><span class="st">"nipy_spectral"</span>,</span>
<span id="cb376-24"><a href="#cb376-24" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb376-25"><a href="#cb376-25" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="st">"-pacmap-subset-int-chronic-stress.pdf"</span>,</span>
<span id="cb376-26"><a href="#cb376-26" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING: saving figure to file ../output/figures/velocity-signalling/X_pacmap-pacmap-subset-int-chronic-stress.pdf</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-39-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="39">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb378"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a>sc.pl.embedding(</span>
<span id="cb378-2"><a href="#cb378-2" aria-hidden="true" tabindex="-1"></a>    adata_chronic_stress,</span>
<span id="cb378-3"><a href="#cb378-3" aria-hidden="true" tabindex="-1"></a>    basis<span class="op">=</span><span class="st">"X_pacmap"</span>,</span>
<span id="cb378-4"><a href="#cb378-4" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>[g <span class="cf">for</span> g <span class="kw">in</span> genes_embed <span class="cf">if</span> g <span class="kw">in</span> adata_chronic_stress.var_names],</span>
<span id="cb378-5"><a href="#cb378-5" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb378-6"><a href="#cb378-6" aria-hidden="true" tabindex="-1"></a>    add_outline<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb378-7"><a href="#cb378-7" aria-hidden="true" tabindex="-1"></a>    legend_fontsize<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb378-8"><a href="#cb378-8" aria-hidden="true" tabindex="-1"></a>    legend_fontoutline<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb378-9"><a href="#cb378-9" aria-hidden="true" tabindex="-1"></a>    frameon<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb378-10"><a href="#cb378-10" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span><span class="st">"nipy_spectral"</span>,</span>
<span id="cb378-11"><a href="#cb378-11" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb378-12"><a href="#cb378-12" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="st">"-pacmap-subset-adgene-chronic-stress.pdf"</span>,</span>
<span id="cb378-13"><a href="#cb378-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING: saving figure to file ../output/figures/velocity-signalling/X_pacmap-pacmap-subset-adgene-chronic-stress.pdf</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-40-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="40">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb380"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb380-1"><a href="#cb380-1" aria-hidden="true" tabindex="-1"></a>sc.pp.normalize_total(adata_chronic_stress, target_sum<span class="op">=</span><span class="fl">1e4</span>)</span>
<span id="cb380-2"><a href="#cb380-2" aria-hidden="true" tabindex="-1"></a>sc.pp.log1p(adata_chronic_stress)</span>
<span id="cb380-3"><a href="#cb380-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate the processed POMC and AGRP/NPY neurons in HFHS diet condition!!!</span></span>
<span id="cb380-4"><a href="#cb380-4" aria-hidden="true" tabindex="-1"></a>adata_chronic_stress <span class="op">=</span> ad.concat(</span>
<span id="cb380-5"><a href="#cb380-5" aria-hidden="true" tabindex="-1"></a>    [adata_chronic_stress, adata_arc_neurons_hfhsdiet], join<span class="op">=</span><span class="st">"inner"</span></span>
<span id="cb380-6"><a href="#cb380-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb380-7"><a href="#cb380-7" aria-hidden="true" tabindex="-1"></a>adata_chronic_stress.raw <span class="op">=</span> adata_chronic_stress</span>
<span id="cb380-8"><a href="#cb380-8" aria-hidden="true" tabindex="-1"></a>adata_chronic_stress.obs[<span class="st">"goi"</span>] <span class="op">=</span> pd.Categorical(adata_chronic_stress.obs[<span class="st">"goi"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>normalizing counts per cell</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>    finished (0:00:00)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="41">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb383"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a>li.mt.rank_aggregate(</span>
<span id="cb383-2"><a href="#cb383-2" aria-hidden="true" tabindex="-1"></a>    adata_chronic_stress,</span>
<span id="cb383-3"><a href="#cb383-3" aria-hidden="true" tabindex="-1"></a>    groupby<span class="op">=</span><span class="st">"goi"</span>,</span>
<span id="cb383-4"><a href="#cb383-4" aria-hidden="true" tabindex="-1"></a>    de_method<span class="op">=</span><span class="st">"logreg"</span>,</span>
<span id="cb383-5"><a href="#cb383-5" aria-hidden="true" tabindex="-1"></a>    expr_prop<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb383-6"><a href="#cb383-6" aria-hidden="true" tabindex="-1"></a>    min_cells<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb383-7"><a href="#cb383-7" aria-hidden="true" tabindex="-1"></a>    return_all_lrs<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb383-8"><a href="#cb383-8" aria-hidden="true" tabindex="-1"></a>    verbose<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb383-9"><a href="#cb383-9" aria-hidden="true" tabindex="-1"></a>    resource_name<span class="op">=</span><span class="st">"mouseconsensus"</span>,</span>
<span id="cb383-10"><a href="#cb383-10" aria-hidden="true" tabindex="-1"></a>    n_perms<span class="op">=</span><span class="dv">100000</span>,</span>
<span id="cb383-11"><a href="#cb383-11" aria-hidden="true" tabindex="-1"></a>    seed<span class="op">=</span>reseed,</span>
<span id="cb383-12"><a href="#cb383-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>... as `zero_center=True`, sparse input is densified and may lead to large memory consumption</code></pre>
</div>
</div>
<div class="cell" data-execution_count="42">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb385"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a>adata_chronic_stress.uns[<span class="st">"liana_res"</span>].to_csv(</span>
<span id="cb385-2"><a href="#cb385-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"chronic-stress-pvn_astro-with_npy_pomc-liana-res.csv"</span></span>
<span id="cb385-3"><a href="#cb385-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb385-4"><a href="#cb385-4" aria-hidden="true" tabindex="-1"></a>adata_chronic_stress.uns[<span class="st">"liana_res"</span>].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="42">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>source</th>
      <th>target</th>
      <th>ligand_complex</th>
      <th>receptor_complex</th>
      <th>lr_means</th>
      <th>cellphone_pvals</th>
      <th>expr_prod</th>
      <th>scaled_weight</th>
      <th>lr_logfc</th>
      <th>spec_weight</th>
      <th>lrscore</th>
      <th>lr_probs</th>
      <th>cellchat_pvals</th>
      <th>steady_rank</th>
      <th>specificity_rank</th>
      <th>magnitude_rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>34056</th>
      <td>POMC neurons</td>
      <td>Astro_LXN-</td>
      <td>Nlgn1</td>
      <td>Nrxn1</td>
      <td>3.536422</td>
      <td>0.00093</td>
      <td>12.416931</td>
      <td>0.397200</td>
      <td>0.538703</td>
      <td>0.077503</td>
      <td>0.963339</td>
      <td>0.287826</td>
      <td>0.00077</td>
      <td>0.001364</td>
      <td>0.015812</td>
      <td>3.168679e-12</td>
    </tr>
    <tr>
      <th>42748</th>
      <td>Astro_LXN-</td>
      <td>POMC neurons</td>
      <td>Nrxn1</td>
      <td>Nlgn1</td>
      <td>3.536422</td>
      <td>0.00093</td>
      <td>12.416931</td>
      <td>0.397200</td>
      <td>0.538703</td>
      <td>0.077503</td>
      <td>0.963339</td>
      <td>0.287826</td>
      <td>0.00077</td>
      <td>0.001364</td>
      <td>0.015812</td>
      <td>3.168679e-12</td>
    </tr>
    <tr>
      <th>7660</th>
      <td>Astro_LXN-</td>
      <td>AGRP/NPY neurons</td>
      <td>Nrxn1</td>
      <td>Nlgn1</td>
      <td>3.468270</td>
      <td>0.00000</td>
      <td>11.894155</td>
      <td>0.331391</td>
      <td>0.463952</td>
      <td>0.074240</td>
      <td>0.962572</td>
      <td>0.275229</td>
      <td>0.00000</td>
      <td>0.000544</td>
      <td>0.006001</td>
      <td>4.025161e-11</td>
    </tr>
    <tr>
      <th>25284</th>
      <td>AGRP/NPY neurons</td>
      <td>Astro_LXN-</td>
      <td>Nlgn1</td>
      <td>Nrxn1</td>
      <td>3.468270</td>
      <td>0.00000</td>
      <td>11.894155</td>
      <td>0.331391</td>
      <td>0.463952</td>
      <td>0.074240</td>
      <td>0.962572</td>
      <td>0.275229</td>
      <td>0.00000</td>
      <td>0.000544</td>
      <td>0.006001</td>
      <td>4.025161e-11</td>
    </tr>
    <tr>
      <th>22360</th>
      <td>POMC neurons</td>
      <td>Astro_LXN+</td>
      <td>Nlgn1</td>
      <td>Nrxn1</td>
      <td>3.424332</td>
      <td>0.02426</td>
      <td>11.691149</td>
      <td>0.240738</td>
      <td>0.162260</td>
      <td>0.072973</td>
      <td>0.962261</td>
      <td>0.270812</td>
      <td>0.04573</td>
      <td>0.004998</td>
      <td>0.020241</td>
      <td>1.561859e-10</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="43">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb386"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb386-1"><a href="#cb386-1" aria-hidden="true" tabindex="-1"></a>n2a_chronic_stress <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb386-2"><a href="#cb386-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_chronic_stress,</span>
<span id="cb386-3"><a href="#cb386-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb386-4"><a href="#cb386-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb386-5"><a href="#cb386-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb386-6"><a href="#cb386-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb386-7"><a href="#cb386-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb386-8"><a href="#cb386-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>],</span>
<span id="cb386-9"><a href="#cb386-9" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb386-10"><a href="#cb386-10" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"lr_logfc"</span>,</span>
<span id="cb386-11"><a href="#cb386-11" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb386-12"><a href="#cb386-12" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb386-13"><a href="#cb386-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb386-14"><a href="#cb386-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb386-15"><a href="#cb386-15" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb386-16"><a href="#cb386-16" aria-hidden="true" tabindex="-1"></a>    n2a_chronic_stress</span>
<span id="cb386-17"><a href="#cb386-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb386-18"><a href="#cb386-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb386-19"><a href="#cb386-19" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb386-20"><a href="#cb386-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb386-21"><a href="#cb386-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb386-22"><a href="#cb386-22" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb386-23"><a href="#cb386-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb386-24"><a href="#cb386-24" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb386-25"><a href="#cb386-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb386-26"><a href="#cb386-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb386-27"><a href="#cb386-27" aria-hidden="true" tabindex="-1"></a>n2a_chronic_stress.save(filename<span class="op">=</span><span class="st">"liana-dotplot-logfc-chronic-stress-n2a.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="44">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb427"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb427-1"><a href="#cb427-1" aria-hidden="true" tabindex="-1"></a>n2a_chronic_stress <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb427-2"><a href="#cb427-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_chronic_stress,</span>
<span id="cb427-3"><a href="#cb427-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb427-4"><a href="#cb427-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb427-5"><a href="#cb427-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb427-6"><a href="#cb427-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb427-7"><a href="#cb427-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb427-8"><a href="#cb427-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>],</span>
<span id="cb427-9"><a href="#cb427-9" aria-hidden="true" tabindex="-1"></a>    filterby<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb427-10"><a href="#cb427-10" aria-hidden="true" tabindex="-1"></a>    filter_lambda<span class="op">=</span><span class="kw">lambda</span> x: x <span class="op">&lt;=</span> <span class="fl">0.01</span>,</span>
<span id="cb427-11"><a href="#cb427-11" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb427-12"><a href="#cb427-12" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb427-13"><a href="#cb427-13" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb427-14"><a href="#cb427-14" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb427-15"><a href="#cb427-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb427-16"><a href="#cb427-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-17"><a href="#cb427-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb427-18"><a href="#cb427-18" aria-hidden="true" tabindex="-1"></a>    n2a_chronic_stress</span>
<span id="cb427-19"><a href="#cb427-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb427-20"><a href="#cb427-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb427-21"><a href="#cb427-21" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb427-22"><a href="#cb427-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb427-23"><a href="#cb427-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb427-24"><a href="#cb427-24" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb427-25"><a href="#cb427-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb427-26"><a href="#cb427-26" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb427-27"><a href="#cb427-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb427-28"><a href="#cb427-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb427-29"><a href="#cb427-29" aria-hidden="true" tabindex="-1"></a>n2a_chronic_stress.save(</span>
<span id="cb427-30"><a href="#cb427-30" aria-hidden="true" tabindex="-1"></a>    filename<span class="op">=</span><span class="st">"liana-dotplot-specificity_rank-chronic-stress-n2a.pdf"</span></span>
<span id="cb427-31"><a href="#cb427-31" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="45">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb470"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb470-1"><a href="#cb470-1" aria-hidden="true" tabindex="-1"></a>n2a_chronic_stress <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb470-2"><a href="#cb470-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_chronic_stress,</span>
<span id="cb470-3"><a href="#cb470-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb470-4"><a href="#cb470-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb470-5"><a href="#cb470-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb470-6"><a href="#cb470-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb470-7"><a href="#cb470-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb470-8"><a href="#cb470-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>],</span>
<span id="cb470-9"><a href="#cb470-9" aria-hidden="true" tabindex="-1"></a>    filterby<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb470-10"><a href="#cb470-10" aria-hidden="true" tabindex="-1"></a>    filter_lambda<span class="op">=</span><span class="kw">lambda</span> x: x <span class="op">&lt;=</span> <span class="fl">0.01</span>,</span>
<span id="cb470-11"><a href="#cb470-11" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb470-12"><a href="#cb470-12" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb470-13"><a href="#cb470-13" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb470-14"><a href="#cb470-14" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb470-15"><a href="#cb470-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb470-16"><a href="#cb470-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb470-17"><a href="#cb470-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb470-18"><a href="#cb470-18" aria-hidden="true" tabindex="-1"></a>    n2a_chronic_stress</span>
<span id="cb470-19"><a href="#cb470-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb470-20"><a href="#cb470-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb470-21"><a href="#cb470-21" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb470-22"><a href="#cb470-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb470-23"><a href="#cb470-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb470-24"><a href="#cb470-24" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb470-25"><a href="#cb470-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb470-26"><a href="#cb470-26" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb470-27"><a href="#cb470-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb470-28"><a href="#cb470-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb470-29"><a href="#cb470-29" aria-hidden="true" tabindex="-1"></a>n2a_chronic_stress.save(filename<span class="op">=</span><span class="st">"liana-dotplot-magnitude_rank-chronic-stress-n2a.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="46">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb511"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb511-1"><a href="#cb511-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, filter the DataFrame</span></span>
<span id="cb511-2"><a href="#cb511-2" aria-hidden="true" tabindex="-1"></a>filtered_df <span class="op">=</span> adata_chronic_stress.uns[<span class="st">'liana_res'</span>][adata_chronic_stress.uns[<span class="st">'liana_res'</span>][<span class="st">'receptor_complex'</span>] <span class="op">==</span> <span class="st">'Insr'</span>]</span>
<span id="cb511-3"><a href="#cb511-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb511-4"><a href="#cb511-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Then, pass the filtered DataFrame to the dotplot function</span></span>
<span id="cb511-5"><a href="#cb511-5" aria-hidden="true" tabindex="-1"></a>n2a_chronic_stress <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb511-6"><a href="#cb511-6" aria-hidden="true" tabindex="-1"></a>    liana_res<span class="op">=</span>filtered_df,</span>
<span id="cb511-7"><a href="#cb511-7" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb511-8"><a href="#cb511-8" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb511-9"><a href="#cb511-9" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb511-10"><a href="#cb511-10" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb511-11"><a href="#cb511-11" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb511-12"><a href="#cb511-12" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>],</span>
<span id="cb511-13"><a href="#cb511-13" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb511-14"><a href="#cb511-14" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"lr_logfc"</span>,</span>
<span id="cb511-15"><a href="#cb511-15" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb511-16"><a href="#cb511-16" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb511-17"><a href="#cb511-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb511-18"><a href="#cb511-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb511-19"><a href="#cb511-19" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb511-20"><a href="#cb511-20" aria-hidden="true" tabindex="-1"></a>    n2a_chronic_stress</span>
<span id="cb511-21"><a href="#cb511-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb511-22"><a href="#cb511-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb511-23"><a href="#cb511-23" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb511-24"><a href="#cb511-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb511-25"><a href="#cb511-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb511-26"><a href="#cb511-26" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb511-27"><a href="#cb511-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb511-28"><a href="#cb511-28" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb511-29"><a href="#cb511-29" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb511-30"><a href="#cb511-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb511-31"><a href="#cb511-31" aria-hidden="true" tabindex="-1"></a>n2a_chronic_stress.save(filename<span class="op">=</span><span class="st">"liana-dotplot-insr-logfc-chronic-stress-n2a.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="47">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb539"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb539-1"><a href="#cb539-1" aria-hidden="true" tabindex="-1"></a>n2a_chronic_stress <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb539-2"><a href="#cb539-2" aria-hidden="true" tabindex="-1"></a>    liana_res<span class="op">=</span>filtered_df,</span>
<span id="cb539-3"><a href="#cb539-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb539-4"><a href="#cb539-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb539-5"><a href="#cb539-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb539-6"><a href="#cb539-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb539-7"><a href="#cb539-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb539-8"><a href="#cb539-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>],</span>
<span id="cb539-9"><a href="#cb539-9" aria-hidden="true" tabindex="-1"></a>    filterby<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb539-10"><a href="#cb539-10" aria-hidden="true" tabindex="-1"></a>    filter_lambda<span class="op">=</span><span class="kw">lambda</span> x: x <span class="op">&lt;=</span> <span class="fl">0.01</span>,</span>
<span id="cb539-11"><a href="#cb539-11" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb539-12"><a href="#cb539-12" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb539-13"><a href="#cb539-13" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb539-14"><a href="#cb539-14" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb539-15"><a href="#cb539-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb539-16"><a href="#cb539-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb539-17"><a href="#cb539-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb539-18"><a href="#cb539-18" aria-hidden="true" tabindex="-1"></a>    n2a_chronic_stress</span>
<span id="cb539-19"><a href="#cb539-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb539-20"><a href="#cb539-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb539-21"><a href="#cb539-21" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb539-22"><a href="#cb539-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb539-23"><a href="#cb539-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb539-24"><a href="#cb539-24" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb539-25"><a href="#cb539-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb539-26"><a href="#cb539-26" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb539-27"><a href="#cb539-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb539-28"><a href="#cb539-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb539-29"><a href="#cb539-29" aria-hidden="true" tabindex="-1"></a>n2a_chronic_stress.save(</span>
<span id="cb539-30"><a href="#cb539-30" aria-hidden="true" tabindex="-1"></a>    filename<span class="op">=</span><span class="st">"liana-dotplot-insr-specificity_rank-chronic-stress-n2a.pdf"</span></span>
<span id="cb539-31"><a href="#cb539-31" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="48">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb557"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb557-1"><a href="#cb557-1" aria-hidden="true" tabindex="-1"></a>n2a_chronic_stress <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb557-2"><a href="#cb557-2" aria-hidden="true" tabindex="-1"></a>    liana_res<span class="op">=</span>filtered_df,</span>
<span id="cb557-3"><a href="#cb557-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb557-4"><a href="#cb557-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb557-5"><a href="#cb557-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb557-6"><a href="#cb557-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb557-7"><a href="#cb557-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb557-8"><a href="#cb557-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>],</span>
<span id="cb557-9"><a href="#cb557-9" aria-hidden="true" tabindex="-1"></a>    filterby<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb557-10"><a href="#cb557-10" aria-hidden="true" tabindex="-1"></a>    filter_lambda<span class="op">=</span><span class="kw">lambda</span> x: x <span class="op">&lt;=</span> <span class="fl">0.01</span>,</span>
<span id="cb557-11"><a href="#cb557-11" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb557-12"><a href="#cb557-12" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb557-13"><a href="#cb557-13" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb557-14"><a href="#cb557-14" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb557-15"><a href="#cb557-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb557-16"><a href="#cb557-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb557-17"><a href="#cb557-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb557-18"><a href="#cb557-18" aria-hidden="true" tabindex="-1"></a>    n2a_chronic_stress</span>
<span id="cb557-19"><a href="#cb557-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb557-20"><a href="#cb557-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb557-21"><a href="#cb557-21" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb557-22"><a href="#cb557-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb557-23"><a href="#cb557-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb557-24"><a href="#cb557-24" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb557-25"><a href="#cb557-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb557-26"><a href="#cb557-26" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb557-27"><a href="#cb557-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb557-28"><a href="#cb557-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb557-29"><a href="#cb557-29" aria-hidden="true" tabindex="-1"></a>n2a_chronic_stress.save(filename<span class="op">=</span><span class="st">"liana-dotplot-insr-magnitude_rank-chronic-stress-n2a.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="49">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb577"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb577-1"><a href="#cb577-1" aria-hidden="true" tabindex="-1"></a>a2n_chronic_stress <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb577-2"><a href="#cb577-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_chronic_stress,</span>
<span id="cb577-3"><a href="#cb577-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb577-4"><a href="#cb577-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb577-5"><a href="#cb577-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb577-6"><a href="#cb577-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb577-7"><a href="#cb577-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>],</span>
<span id="cb577-8"><a href="#cb577-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb577-9"><a href="#cb577-9" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb577-10"><a href="#cb577-10" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"lr_logfc"</span>,</span>
<span id="cb577-11"><a href="#cb577-11" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb577-12"><a href="#cb577-12" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb577-13"><a href="#cb577-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb577-14"><a href="#cb577-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb577-15"><a href="#cb577-15" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb577-16"><a href="#cb577-16" aria-hidden="true" tabindex="-1"></a>    a2n_chronic_stress</span>
<span id="cb577-17"><a href="#cb577-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb577-18"><a href="#cb577-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb577-19"><a href="#cb577-19" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb577-20"><a href="#cb577-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb577-21"><a href="#cb577-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb577-22"><a href="#cb577-22" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb577-23"><a href="#cb577-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb577-24"><a href="#cb577-24" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb577-25"><a href="#cb577-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb577-26"><a href="#cb577-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb577-27"><a href="#cb577-27" aria-hidden="true" tabindex="-1"></a>a2n_chronic_stress.save(filename<span class="op">=</span><span class="st">"liana-dotplot-logfc-chronic-stress-a2n.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="50">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb617"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb617-1"><a href="#cb617-1" aria-hidden="true" tabindex="-1"></a>a2n_chronic_stress <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb617-2"><a href="#cb617-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_chronic_stress,</span>
<span id="cb617-3"><a href="#cb617-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb617-4"><a href="#cb617-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb617-5"><a href="#cb617-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb617-6"><a href="#cb617-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb617-7"><a href="#cb617-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>],</span>
<span id="cb617-8"><a href="#cb617-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb617-9"><a href="#cb617-9" aria-hidden="true" tabindex="-1"></a>    filterby<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb617-10"><a href="#cb617-10" aria-hidden="true" tabindex="-1"></a>    filter_lambda<span class="op">=</span><span class="kw">lambda</span> x: x <span class="op">&lt;=</span> <span class="fl">0.01</span>,</span>
<span id="cb617-11"><a href="#cb617-11" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb617-12"><a href="#cb617-12" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb617-13"><a href="#cb617-13" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb617-14"><a href="#cb617-14" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb617-15"><a href="#cb617-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb617-16"><a href="#cb617-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb617-17"><a href="#cb617-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb617-18"><a href="#cb617-18" aria-hidden="true" tabindex="-1"></a>    a2n_chronic_stress</span>
<span id="cb617-19"><a href="#cb617-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb617-20"><a href="#cb617-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb617-21"><a href="#cb617-21" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb617-22"><a href="#cb617-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb617-23"><a href="#cb617-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb617-24"><a href="#cb617-24" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb617-25"><a href="#cb617-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb617-26"><a href="#cb617-26" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb617-27"><a href="#cb617-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb617-28"><a href="#cb617-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb617-29"><a href="#cb617-29" aria-hidden="true" tabindex="-1"></a>a2n_chronic_stress.save(</span>
<span id="cb617-30"><a href="#cb617-30" aria-hidden="true" tabindex="-1"></a>    filename<span class="op">=</span><span class="st">"liana-dotplot-specificity_rank-chronic-stress-a2n.pdf"</span></span>
<span id="cb617-31"><a href="#cb617-31" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="51">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb657"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb657-1"><a href="#cb657-1" aria-hidden="true" tabindex="-1"></a>a2n_chronic_stress <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb657-2"><a href="#cb657-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_chronic_stress,</span>
<span id="cb657-3"><a href="#cb657-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb657-4"><a href="#cb657-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb657-5"><a href="#cb657-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb657-6"><a href="#cb657-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb657-7"><a href="#cb657-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>],</span>
<span id="cb657-8"><a href="#cb657-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb657-9"><a href="#cb657-9" aria-hidden="true" tabindex="-1"></a>    filterby<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb657-10"><a href="#cb657-10" aria-hidden="true" tabindex="-1"></a>    filter_lambda<span class="op">=</span><span class="kw">lambda</span> x: x <span class="op">&lt;=</span> <span class="fl">0.01</span>,</span>
<span id="cb657-11"><a href="#cb657-11" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb657-12"><a href="#cb657-12" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb657-13"><a href="#cb657-13" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb657-14"><a href="#cb657-14" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb657-15"><a href="#cb657-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb657-16"><a href="#cb657-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb657-17"><a href="#cb657-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb657-18"><a href="#cb657-18" aria-hidden="true" tabindex="-1"></a>    a2n_chronic_stress</span>
<span id="cb657-19"><a href="#cb657-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb657-20"><a href="#cb657-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb657-21"><a href="#cb657-21" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb657-22"><a href="#cb657-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb657-23"><a href="#cb657-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb657-24"><a href="#cb657-24" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb657-25"><a href="#cb657-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb657-26"><a href="#cb657-26" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb657-27"><a href="#cb657-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb657-28"><a href="#cb657-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb657-29"><a href="#cb657-29" aria-hidden="true" tabindex="-1"></a>a2n_chronic_stress.save(filename<span class="op">=</span><span class="st">"liana-dotplot-magnitude_rank-chronic-stress-a2n.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<p>Save data</p>
<div class="cell" data-execution_count="52">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb698"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb698-1"><a href="#cb698-1" aria-hidden="true" tabindex="-1"></a>adata_chronic_stress.write(</span>
<span id="cb698-2"><a href="#cb698-2" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"/data/</span><span class="sc">{</span>bioproject<span class="sc">}</span><span class="ss">/data/velocity-signalling/</span><span class="sc">{</span>bioproject<span class="sc">}</span><span class="ss">-signalling-treatment.h5ad"</span></span>
<span id="cb698-3"><a href="#cb698-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="preprocess-data-for-velocity" class="level3">
<h3 class="anchored" data-anchor-id="preprocess-data-for-velocity">Preprocess data for velocity</h3>
<div class="cell" data-execution_count="53">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb699"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb699-1"><a href="#cb699-1" aria-hidden="true" tabindex="-1"></a>adata1 <span class="op">=</span> scv.read(<span class="st">"../piscem_spliceu/SRR13081815/SRR13081815.h5ad"</span>)</span>
<span id="cb699-2"><a href="#cb699-2" aria-hidden="true" tabindex="-1"></a>adata2 <span class="op">=</span> scv.read(<span class="st">"../piscem_spliceu/SRR13081816/SRR13081816.h5ad"</span>)</span>
<span id="cb699-3"><a href="#cb699-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb699-4"><a href="#cb699-4" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare cell names</span></span>
<span id="cb699-5"><a href="#cb699-5" aria-hidden="true" tabindex="-1"></a>cells1 <span class="op">=</span> <span class="st">"SRR13081815_"</span> <span class="op">+</span> adata1.obs_names <span class="op">+</span> <span class="st">"-1"</span></span>
<span id="cb699-6"><a href="#cb699-6" aria-hidden="true" tabindex="-1"></a>adata1.obs_names <span class="op">=</span> cells1</span>
<span id="cb699-7"><a href="#cb699-7" aria-hidden="true" tabindex="-1"></a>adata1.obs[<span class="st">"run"</span>] <span class="op">=</span> <span class="st">"SRR13081815"</span></span>
<span id="cb699-8"><a href="#cb699-8" aria-hidden="true" tabindex="-1"></a>cells2 <span class="op">=</span> <span class="st">"SRR13081816_"</span> <span class="op">+</span> adata2.obs_names <span class="op">+</span> <span class="st">"-1"</span></span>
<span id="cb699-9"><a href="#cb699-9" aria-hidden="true" tabindex="-1"></a>adata2.obs_names <span class="op">=</span> cells2</span>
<span id="cb699-10"><a href="#cb699-10" aria-hidden="true" tabindex="-1"></a>adata2.obs[<span class="st">"run"</span>] <span class="op">=</span> <span class="st">"SRR13081816"</span></span>
<span id="cb699-11"><a href="#cb699-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb699-12"><a href="#cb699-12" aria-hidden="true" tabindex="-1"></a><span class="co"># subset cleared astrocytes</span></span>
<span id="cb699-13"><a href="#cb699-13" aria-hidden="true" tabindex="-1"></a>adata1 <span class="op">=</span> adata1[adata1.obs_names.isin(adata.obs_names), :]</span>
<span id="cb699-14"><a href="#cb699-14" aria-hidden="true" tabindex="-1"></a>adata2 <span class="op">=</span> adata2[adata2.obs_names.isin(adata.obs_names), :]</span>
<span id="cb699-15"><a href="#cb699-15" aria-hidden="true" tabindex="-1"></a>velocity_data <span class="op">=</span> ad.concat([adata1, adata2], join<span class="op">=</span><span class="st">"inner"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="54">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb700"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb700-1"><a href="#cb700-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get a list of gene ids from your Scanpy object</span></span>
<span id="cb700-2"><a href="#cb700-2" aria-hidden="true" tabindex="-1"></a>gene_ids <span class="op">=</span> velocity_data.var_names.tolist()</span>
<span id="cb700-3"><a href="#cb700-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb700-4"><a href="#cb700-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert gene symbols to Ensembl IDs using gprofiler</span></span>
<span id="cb700-5"><a href="#cb700-5" aria-hidden="true" tabindex="-1"></a>gp <span class="op">=</span> GProfiler(return_dataframe<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb700-6"><a href="#cb700-6" aria-hidden="true" tabindex="-1"></a>gene_symbols <span class="op">=</span> (</span>
<span id="cb700-7"><a href="#cb700-7" aria-hidden="true" tabindex="-1"></a>    gp.convert(query<span class="op">=</span>gene_ids, organism<span class="op">=</span><span class="st">"mmusculus"</span>, target_namespace<span class="op">=</span><span class="st">"MGI"</span>)</span>
<span id="cb700-8"><a href="#cb700-8" aria-hidden="true" tabindex="-1"></a>    .drop_duplicates([<span class="st">"incoming"</span>])</span>
<span id="cb700-9"><a href="#cb700-9" aria-hidden="true" tabindex="-1"></a>    .set_index(<span class="st">"incoming"</span>, drop<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb700-10"><a href="#cb700-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="55">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb701"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb701-1"><a href="#cb701-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the gene IDs as a new column in your Scanpy object's variable metadata</span></span>
<span id="cb701-2"><a href="#cb701-2" aria-hidden="true" tabindex="-1"></a>velocity_data.var[<span class="st">"ensembl_ids"</span>] <span class="op">=</span> gene_symbols[<span class="st">"incoming"</span>][gene_ids].values</span>
<span id="cb701-3"><a href="#cb701-3" aria-hidden="true" tabindex="-1"></a>velocity_data.var[<span class="st">"mgi_symbol"</span>] <span class="op">=</span> gene_symbols[<span class="st">"converted"</span>][gene_ids].values</span>
<span id="cb701-4"><a href="#cb701-4" aria-hidden="true" tabindex="-1"></a>velocity_data.var_names <span class="op">=</span> velocity_data.var[<span class="st">"mgi_symbol"</span>]</span>
<span id="cb701-5"><a href="#cb701-5" aria-hidden="true" tabindex="-1"></a>velocity_data.var_names_make_unique()</span>
<span id="cb701-6"><a href="#cb701-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb701-7"><a href="#cb701-7" aria-hidden="true" tabindex="-1"></a>velocity_data.obs[<span class="st">"cell_id"</span>] <span class="op">=</span> velocity_data.obs_names</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="56">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb702"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb702-1"><a href="#cb702-1" aria-hidden="true" tabindex="-1"></a>velocity_data <span class="op">=</span> velocity_data[</span>
<span id="cb702-2"><a href="#cb702-2" aria-hidden="true" tabindex="-1"></a>    :,</span>
<span id="cb702-3"><a href="#cb702-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">~</span>velocity_data.var_names.<span class="bu">str</span>.match(</span>
<span id="cb702-4"><a href="#cb702-4" aria-hidden="true" tabindex="-1"></a>        <span class="vs">r"(^Hla-|^Ig[hjkl]|^Rna|^mt-|^Rp[sl]|^Hb[^(p)]|^Gm)"</span></span>
<span id="cb702-5"><a href="#cb702-5" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb702-6"><a href="#cb702-6" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb702-7"><a href="#cb702-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-8"><a href="#cb702-8" aria-hidden="true" tabindex="-1"></a>velocity_data <span class="op">=</span> velocity_data[:, <span class="op">~</span>velocity_data.var_names.isin(hk_genes1)]</span>
<span id="cb702-9"><a href="#cb702-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-10"><a href="#cb702-10" aria-hidden="true" tabindex="-1"></a>velocity_data.obs <span class="op">=</span> pd.merge(velocity_data.obs, adata.obs, how<span class="op">=</span><span class="st">"left"</span>).set_index(</span>
<span id="cb702-11"><a href="#cb702-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"cell_id"</span>, drop<span class="op">=</span><span class="va">False</span></span>
<span id="cb702-12"><a href="#cb702-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="57">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb703"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb703-1"><a href="#cb703-1" aria-hidden="true" tabindex="-1"></a>scv.pl.proportions(velocity_data, groupby<span class="op">=</span><span class="st">"libname"</span>, save<span class="op">=</span><span class="st">"-expbtch-proportions.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>saving figure to file ./figures/scvelo_proportions_-expbtch-proportions.pdf</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-58-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="58">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb705"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb705-1"><a href="#cb705-1" aria-hidden="true" tabindex="-1"></a>scv.pl.proportions(velocity_data, groupby<span class="op">=</span><span class="st">"k_tree"</span>, save<span class="op">=</span><span class="st">"-k_tree-proportions.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>saving figure to file ./figures/scvelo_proportions_-k_tree-proportions.pdf</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-59-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="rna-velocity" class="level3">
<h3 class="anchored" data-anchor-id="rna-velocity">RNA velocity</h3>
<div class="cell" data-execution_count="59">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb707"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb707-1"><a href="#cb707-1" aria-hidden="true" tabindex="-1"></a><span class="co">## run scvelo dynamic model</span></span>
<span id="cb707-2"><a href="#cb707-2" aria-hidden="true" tabindex="-1"></a>scv.pp.filter_and_normalize(</span>
<span id="cb707-3"><a href="#cb707-3" aria-hidden="true" tabindex="-1"></a>    velocity_data, min_shared_counts<span class="op">=</span>min_shared_umis, n_top_genes<span class="op">=</span>n_top_hvg</span>
<span id="cb707-4"><a href="#cb707-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb707-5"><a href="#cb707-5" aria-hidden="true" tabindex="-1"></a>sc.tl.pca(velocity_data, n_comps<span class="op">=</span>npcs, svd_solver<span class="op">=</span><span class="st">"arpack"</span>, random_state<span class="op">=</span>reseed)</span>
<span id="cb707-6"><a href="#cb707-6" aria-hidden="true" tabindex="-1"></a>sc.pp.neighbors(velocity_data, n_pcs<span class="op">=</span>npcs_selected, n_neighbors<span class="op">=</span>k)</span>
<span id="cb707-7"><a href="#cb707-7" aria-hidden="true" tabindex="-1"></a>scv.pp.moments(velocity_data)  <span class="co">## compute moments</span></span>
<span id="cb707-8"><a href="#cb707-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb707-9"><a href="#cb707-9" aria-hidden="true" tabindex="-1"></a>embedding <span class="op">=</span> pacmap.PaCMAP(</span>
<span id="cb707-10"><a href="#cb707-10" aria-hidden="true" tabindex="-1"></a>    n_components<span class="op">=</span><span class="dv">2</span>, n_neighbors<span class="op">=</span><span class="va">None</span>, MN_ratio<span class="op">=</span><span class="fl">0.5</span>, FP_ratio<span class="op">=</span><span class="fl">2.0</span>, apply_pca<span class="op">=</span><span class="va">False</span></span>
<span id="cb707-11"><a href="#cb707-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb707-12"><a href="#cb707-12" aria-hidden="true" tabindex="-1"></a>velocity_data.obsm[<span class="st">"X_pacmap"</span>] <span class="op">=</span> embedding.fit_transform(</span>
<span id="cb707-13"><a href="#cb707-13" aria-hidden="true" tabindex="-1"></a>    velocity_data.obsm[<span class="st">"X_pca"</span>], init<span class="op">=</span><span class="st">"pca"</span></span>
<span id="cb707-14"><a href="#cb707-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb707-15"><a href="#cb707-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb707-16"><a href="#cb707-16" aria-hidden="true" tabindex="-1"></a>reducer <span class="op">=</span> umap.UMAP(densmap<span class="op">=</span><span class="va">True</span>, n_components<span class="op">=</span><span class="dv">2</span>, random_state<span class="op">=</span>reseed, verbose<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb707-17"><a href="#cb707-17" aria-hidden="true" tabindex="-1"></a>reducer.fit(velocity_data.obsm[<span class="st">"X_pca"</span>])</span>
<span id="cb707-18"><a href="#cb707-18" aria-hidden="true" tabindex="-1"></a>velocity_data.obsm[<span class="st">"X_umap"</span>] <span class="op">=</span> reducer.transform(velocity_data.obsm[<span class="st">"X_pca"</span>])</span>
<span id="cb707-19"><a href="#cb707-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb707-20"><a href="#cb707-20" aria-hidden="true" tabindex="-1"></a>scv.tl.recover_dynamics(velocity_data, n_jobs<span class="op">=</span>threads)  <span class="co">## model</span></span>
<span id="cb707-21"><a href="#cb707-21" aria-hidden="true" tabindex="-1"></a>scv.tl.velocity(velocity_data, mode<span class="op">=</span><span class="st">"dynamical"</span>)</span>
<span id="cb707-22"><a href="#cb707-22" aria-hidden="true" tabindex="-1"></a>scv.tl.velocity_graph(velocity_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Filtered out 24039 genes that are detected 15 counts (shared).
Normalized count data: X, spliced, unspliced.
Skip filtering by dispersion since number of variables are less than `n_top_genes`.
WARNING: Did not modify X as it looks preprocessed already.
computing PCA</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>    with n_comps=50</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>    finished (0:00:00)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>computing neighbors</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>    using 'X_pca' with n_pcs = 30</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>    finished (0:00:02)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>computing neighbors
    finished (0:00:00) --&gt; added 
    'distances' and 'connectivities', weighted adjacency matrices (adata.obsp)
computing moments based on connectivities
    finished (0:00:00) --&gt; added 
    'Ms' and 'Mu', moments of un/spliced abundances (adata.layers)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>recovering dynamics (using 80/256 cores)</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"cb4714d12775489a83ba361c698fb8f4","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>    finished (0:00:06) --&gt; added 
    'fit_pars', fitted parameters for splicing dynamics (adata.var)
computing velocities
    finished (0:00:00) --&gt; added 
    'velocity', velocity vectors for each individual cell (adata.layers)
computing velocity graph (using 1/256 cores)</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"72c2c80e5a5a4b5fa820ecc858cedf4c","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>    finished (0:00:00) --&gt; added 
    'velocity_graph', sparse matrix with cosine correlations (adata.uns)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="60">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb718"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb718-1"><a href="#cb718-1" aria-hidden="true" tabindex="-1"></a>save_PRJNA679294 <span class="op">=</span> <span class="ss">f"-PRJNA679294-astrocytes_datasets-velocity.pdf"</span></span>
<span id="cb718-2"><a href="#cb718-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb718-3"><a href="#cb718-3" aria-hidden="true" tabindex="-1"></a>scv.pl.velocity_embedding_stream(</span>
<span id="cb718-4"><a href="#cb718-4" aria-hidden="true" tabindex="-1"></a>    velocity_data,</span>
<span id="cb718-5"><a href="#cb718-5" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"k_tree"</span>,</span>
<span id="cb718-6"><a href="#cb718-6" aria-hidden="true" tabindex="-1"></a>    basis<span class="op">=</span><span class="st">"umap"</span>,</span>
<span id="cb718-7"><a href="#cb718-7" aria-hidden="true" tabindex="-1"></a>    density<span class="op">=</span>dnsty,</span>
<span id="cb718-8"><a href="#cb718-8" aria-hidden="true" tabindex="-1"></a>    cutoff_perc<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb718-9"><a href="#cb718-9" aria-hidden="true" tabindex="-1"></a>    n_neighbors<span class="op">=</span>k,</span>
<span id="cb718-10"><a href="#cb718-10" aria-hidden="true" tabindex="-1"></a>    smooth<span class="op">=</span><span class="fl">0.8</span>,</span>
<span id="cb718-11"><a href="#cb718-11" aria-hidden="true" tabindex="-1"></a>    min_mass<span class="op">=</span><span class="dv">4</span>,</span>
<span id="cb718-12"><a href="#cb718-12" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">""</span>,</span>
<span id="cb718-13"><a href="#cb718-13" aria-hidden="true" tabindex="-1"></a>    legend_fontoutline<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb718-14"><a href="#cb718-14" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span>pt_size,</span>
<span id="cb718-15"><a href="#cb718-15" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.8</span>,</span>
<span id="cb718-16"><a href="#cb718-16" aria-hidden="true" tabindex="-1"></a>    legend_fontsize<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb718-17"><a href="#cb718-17" aria-hidden="true" tabindex="-1"></a>    linewidth<span class="op">=</span><span class="fl">2.5</span>,</span>
<span id="cb718-18"><a href="#cb718-18" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb718-19"><a href="#cb718-19" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>plt_size,</span>
<span id="cb718-20"><a href="#cb718-20" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span><span class="st">"nipy_spectral"</span>,</span>
<span id="cb718-21"><a href="#cb718-21" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span>save_PRJNA679294,</span>
<span id="cb718-22"><a href="#cb718-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb718-23"><a href="#cb718-23" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb718-24"><a href="#cb718-24" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">"dynamic_velocity.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>computing velocity embedding
    finished (0:00:00) --&gt; added
    'velocity_umap', embedded velocity vectors (adata.obsm)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>saving figure to file ./figures/scvelo_-PRJNA679294-astrocytes_datasets-velocity.pdf</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-61-output-3.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 480x480 with 0 Axes&gt;</code></pre>
</div>
</div>
<div class="cell" data-execution_count="61">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb722"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb722-1"><a href="#cb722-1" aria-hidden="true" tabindex="-1"></a>scv.pl.velocity_embedding_stream(</span>
<span id="cb722-2"><a href="#cb722-2" aria-hidden="true" tabindex="-1"></a>    velocity_data,</span>
<span id="cb722-3"><a href="#cb722-3" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"k_tree"</span>,</span>
<span id="cb722-4"><a href="#cb722-4" aria-hidden="true" tabindex="-1"></a>    basis<span class="op">=</span><span class="st">"umap"</span>,</span>
<span id="cb722-5"><a href="#cb722-5" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">""</span>,</span>
<span id="cb722-6"><a href="#cb722-6" aria-hidden="true" tabindex="-1"></a>    legend_loc<span class="op">=</span><span class="st">"none"</span>,</span>
<span id="cb722-7"><a href="#cb722-7" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb722-8"><a href="#cb722-8" aria-hidden="true" tabindex="-1"></a>    legend_fontsize<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb722-9"><a href="#cb722-9" aria-hidden="true" tabindex="-1"></a>    arrow_color<span class="op">=</span><span class="st">"darkslategrey"</span>,</span>
<span id="cb722-10"><a href="#cb722-10" aria-hidden="true" tabindex="-1"></a>    density<span class="op">=</span><span class="fl">0.9</span>,</span>
<span id="cb722-11"><a href="#cb722-11" aria-hidden="true" tabindex="-1"></a>    linewidth<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb722-12"><a href="#cb722-12" aria-hidden="true" tabindex="-1"></a>    arrow_size<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb722-13"><a href="#cb722-13" aria-hidden="true" tabindex="-1"></a>    min_mass<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb722-14"><a href="#cb722-14" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb722-15"><a href="#cb722-15" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>plt_size,</span>
<span id="cb722-16"><a href="#cb722-16" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="st">"-stream"</span> <span class="op">+</span> save_PRJNA679294,</span>
<span id="cb722-17"><a href="#cb722-17" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>saving figure to file ./figures/scvelo_-stream-PRJNA679294-astrocytes_datasets-velocity.pdf</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-62-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="62">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb724"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb724-1"><a href="#cb724-1" aria-hidden="true" tabindex="-1"></a>sc.tl.embedding_density(velocity_data, basis<span class="op">=</span><span class="st">"umap"</span>, groupby<span class="op">=</span><span class="st">"libname"</span>)</span>
<span id="cb724-2"><a href="#cb724-2" aria-hidden="true" tabindex="-1"></a>sc.pl.embedding_density(</span>
<span id="cb724-3"><a href="#cb724-3" aria-hidden="true" tabindex="-1"></a>    velocity_data,</span>
<span id="cb724-4"><a href="#cb724-4" aria-hidden="true" tabindex="-1"></a>    basis<span class="op">=</span><span class="st">"umap"</span>,</span>
<span id="cb724-5"><a href="#cb724-5" aria-hidden="true" tabindex="-1"></a>    key<span class="op">=</span><span class="st">"umap_density_libname"</span>,</span>
<span id="cb724-6"><a href="#cb724-6" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb724-7"><a href="#cb724-7" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="st">"-libname"</span> <span class="op">+</span> save_PRJNA679294,</span>
<span id="cb724-8"><a href="#cb724-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>computing density on 'umap'</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING: saving figure to file ../output/figures/velocity-signalling/umap_density_libname_-libname-PRJNA679294-astrocytes_datasets-velocity.pdf</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/python/3.8.8/lib/python3.8/site-packages/scanpy/plotting/_tools/__init__.py:1450: MatplotlibDeprecationWarning: The get_cmap function was deprecated in Matplotlib 3.7 and will be removed two minor releases later. Use ``matplotlib.colormaps[name]`` or ``matplotlib.colormaps.get_cmap(obj)`` instead.
/opt/python/3.8.8/lib/python3.8/site-packages/scanpy/plotting/_tools/scatterplots.py:163: MatplotlibDeprecationWarning: The get_cmap function was deprecated in Matplotlib 3.7 and will be removed two minor releases later. Use ``matplotlib.colormaps[name]`` or ``matplotlib.colormaps.get_cmap(obj)`` instead.
/opt/python/3.8.8/lib/python3.8/site-packages/scanpy/plotting/_tools/scatterplots.py:163: MatplotlibDeprecationWarning: The get_cmap function was deprecated in Matplotlib 3.7 and will be removed two minor releases later. Use ``matplotlib.colormaps[name]`` or ``matplotlib.colormaps.get_cmap(obj)`` instead.</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-63-output-4.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="63">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb728"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb728-1"><a href="#cb728-1" aria-hidden="true" tabindex="-1"></a>scv.pl.velocity_embedding_stream(</span>
<span id="cb728-2"><a href="#cb728-2" aria-hidden="true" tabindex="-1"></a>    velocity_data,</span>
<span id="cb728-3"><a href="#cb728-3" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"libname"</span>,</span>
<span id="cb728-4"><a href="#cb728-4" aria-hidden="true" tabindex="-1"></a>    basis<span class="op">=</span><span class="st">"umap"</span>,</span>
<span id="cb728-5"><a href="#cb728-5" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">""</span>,</span>
<span id="cb728-6"><a href="#cb728-6" aria-hidden="true" tabindex="-1"></a>    legend_loc<span class="op">=</span><span class="st">"none"</span>,</span>
<span id="cb728-7"><a href="#cb728-7" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb728-8"><a href="#cb728-8" aria-hidden="true" tabindex="-1"></a>    legend_fontsize<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb728-9"><a href="#cb728-9" aria-hidden="true" tabindex="-1"></a>    arrow_color<span class="op">=</span><span class="st">"darkslategrey"</span>,</span>
<span id="cb728-10"><a href="#cb728-10" aria-hidden="true" tabindex="-1"></a>    density<span class="op">=</span><span class="fl">0.9</span>,</span>
<span id="cb728-11"><a href="#cb728-11" aria-hidden="true" tabindex="-1"></a>    linewidth<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb728-12"><a href="#cb728-12" aria-hidden="true" tabindex="-1"></a>    arrow_size<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb728-13"><a href="#cb728-13" aria-hidden="true" tabindex="-1"></a>    min_mass<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb728-14"><a href="#cb728-14" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb728-15"><a href="#cb728-15" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>plt_size,</span>
<span id="cb728-16"><a href="#cb728-16" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="st">"-libname"</span> <span class="op">+</span> save_PRJNA679294,</span>
<span id="cb728-17"><a href="#cb728-17" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>saving figure to file ./figures/scvelo_-libname-PRJNA679294-astrocytes_datasets-velocity.pdf</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-64-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="64">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb730"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb730-1"><a href="#cb730-1" aria-hidden="true" tabindex="-1"></a>scv.pl.velocity_embedding_stream(</span>
<span id="cb730-2"><a href="#cb730-2" aria-hidden="true" tabindex="-1"></a>    velocity_data,</span>
<span id="cb730-3"><a href="#cb730-3" aria-hidden="true" tabindex="-1"></a>    basis<span class="op">=</span><span class="st">"umap"</span>,</span>
<span id="cb730-4"><a href="#cb730-4" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>[g <span class="cf">for</span> g <span class="kw">in</span> npr <span class="cf">if</span> g <span class="kw">in</span> velocity_data.var_names],</span>
<span id="cb730-5"><a href="#cb730-5" aria-hidden="true" tabindex="-1"></a>    legend_loc<span class="op">=</span><span class="st">"none"</span>,</span>
<span id="cb730-6"><a href="#cb730-6" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb730-7"><a href="#cb730-7" aria-hidden="true" tabindex="-1"></a>    legend_fontsize<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb730-8"><a href="#cb730-8" aria-hidden="true" tabindex="-1"></a>    arrow_color<span class="op">=</span><span class="st">"darkslategrey"</span>,</span>
<span id="cb730-9"><a href="#cb730-9" aria-hidden="true" tabindex="-1"></a>    density<span class="op">=</span><span class="fl">0.9</span>,</span>
<span id="cb730-10"><a href="#cb730-10" aria-hidden="true" tabindex="-1"></a>    linewidth<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb730-11"><a href="#cb730-11" aria-hidden="true" tabindex="-1"></a>    arrow_size<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb730-12"><a href="#cb730-12" aria-hidden="true" tabindex="-1"></a>    min_mass<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb730-13"><a href="#cb730-13" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb730-14"><a href="#cb730-14" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span><span class="st">"gnuplot2"</span>,</span>
<span id="cb730-15"><a href="#cb730-15" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>plt_size,</span>
<span id="cb730-16"><a href="#cb730-16" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="dv">40</span>,</span>
<span id="cb730-17"><a href="#cb730-17" aria-hidden="true" tabindex="-1"></a>    ncols<span class="op">=</span><span class="dv">4</span>,</span>
<span id="cb730-18"><a href="#cb730-18" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="st">"-npr-stream"</span> <span class="op">+</span> save_PRJNA679294,</span>
<span id="cb730-19"><a href="#cb730-19" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/python/3.8.8/lib/python3.8/site-packages/scvelo/plotting/utils.py:869: MatplotlibDeprecationWarning: The draw_all function was deprecated in Matplotlib 3.6 and will be removed two minor releases later. Use fig.draw_without_rendering() instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>saving figure to file ./figures/scvelo_-npr-stream-PRJNA679294-astrocytes_datasets-velocity.pdf</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-65-output-3.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="65">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb733"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb733-1"><a href="#cb733-1" aria-hidden="true" tabindex="-1"></a>scv.pl.velocity_embedding_stream(</span>
<span id="cb733-2"><a href="#cb733-2" aria-hidden="true" tabindex="-1"></a>    velocity_data,</span>
<span id="cb733-3"><a href="#cb733-3" aria-hidden="true" tabindex="-1"></a>    basis<span class="op">=</span><span class="st">"umap"</span>,</span>
<span id="cb733-4"><a href="#cb733-4" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>[g <span class="cf">for</span> g <span class="kw">in</span> nmr <span class="cf">if</span> g <span class="kw">in</span> velocity_data.var_names],</span>
<span id="cb733-5"><a href="#cb733-5" aria-hidden="true" tabindex="-1"></a>    legend_loc<span class="op">=</span><span class="st">"none"</span>,</span>
<span id="cb733-6"><a href="#cb733-6" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb733-7"><a href="#cb733-7" aria-hidden="true" tabindex="-1"></a>    legend_fontsize<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb733-8"><a href="#cb733-8" aria-hidden="true" tabindex="-1"></a>    arrow_color<span class="op">=</span><span class="st">"darkslategrey"</span>,</span>
<span id="cb733-9"><a href="#cb733-9" aria-hidden="true" tabindex="-1"></a>    density<span class="op">=</span><span class="fl">0.9</span>,</span>
<span id="cb733-10"><a href="#cb733-10" aria-hidden="true" tabindex="-1"></a>    linewidth<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb733-11"><a href="#cb733-11" aria-hidden="true" tabindex="-1"></a>    arrow_size<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb733-12"><a href="#cb733-12" aria-hidden="true" tabindex="-1"></a>    min_mass<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb733-13"><a href="#cb733-13" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb733-14"><a href="#cb733-14" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span><span class="st">"gnuplot2"</span>,</span>
<span id="cb733-15"><a href="#cb733-15" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>plt_size,</span>
<span id="cb733-16"><a href="#cb733-16" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="dv">40</span>,</span>
<span id="cb733-17"><a href="#cb733-17" aria-hidden="true" tabindex="-1"></a>    ncols<span class="op">=</span><span class="dv">4</span>,</span>
<span id="cb733-18"><a href="#cb733-18" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="st">"-nmr-stream"</span> <span class="op">+</span> save_PRJNA679294,</span>
<span id="cb733-19"><a href="#cb733-19" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/python/3.8.8/lib/python3.8/site-packages/scvelo/plotting/utils.py:869: MatplotlibDeprecationWarning: The draw_all function was deprecated in Matplotlib 3.6 and will be removed two minor releases later. Use fig.draw_without_rendering() instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/python/3.8.8/lib/python3.8/site-packages/scvelo/plotting/utils.py:869: MatplotlibDeprecationWarning: The draw_all function was deprecated in Matplotlib 3.6 and will be removed two minor releases later. Use fig.draw_without_rendering() instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/python/3.8.8/lib/python3.8/site-packages/scvelo/plotting/utils.py:869: MatplotlibDeprecationWarning: The draw_all function was deprecated in Matplotlib 3.6 and will be removed two minor releases later. Use fig.draw_without_rendering() instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>saving figure to file ./figures/scvelo_-nmr-stream-PRJNA679294-astrocytes_datasets-velocity.pdf</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-66-output-5.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="66">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb738"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb738-1"><a href="#cb738-1" aria-hidden="true" tabindex="-1"></a>scv.pl.velocity_embedding_stream(</span>
<span id="cb738-2"><a href="#cb738-2" aria-hidden="true" tabindex="-1"></a>    velocity_data,</span>
<span id="cb738-3"><a href="#cb738-3" aria-hidden="true" tabindex="-1"></a>    basis<span class="op">=</span><span class="st">"umap"</span>,</span>
<span id="cb738-4"><a href="#cb738-4" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>[g <span class="cf">for</span> g <span class="kw">in</span> genes_embed <span class="cf">if</span> g <span class="kw">in</span> velocity_data.var_names],</span>
<span id="cb738-5"><a href="#cb738-5" aria-hidden="true" tabindex="-1"></a>    legend_loc<span class="op">=</span><span class="st">"none"</span>,</span>
<span id="cb738-6"><a href="#cb738-6" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb738-7"><a href="#cb738-7" aria-hidden="true" tabindex="-1"></a>    legend_fontsize<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb738-8"><a href="#cb738-8" aria-hidden="true" tabindex="-1"></a>    arrow_color<span class="op">=</span><span class="st">"darkslategrey"</span>,</span>
<span id="cb738-9"><a href="#cb738-9" aria-hidden="true" tabindex="-1"></a>    density<span class="op">=</span><span class="fl">0.9</span>,</span>
<span id="cb738-10"><a href="#cb738-10" aria-hidden="true" tabindex="-1"></a>    linewidth<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb738-11"><a href="#cb738-11" aria-hidden="true" tabindex="-1"></a>    arrow_size<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb738-12"><a href="#cb738-12" aria-hidden="true" tabindex="-1"></a>    min_mass<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb738-13"><a href="#cb738-13" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb738-14"><a href="#cb738-14" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span><span class="st">"gnuplot2"</span>,</span>
<span id="cb738-15"><a href="#cb738-15" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>plt_size,</span>
<span id="cb738-16"><a href="#cb738-16" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="dv">40</span>,</span>
<span id="cb738-17"><a href="#cb738-17" aria-hidden="true" tabindex="-1"></a>    ncols<span class="op">=</span><span class="dv">4</span>,</span>
<span id="cb738-18"><a href="#cb738-18" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="st">"-adgen-stream"</span> <span class="op">+</span> save_PRJNA679294,</span>
<span id="cb738-19"><a href="#cb738-19" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/python/3.8.8/lib/python3.8/site-packages/scvelo/plotting/utils.py:869: MatplotlibDeprecationWarning: The draw_all function was deprecated in Matplotlib 3.6 and will be removed two minor releases later. Use fig.draw_without_rendering() instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/python/3.8.8/lib/python3.8/site-packages/scvelo/plotting/utils.py:869: MatplotlibDeprecationWarning: The draw_all function was deprecated in Matplotlib 3.6 and will be removed two minor releases later. Use fig.draw_without_rendering() instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/python/3.8.8/lib/python3.8/site-packages/scvelo/plotting/utils.py:869: MatplotlibDeprecationWarning: The draw_all function was deprecated in Matplotlib 3.6 and will be removed two minor releases later. Use fig.draw_without_rendering() instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/python/3.8.8/lib/python3.8/site-packages/scvelo/plotting/utils.py:869: MatplotlibDeprecationWarning: The draw_all function was deprecated in Matplotlib 3.6 and will be removed two minor releases later. Use fig.draw_without_rendering() instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/python/3.8.8/lib/python3.8/site-packages/scvelo/plotting/utils.py:869: MatplotlibDeprecationWarning: The draw_all function was deprecated in Matplotlib 3.6 and will be removed two minor releases later. Use fig.draw_without_rendering() instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/python/3.8.8/lib/python3.8/site-packages/scvelo/plotting/utils.py:869: MatplotlibDeprecationWarning: The draw_all function was deprecated in Matplotlib 3.6 and will be removed two minor releases later. Use fig.draw_without_rendering() instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/python/3.8.8/lib/python3.8/site-packages/scvelo/plotting/utils.py:869: MatplotlibDeprecationWarning: The draw_all function was deprecated in Matplotlib 3.6 and will be removed two minor releases later. Use fig.draw_without_rendering() instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/python/3.8.8/lib/python3.8/site-packages/scvelo/plotting/utils.py:869: MatplotlibDeprecationWarning: The draw_all function was deprecated in Matplotlib 3.6 and will be removed two minor releases later. Use fig.draw_without_rendering() instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/python/3.8.8/lib/python3.8/site-packages/scvelo/plotting/utils.py:869: MatplotlibDeprecationWarning: The draw_all function was deprecated in Matplotlib 3.6 and will be removed two minor releases later. Use fig.draw_without_rendering() instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/python/3.8.8/lib/python3.8/site-packages/scvelo/plotting/utils.py:869: MatplotlibDeprecationWarning: The draw_all function was deprecated in Matplotlib 3.6 and will be removed two minor releases later. Use fig.draw_without_rendering() instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/python/3.8.8/lib/python3.8/site-packages/scvelo/plotting/utils.py:869: MatplotlibDeprecationWarning: The draw_all function was deprecated in Matplotlib 3.6 and will be removed two minor releases later. Use fig.draw_without_rendering() instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>saving figure to file ./figures/scvelo_-adgen-stream-PRJNA679294-astrocytes_datasets-velocity.pdf</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-67-output-13.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="67">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb751"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb751-1"><a href="#cb751-1" aria-hidden="true" tabindex="-1"></a>velocity_data.write(</span>
<span id="cb751-2"><a href="#cb751-2" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"/data/</span><span class="sc">{</span>bioproject<span class="sc">}</span><span class="ss">/data/velocity-signalling/</span><span class="sc">{</span>bioproject<span class="sc">}</span><span class="ss">-velocity.h5ad"</span></span>
<span id="cb751-3"><a href="#cb751-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="latent-time" class="level4">
<h4 class="anchored" data-anchor-id="latent-time">Latent time</h4>
<div class="cell" data-execution_count="68">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb752"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb752-1"><a href="#cb752-1" aria-hidden="true" tabindex="-1"></a>scv.tl.latent_time(</span>
<span id="cb752-2"><a href="#cb752-2" aria-hidden="true" tabindex="-1"></a>    velocity_data, root_key<span class="op">=</span><span class="st">"initial_states_probs"</span>, end_key<span class="op">=</span><span class="st">"terminal_states_probs"</span></span>
<span id="cb752-3"><a href="#cb752-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb752-4"><a href="#cb752-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb752-5"><a href="#cb752-5" aria-hidden="true" tabindex="-1"></a>scv.pl.scatter(velocity_data, color<span class="op">=</span><span class="st">"latent_time"</span>, color_map<span class="op">=</span><span class="st">"gnuplot"</span>, size<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb752-6"><a href="#cb752-6" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb752-7"><a href="#cb752-7" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb752-8"><a href="#cb752-8" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb752-9"><a href="#cb752-9" aria-hidden="true" tabindex="-1"></a>top_genes <span class="op">=</span> velocity_data.var[<span class="st">"fit_likelihood"</span>].sort_values(ascending<span class="op">=</span><span class="va">False</span>).index[:<span class="dv">300</span>]</span>
<span id="cb752-10"><a href="#cb752-10" aria-hidden="true" tabindex="-1"></a>scv.pl.heatmap(</span>
<span id="cb752-11"><a href="#cb752-11" aria-hidden="true" tabindex="-1"></a>    velocity_data,</span>
<span id="cb752-12"><a href="#cb752-12" aria-hidden="true" tabindex="-1"></a>    var_names<span class="op">=</span>top_genes,</span>
<span id="cb752-13"><a href="#cb752-13" aria-hidden="true" tabindex="-1"></a>    sortby<span class="op">=</span><span class="st">"latent_time"</span>,</span>
<span id="cb752-14"><a href="#cb752-14" aria-hidden="true" tabindex="-1"></a>    col_color<span class="op">=</span><span class="st">"libname"</span>,</span>
<span id="cb752-15"><a href="#cb752-15" aria-hidden="true" tabindex="-1"></a>    n_convolve<span class="op">=</span><span class="dv">100</span>,</span>
<span id="cb752-16"><a href="#cb752-16" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>computing terminal states
    identified 0 region of root cells and 1 region of end points .
    finished (0:00:00) --&gt; added
    'root_cells', root cells of Markov diffusion process (adata.obs)
    'end_points', end points of Markov diffusion process (adata.obs)
WARNING: No root cells detected. Consider specifying root cells to improve latent time prediction.
computing latent time using root_cells as prior
    finished (0:00:00) --&gt; added 
    'latent_time', shared time (adata.obs)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/python/3.8.8/lib/python3.8/site-packages/scvelo/plotting/utils.py:869: MatplotlibDeprecationWarning: The draw_all function was deprecated in Matplotlib 3.6 and will be removed two minor releases later. Use fig.draw_without_rendering() instead.</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-69-output-3.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-69-output-4.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="69">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb755"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb755-1"><a href="#cb755-1" aria-hidden="true" tabindex="-1"></a>genes_embed <span class="op">=</span> [g <span class="cf">for</span> g <span class="kw">in</span> genes_embed <span class="cf">if</span> g <span class="kw">in</span> velocity_data.var_names]</span>
<span id="cb755-2"><a href="#cb755-2" aria-hidden="true" tabindex="-1"></a>npr <span class="op">=</span> [g <span class="cf">for</span> g <span class="kw">in</span> npr <span class="cf">if</span> g <span class="kw">in</span> velocity_data.var_names]</span>
<span id="cb755-3"><a href="#cb755-3" aria-hidden="true" tabindex="-1"></a>nmr <span class="op">=</span> [g <span class="cf">for</span> g <span class="kw">in</span> nmr <span class="cf">if</span> g <span class="kw">in</span> velocity_data.var_names]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="70">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb756"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb756-1"><a href="#cb756-1" aria-hidden="true" tabindex="-1"></a>scv.pl.scatter(velocity_data, genes_embed[:<span class="dv">19</span>], frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb756-2"><a href="#cb756-2" aria-hidden="true" tabindex="-1"></a>scv.pl.scatter(velocity_data, x<span class="op">=</span><span class="st">"latent_time"</span>, y<span class="op">=</span>genes_embed[:<span class="dv">19</span>], frameon<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-71-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-71-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="71">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb757"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb757-1"><a href="#cb757-1" aria-hidden="true" tabindex="-1"></a>scv.pl.scatter(velocity_data, npr[:<span class="dv">19</span>], frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb757-2"><a href="#cb757-2" aria-hidden="true" tabindex="-1"></a>scv.pl.scatter(velocity_data, x<span class="op">=</span><span class="st">"latent_time"</span>, y<span class="op">=</span>npr[:<span class="dv">19</span>], frameon<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-72-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-72-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="72">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb758"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb758-1"><a href="#cb758-1" aria-hidden="true" tabindex="-1"></a>scv.pl.scatter(velocity_data, nmr[:<span class="dv">19</span>], frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb758-2"><a href="#cb758-2" aria-hidden="true" tabindex="-1"></a>scv.pl.scatter(velocity_data, x<span class="op">=</span><span class="st">"latent_time"</span>, y<span class="op">=</span>nmr[:<span class="dv">19</span>], frameon<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-73-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-73-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="top-likelihood-genes" class="level4">
<h4 class="anchored" data-anchor-id="top-likelihood-genes">Top-likelihood genes</h4>
<div class="cell" data-execution_count="73">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb759"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb759-1"><a href="#cb759-1" aria-hidden="true" tabindex="-1"></a>top_genes <span class="op">=</span> velocity_data.var[<span class="st">"fit_likelihood"</span>].sort_values(ascending<span class="op">=</span><span class="va">False</span>).index</span>
<span id="cb759-2"><a href="#cb759-2" aria-hidden="true" tabindex="-1"></a>scv.pl.scatter(velocity_data, basis<span class="op">=</span>top_genes[:<span class="dv">15</span>], ncols<span class="op">=</span><span class="dv">5</span>, frameon<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-74-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="condition-specific-top-likelihood-genes" class="level4">
<h4 class="anchored" data-anchor-id="condition-specific-top-likelihood-genes">Condition-specific top-likelihood genes</h4>
<div class="cell" data-execution_count="74">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb760"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb760-1"><a href="#cb760-1" aria-hidden="true" tabindex="-1"></a>scv.tl.rank_dynamical_genes(velocity_data, groupby<span class="op">=</span><span class="st">"libname"</span>)</span>
<span id="cb760-2"><a href="#cb760-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> scv.get_df(velocity_data, <span class="st">"rank_dynamical_genes/names"</span>)</span>
<span id="cb760-3"><a href="#cb760-3" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>ranking genes by cluster-specific likelihoods
    finished (0:00:00) --&gt; added 
    'rank_dynamical_genes', sorted scores by group ids (adata.uns)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="74">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>control</th>
      <th>csds</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Ccn1</td>
      <td>Ccn1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Clu</td>
      <td>Clu</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Atp1a2</td>
      <td>Nkain4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>S100a6</td>
      <td>Mt2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Nkain4</td>
      <td>Atp1a2</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="75">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb762"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb762-1"><a href="#cb762-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> condition <span class="kw">in</span> [<span class="st">"control"</span>, <span class="st">"csds"</span>]:</span>
<span id="cb762-2"><a href="#cb762-2" aria-hidden="true" tabindex="-1"></a>    scv.pl.scatter(velocity_data, df[condition][:<span class="dv">5</span>], ylabel<span class="op">=</span>condition, frameon<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-76-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-76-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="76">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb763"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb763-1"><a href="#cb763-1" aria-hidden="true" tabindex="-1"></a>scv.pl.velocity_embedding(</span>
<span id="cb763-2"><a href="#cb763-2" aria-hidden="true" tabindex="-1"></a>    velocity_data,</span>
<span id="cb763-3"><a href="#cb763-3" aria-hidden="true" tabindex="-1"></a>    arrow_length<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb763-4"><a href="#cb763-4" aria-hidden="true" tabindex="-1"></a>    arrow_size<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb763-5"><a href="#cb763-5" aria-hidden="true" tabindex="-1"></a>    dpi<span class="op">=</span><span class="dv">120</span>,</span>
<span id="cb763-6"><a href="#cb763-6" aria-hidden="true" tabindex="-1"></a>    show<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb763-7"><a href="#cb763-7" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="st">"embedding"</span> <span class="op">+</span> save_PRJNA679294,</span>
<span id="cb763-8"><a href="#cb763-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>saving figure to file ./figures/scvelo_embedding-PRJNA679294-astrocytes_datasets-velocity.pdf</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-77-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="77">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb765"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb765-1"><a href="#cb765-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> velocity_data.var</span>
<span id="cb765-2"><a href="#cb765-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[(df[<span class="st">"fit_likelihood"</span>] <span class="op">&gt;</span> <span class="fl">0.1</span>) <span class="op">&amp;</span> df[<span class="st">"velocity_genes"</span>] <span class="op">==</span> <span class="va">True</span>]</span>
<span id="cb765-3"><a href="#cb765-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb765-4"><a href="#cb765-4" aria-hidden="true" tabindex="-1"></a>kwargs <span class="op">=</span> <span class="bu">dict</span>(xscale<span class="op">=</span><span class="st">"log"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb765-5"><a href="#cb765-5" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> scv.GridSpec(ncols<span class="op">=</span><span class="dv">3</span>) <span class="im">as</span> pl:</span>
<span id="cb765-6"><a href="#cb765-6" aria-hidden="true" tabindex="-1"></a>    pl.hist(df[<span class="st">"fit_alpha"</span>], xlabel<span class="op">=</span><span class="st">"transcription rate"</span>, <span class="op">**</span>kwargs)</span>
<span id="cb765-7"><a href="#cb765-7" aria-hidden="true" tabindex="-1"></a>    pl.hist(</span>
<span id="cb765-8"><a href="#cb765-8" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">"fit_beta"</span>] <span class="op">*</span> df[<span class="st">"fit_scaling"</span>],</span>
<span id="cb765-9"><a href="#cb765-9" aria-hidden="true" tabindex="-1"></a>        xlabel<span class="op">=</span><span class="st">"splicing rate"</span>,</span>
<span id="cb765-10"><a href="#cb765-10" aria-hidden="true" tabindex="-1"></a>        xticks<span class="op">=</span>[<span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="dv">1</span>],</span>
<span id="cb765-11"><a href="#cb765-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">**</span>kwargs,</span>
<span id="cb765-12"><a href="#cb765-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb765-13"><a href="#cb765-13" aria-hidden="true" tabindex="-1"></a>    pl.hist(df[<span class="st">"fit_gamma"</span>], xlabel<span class="op">=</span><span class="st">"degradation rate"</span>, xticks<span class="op">=</span>[<span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="dv">1</span>], <span class="op">**</span>kwargs)</span>
<span id="cb765-14"><a href="#cb765-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb765-15"><a href="#cb765-15" aria-hidden="true" tabindex="-1"></a>scv.get_df(velocity_data, <span class="st">"fit*"</span>, dropna<span class="op">=</span><span class="va">True</span>).head(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-78-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display" data-execution_count="77">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>fit_r2</th>
      <th>fit_alpha</th>
      <th>fit_beta</th>
      <th>fit_gamma</th>
      <th>fit_t_</th>
      <th>fit_scaling</th>
      <th>fit_std_u</th>
      <th>fit_std_s</th>
      <th>fit_likelihood</th>
      <th>fit_u0</th>
      <th>fit_s0</th>
      <th>fit_pval_steady</th>
      <th>fit_steady_u</th>
      <th>fit_steady_s</th>
      <th>fit_variance</th>
      <th>fit_alignment_scaling</th>
    </tr>
    <tr>
      <th>mgi_symbol</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Atp1a2</th>
      <td>0.391718</td>
      <td>0.095697</td>
      <td>0.279544</td>
      <td>0.067163</td>
      <td>56.217387</td>
      <td>0.165886</td>
      <td>0.085886</td>
      <td>0.244633</td>
      <td>0.259803</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.276790</td>
      <td>0.311067</td>
      <td>1.154938</td>
      <td>0.842266</td>
      <td>9.704079</td>
    </tr>
    <tr>
      <th>Nkain4</th>
      <td>0.143570</td>
      <td>0.386280</td>
      <td>2.949563</td>
      <td>0.180205</td>
      <td>10.469449</td>
      <td>0.056584</td>
      <td>0.037849</td>
      <td>0.316059</td>
      <td>0.277666</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.308781</td>
      <td>0.110037</td>
      <td>1.147635</td>
      <td>0.594349</td>
      <td>2.763673</td>
    </tr>
    <tr>
      <th>S100a6</th>
      <td>0.187555</td>
      <td>0.062811</td>
      <td>0.820763</td>
      <td>0.231548</td>
      <td>10.709558</td>
      <td>0.695192</td>
      <td>0.027232</td>
      <td>0.056799</td>
      <td>0.240051</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.030898</td>
      <td>0.076518</td>
      <td>0.138383</td>
      <td>0.954922</td>
      <td>2.668298</td>
    </tr>
    <tr>
      <th>Ccn1</th>
      <td>0.076200</td>
      <td>0.003205</td>
      <td>0.008536</td>
      <td>0.080079</td>
      <td>50.326149</td>
      <td>17.499404</td>
      <td>0.097330</td>
      <td>0.009177</td>
      <td>0.312508</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000039</td>
      <td>0.300306</td>
      <td>0.024987</td>
      <td>0.489977</td>
      <td>10.686456</td>
    </tr>
    <tr>
      <th>Prdx1</th>
      <td>0.069741</td>
      <td>0.055050</td>
      <td>0.764565</td>
      <td>0.132013</td>
      <td>11.780243</td>
      <td>1.175130</td>
      <td>0.038749</td>
      <td>0.051687</td>
      <td>0.211764</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.040036</td>
      <td>0.092886</td>
      <td>0.216887</td>
      <td>0.675526</td>
      <td>1.897685</td>
    </tr>
    <tr>
      <th>Actb</th>
      <td>0.315588</td>
      <td>0.026170</td>
      <td>0.163061</td>
      <td>0.070788</td>
      <td>26.861619</td>
      <td>1.240052</td>
      <td>0.066982</td>
      <td>0.075351</td>
      <td>0.253675</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.201988</td>
      <td>0.138466</td>
      <td>0.233425</td>
      <td>0.807656</td>
      <td>6.898955</td>
    </tr>
    <tr>
      <th>Slc7a10</th>
      <td>0.245598</td>
      <td>0.110055</td>
      <td>1.009716</td>
      <td>0.293708</td>
      <td>16.904551</td>
      <td>0.570961</td>
      <td>0.043778</td>
      <td>0.086472</td>
      <td>0.220063</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.046318</td>
      <td>0.126419</td>
      <td>0.343913</td>
      <td>1.162429</td>
      <td>2.131059</td>
    </tr>
    <tr>
      <th>Mt2</th>
      <td>0.205572</td>
      <td>0.094566</td>
      <td>0.411359</td>
      <td>0.068955</td>
      <td>45.996095</td>
      <td>0.120887</td>
      <td>0.059182</td>
      <td>0.231317</td>
      <td>0.257115</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.239747</td>
      <td>0.193544</td>
      <td>1.023847</td>
      <td>0.873924</td>
      <td>9.049198</td>
    </tr>
    <tr>
      <th>Cox4i1</th>
      <td>0.031080</td>
      <td>0.037163</td>
      <td>0.719952</td>
      <td>0.030296</td>
      <td>76.110658</td>
      <td>0.063055</td>
      <td>0.018226</td>
      <td>0.134408</td>
      <td>0.205527</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.102670</td>
      <td>0.053536</td>
      <td>1.007821</td>
      <td>1.347056</td>
      <td>10.243074</td>
    </tr>
    <tr>
      <th>Tecr</th>
      <td>0.154693</td>
      <td>0.082341</td>
      <td>0.533695</td>
      <td>0.077153</td>
      <td>26.620210</td>
      <td>0.168403</td>
      <td>0.042767</td>
      <td>0.133327</td>
      <td>0.214924</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.371469</td>
      <td>0.126159</td>
      <td>0.661235</td>
      <td>1.228575</td>
      <td>5.563235</td>
    </tr>
    <tr>
      <th>Clu</th>
      <td>0.124030</td>
      <td>1.047292</td>
      <td>7.707097</td>
      <td>0.245554</td>
      <td>14.204769</td>
      <td>0.021588</td>
      <td>0.036572</td>
      <td>0.800471</td>
      <td>0.306203</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.435273</td>
      <td>0.110674</td>
      <td>3.259802</td>
      <td>0.566768</td>
      <td>2.704679</td>
    </tr>
    <tr>
      <th>Itih3</th>
      <td>0.221846</td>
      <td>0.793692</td>
      <td>1.748588</td>
      <td>0.205551</td>
      <td>22.360680</td>
      <td>0.223412</td>
      <td>0.113853</td>
      <td>0.670351</td>
      <td>0.222731</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.472546</td>
      <td>0.440913</td>
      <td>3.486827</td>
      <td>1.139379</td>
      <td>3.312452</td>
    </tr>
    <tr>
      <th>Son</th>
      <td>0.100334</td>
      <td>0.284075</td>
      <td>4.803580</td>
      <td>0.131972</td>
      <td>21.472632</td>
      <td>0.020354</td>
      <td>0.019669</td>
      <td>0.456592</td>
      <td>0.196146</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.425680</td>
      <td>0.060058</td>
      <td>1.539114</td>
      <td>1.443488</td>
      <td>4.832618</td>
    </tr>
    <tr>
      <th>Srrm2</th>
      <td>0.020000</td>
      <td>0.094924</td>
      <td>0.704706</td>
      <td>0.218862</td>
      <td>17.427004</td>
      <td>0.914984</td>
      <td>0.048494</td>
      <td>0.087450</td>
      <td>0.242497</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.036376</td>
      <td>0.139024</td>
      <td>0.347821</td>
      <td>0.958991</td>
      <td>2.558955</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="78">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb766"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb766-1"><a href="#cb766-1" aria-hidden="true" tabindex="-1"></a>scv.tl.velocity_confidence(velocity_data)</span>
<span id="cb766-2"><a href="#cb766-2" aria-hidden="true" tabindex="-1"></a>keys <span class="op">=</span> [<span class="st">"velocity_length"</span>, <span class="st">"velocity_confidence"</span>]</span>
<span id="cb766-3"><a href="#cb766-3" aria-hidden="true" tabindex="-1"></a>scv.pl.scatter(</span>
<span id="cb766-4"><a href="#cb766-4" aria-hidden="true" tabindex="-1"></a>    velocity_data,</span>
<span id="cb766-5"><a href="#cb766-5" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>keys,</span>
<span id="cb766-6"><a href="#cb766-6" aria-hidden="true" tabindex="-1"></a>    cmap<span class="op">=</span><span class="st">"coolwarm"</span>,</span>
<span id="cb766-7"><a href="#cb766-7" aria-hidden="true" tabindex="-1"></a>    perc<span class="op">=</span>[<span class="dv">5</span>, <span class="dv">95</span>],</span>
<span id="cb766-8"><a href="#cb766-8" aria-hidden="true" tabindex="-1"></a>    save<span class="op">=</span><span class="st">"-velocity_confidence"</span> <span class="op">+</span> save_PRJNA679294,</span>
<span id="cb766-9"><a href="#cb766-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>--&gt; added 'velocity_length' (adata.obs)
--&gt; added 'velocity_confidence' (adata.obs)
--&gt; added 'velocity_confidence_transition' (adata.obs)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/python/3.8.8/lib/python3.8/site-packages/scvelo/plotting/utils.py:869: MatplotlibDeprecationWarning: The draw_all function was deprecated in Matplotlib 3.6 and will be removed two minor releases later. Use fig.draw_without_rendering() instead.
/opt/python/3.8.8/lib/python3.8/site-packages/scvelo/plotting/utils.py:869: MatplotlibDeprecationWarning: The draw_all function was deprecated in Matplotlib 3.6 and will be removed two minor releases later. Use fig.draw_without_rendering() instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>saving figure to file ./figures/scvelo_-velocity_confidence-PRJNA679294-astrocytes_datasets-velocity.pdf</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="02-velocity-signalling_csds_files/figure-html/cell-79-output-4.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="79">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb770"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb770-1"><a href="#cb770-1" aria-hidden="true" tabindex="-1"></a>scv.tl.rank_velocity_genes(velocity_data, groupby<span class="op">=</span><span class="st">"libname"</span>, min_corr<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb770-2"><a href="#cb770-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb770-3"><a href="#cb770-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> scv.DataFrame(velocity_data.uns[<span class="st">"rank_velocity_genes"</span>][<span class="st">"names"</span>])</span>
<span id="cb770-4"><a href="#cb770-4" aria-hidden="true" tabindex="-1"></a>df.head()</span>
<span id="cb770-5"><a href="#cb770-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb770-6"><a href="#cb770-6" aria-hidden="true" tabindex="-1"></a>df.to_csv(</span>
<span id="cb770-7"><a href="#cb770-7" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"/data/</span><span class="sc">{</span>bioproject<span class="sc">}</span><span class="ss">/data/velocity-signalling/</span><span class="sc">{</span>bioproject<span class="sc">}</span><span class="ss">-rank_velocity_genes.csv"</span></span>
<span id="cb770-8"><a href="#cb770-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>ranking velocity genes
    finished (0:00:00) --&gt; added 
    'rank_velocity_genes', sorted scores by group ids (adata.uns) 
    'spearmans_score', spearmans correlation scores (adata.var)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/opt/python/3.8.8/lib/python3.8/site-packages/scvelo/tools/utils.py:501: DeprecationWarning: Please use `rankdata` from the `scipy.stats` namespace, the `scipy.stats.stats` namespace is deprecated.
/tmp/ipykernel_46/2487383092.py:3: DeprecationWarning: `scvelo.read_load.get_df` is deprecated since scVelo v0.2.4 and will be removed in a future version. Please use `scvelo.core.get_df` instead.</code></pre>
</div>
</div>
</section>
</section>
<section id="save-data" class="level3">
<h3 class="anchored" data-anchor-id="save-data">Save data</h3>
<div class="cell" data-execution_count="80">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb773"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb773-1"><a href="#cb773-1" aria-hidden="true" tabindex="-1"></a>velocity_data.write(</span>
<span id="cb773-2"><a href="#cb773-2" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"/data/</span><span class="sc">{</span>bioproject<span class="sc">}</span><span class="ss">/data/velocity-signalling/</span><span class="sc">{</span>bioproject<span class="sc">}</span><span class="ss">-velocity.h5ad"</span></span>
<span id="cb773-3"><a href="#cb773-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="81">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb774"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb774-1"><a href="#cb774-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(watermark())</span>
<span id="cb774-2"><a href="#cb774-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(watermark(iversions<span class="op">=</span><span class="va">True</span>, globals_<span class="op">=</span><span class="bu">globals</span>()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Last updated: 2023-07-21T16:18:00.204607+00:00

Python implementation: CPython
Python version       : 3.8.8
IPython version      : 8.12.1

Compiler    : GCC 9.3.0
OS          : Linux
Release     : 5.15.0-76-generic
Machine     : x86_64
Processor   : x86_64
CPU cores   : 256
Architecture: 64bit

liana     : 0.1.8
scanpy    : 1.9.3
plotnine  : 0.10.1
sklearn   : 1.2.2
scipy     : 1.10.1
cellrank  : 1.5.1
anndata   : 0.9.1
numpy     : 1.23.5
matplotlib: 3.7.1
pandas    : 1.5.3
umap      : 0.5.3
pacmap    : 0.7.0
scvelo    : 0.2.5
</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script type="application/vnd.jupyter.widget-state+json">
{"state":{"2bdfb51307584422ad1da590c4155162":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"ProgressView","bar_style":"success","description":"","description_allow_html":false,"layout":"IPY_MODEL_b94c9f788e544c10a1dd09a01efa3c03","max":14,"min":0,"orientation":"horizontal","style":"IPY_MODEL_ebe28479bfc943978b0b15a0007949e1","tabbable":null,"tooltip":null,"value":14}},"2d3391e46abc4e629e50b0f3bbc82858":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"3148fbad5aaa4ddab8c81c119c4af5ba":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_560a864408754937b25e7b556631a6f1","placeholder":"​","style":"IPY_MODEL_a1cbe7024d9a497f81be13f77319b386","tabbable":null,"tooltip":null,"value":"100%"}},"35e65122ab904927a843d6c03b1bf54b":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"3f7eadadad6b458686aff4b2f987bab5":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"43207a0927d144a298275b1010a00772":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"ProgressView","bar_style":"success","description":"","description_allow_html":false,"layout":"IPY_MODEL_bcebebb3797241e0aca820e69449a788","max":310,"min":0,"orientation":"horizontal","style":"IPY_MODEL_2d3391e46abc4e629e50b0f3bbc82858","tabbable":null,"tooltip":null,"value":310}},"560a864408754937b25e7b556631a6f1":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"683be602fc6844429789b97b533ca069":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"72c2c80e5a5a4b5fa820ecc858cedf4c":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_3148fbad5aaa4ddab8c81c119c4af5ba","IPY_MODEL_43207a0927d144a298275b1010a00772","IPY_MODEL_a641909f1e784e3192232aba047f367d"],"layout":"IPY_MODEL_683be602fc6844429789b97b533ca069","tabbable":null,"tooltip":null}},"90e74b6318fe442b81b9f42da1d51343":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9af8962e2cb1408c8182323a294cb4cb":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9c7203165fe740a6aa8758d90adce893":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a1cbe7024d9a497f81be13f77319b386":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"a641909f1e784e3192232aba047f367d":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_9c7203165fe740a6aa8758d90adce893","placeholder":"​","style":"IPY_MODEL_35e65122ab904927a843d6c03b1bf54b","tabbable":null,"tooltip":null,"value":" 310/310 [00:00&lt;00:00, 1430.02cells/s]"}},"ad6b5b7bc6cb49348c28b3fb0e3475ae":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_9af8962e2cb1408c8182323a294cb4cb","placeholder":"​","style":"IPY_MODEL_b557a9f4fb0f4c05bf1d641048a26ed9","tabbable":null,"tooltip":null,"value":"100%"}},"b557a9f4fb0f4c05bf1d641048a26ed9":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"b94c9f788e544c10a1dd09a01efa3c03":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bcebebb3797241e0aca820e69449a788":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bf46c9bd3c674c2ab100329598ae5a48":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_90e74b6318fe442b81b9f42da1d51343","placeholder":"​","style":"IPY_MODEL_c5bc95d3f72848499a5a4a64c8bca8b7","tabbable":null,"tooltip":null,"value":" 14/14 [00:06&lt;00:00,  3.74gene/s]"}},"c5bc95d3f72848499a5a4a64c8bca8b7":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"cb4714d12775489a83ba361c698fb8f4":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_ad6b5b7bc6cb49348c28b3fb0e3475ae","IPY_MODEL_2bdfb51307584422ad1da590c4155162","IPY_MODEL_bf46c9bd3c674c2ab100329598ae5a48"],"layout":"IPY_MODEL_3f7eadadad6b458686aff4b2f987bab5","tabbable":null,"tooltip":null}},"ebe28479bfc943978b0b15a0007949e1":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","bar_color":null,"description_width":""}}},"version_major":2,"version_minor":0}
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>